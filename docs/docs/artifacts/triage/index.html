<!DOCTYPE html>
<html>
  <head>
    <title>Velociraptor / Dig deeper</title>
    
      <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>Windows Triage Artifacts :: Velociraptor / Dig deeper</title>
<link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon" />
<link rel="stylesheet" href="/css/bootstrap.min.css">
<link href="/css/nucleus.css" rel="stylesheet">
<link href="/css/font-awesome.min.css" rel="stylesheet">
<link href="/css/hybrid.css" rel="stylesheet">
<link href="/css/featherlight.min.css" rel="stylesheet">
<link href="/css/auto-complete.css" rel="stylesheet">
<link href="/theme-original/style.css" rel="stylesheet">

  <link href="/theme-original/variant-mine.css" rel="stylesheet">


<script src="/js/jquery-2.x.min.js"></script>
<style type="text/css">
  :root #header + #content > #left > #rlblock_left {
    display:none !important;
  }
</style>
<link rel="stylesheet" href="/css/theme-mine.css">
<script src="/js/custom.js"></script>


    
  </head>
  <body data-url="/docs/artifacts/triage/">
    
      <div id="headermain"></div>
<nav id="sidebar" class="">



<div class="highlightable">
  <div id="header-wrapper">
    <div id="header">
      
	
  
    <a href="/">
  <img src="/images/logo.svg">
</a>
  


    </div>
        <div class="searchbox">
		    <label for="search-by"><i class="fa fa-search"></i></label>
		    <input data-search-input id="search-by" type="text" placeholder="Search...">
		    <span data-search-clear=""><i class="fa fa-close"></i></span>
		</div>
		<script type="text/javascript" src="/js/lunr.min.js"></script>
		<script type="text/javascript" src="/js/auto-complete.js"></script>
		<script type="text/javascript">
        
            var baseurl = "\/";
        
		</script>
		<script type="text/javascript" src="/js/search.js"></script>
  </div>

      <ul class="topics">
    <li data-nav-id="/about/" class="dd-item haschildren
        ">
      <div>
      <a href="/about/">About Velociraptor</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/about/features/" class="dd-item">
        <div>
          <a href="/about/features/">
            Velociraptor Features
          </a>
        </div>
    </li>
      <li data-nav-id="/about/license/" class="dd-item">
        <div>
          <a href="/about/license/">
            License
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/docs/" class="dd-item parent haschildren
        ">
      <div>
      <a href="/docs/">Velociraptor Documentation</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/docs/getting-started/" class="dd-item haschildren
        ">
      <div>
      <a href="/docs/getting-started/">Getting Started</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/docs/getting-started/stand_alone/" class="dd-item">
        <div>
          <a href="/docs/getting-started/stand_alone/">
            Standalone Deployment
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/getting-started/deploying_clients/" class="dd-item">
        <div>
          <a href="/docs/getting-started/deploying_clients/">
            Deploying Clients
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/getting-started/cloud/" class="dd-item">
        <div>
          <a href="/docs/getting-started/cloud/">
            Deploying in the cloud
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/getting-started/triaging/" class="dd-item">
        <div>
          <a href="/docs/getting-started/triaging/">
            Triaging
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/docs/user-interface/" class="dd-item haschildren
        ">
      <div>
      <a href="/docs/user-interface/">User Interface</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/docs/user-interface/investigating_clients/" class="dd-item haschildren
        ">
      <div>
      <a href="/docs/user-interface/investigating_clients/">Investigating Clients</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/docs/user-interface/investigating_clients/searching_clients/" class="dd-item">
        <div>
          <a href="/docs/user-interface/investigating_clients/searching_clients/">
            Searching for clients
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/user-interface/investigating_clients/virtual_filesystem/" class="dd-item">
        <div>
          <a href="/docs/user-interface/investigating_clients/virtual_filesystem/">
            Client VFS
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/docs/user-interface/artifacts/" class="dd-item haschildren
        ">
      <div>
      <a href="/docs/user-interface/artifacts/">Velociraptor Artifacts</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/docs/user-interface/artifacts/client_artifacts/" class="dd-item">
        <div>
          <a href="/docs/user-interface/artifacts/client_artifacts/">
            Client Artifacts
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/user-interface/artifacts/client_events/" class="dd-item">
        <div>
          <a href="/docs/user-interface/artifacts/client_events/">
            Client Event Artifacts
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/user-interface/artifacts/server_artifacts/" class="dd-item">
        <div>
          <a href="/docs/user-interface/artifacts/server_artifacts/">
            Server Artifacts
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/user-interface/artifacts/server_events/" class="dd-item">
        <div>
          <a href="/docs/user-interface/artifacts/server_events/">
            Server Event Artifacts
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/user-interface/artifacts/add_artifacts/" class="dd-item">
        <div>
          <a href="/docs/user-interface/artifacts/add_artifacts/">
            Customizing Artifacts
          </a>
        </div>
    </li>
        </ul>
    </li>
      <li data-nav-id="/docs/user-interface/api/" class="dd-item">
        <div>
          <a href="/docs/user-interface/api/">
            The Velociraptor API
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/docs/vql_reference/" class="dd-item haschildren
        ">
      <div>
      <a href="/docs/vql_reference/">VQL Reference</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/docs/vql_reference/basic/" class="dd-item">
        <div>
          <a href="/docs/vql_reference/basic/">
            Basic VQL
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/vql_reference/windows/" class="dd-item">
        <div>
          <a href="/docs/vql_reference/windows/">
            Windows
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/vql_reference/parsers/" class="dd-item">
        <div>
          <a href="/docs/vql_reference/parsers/">
            Parsers
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/vql_reference/server/" class="dd-item">
        <div>
          <a href="/docs/vql_reference/server/">
            Server
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/vql_reference/plugin/" class="dd-item">
        <div>
          <a href="/docs/vql_reference/plugin/">
            Client
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/vql_reference/event/" class="dd-item">
        <div>
          <a href="/docs/vql_reference/event/">
            Event Plugins
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/vql_reference/experimental/" class="dd-item">
        <div>
          <a href="/docs/vql_reference/experimental/">
            Experimental
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/vql_reference/filesystem_accessors/" class="dd-item">
        <div>
          <a href="/docs/vql_reference/filesystem_accessors/">
            Filesystem Accessors
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/vql_reference/templates/" class="dd-item">
        <div>
          <a href="/docs/vql_reference/templates/">
            Report Templates
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/vql_reference/tips/" class="dd-item">
        <div>
          <a href="/docs/vql_reference/tips/">
            Artifact Tips
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/docs/artifacts/" class="dd-item parent haschildren
        ">
      <div>
      <a href="/docs/artifacts/">Artifact Reference</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/docs/artifacts/linux/" class="dd-item">
        <div>
          <a href="/docs/artifacts/linux/">
            Linux Artifacts
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/artifacts/windows_system/" class="dd-item">
        <div>
          <a href="/docs/artifacts/windows_system/">
            Windows System
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/artifacts/server/" class="dd-item">
        <div>
          <a href="/docs/artifacts/server/">
            Server Artifacts
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/artifacts/triage/" class="dd-item active">
        <div>
          <a href="/docs/artifacts/triage/">
            Windows Triage
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/artifacts/detection/" class="dd-item">
        <div>
          <a href="/docs/artifacts/detection/">
            Windows Detection
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/artifacts/events/" class="dd-item">
        <div>
          <a href="/docs/artifacts/events/">
            Windows Monitoring
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/artifacts/misc/" class="dd-item">
        <div>
          <a href="/docs/artifacts/misc/">
            Miscelaneous
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/artifacts/linux/linux/" class="dd-item">
        <div>
          <a href="/docs/artifacts/linux/linux/">
            Linux Artifacts
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/docs/presentations/" class="dd-item haschildren
        ">
      <div>
      <a href="/docs/presentations/">Presentations and Workshops</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/docs/presentations/training_2020/" class="dd-item">
        <div>
          <a href="/docs/presentations/training_2020/">
            Training 2020
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/presentations/linux.conf.au.2020/" class="dd-item">
        <div>
          <a href="/docs/presentations/linux.conf.au.2020/">
            Linux.Conf.Au 2020
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/presentations/sans_dfir_summit2019/" class="dd-item">
        <div>
          <a href="/docs/presentations/sans_dfir_summit2019/">
            SANS 2019
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/presentations/rsa/" class="dd-item">
        <div>
          <a href="/docs/presentations/rsa/">
            RSA APJ 2019
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/presentations/crikeycon2019/" class="dd-item">
        <div>
          <a href="/docs/presentations/crikeycon2019/">
            Crikeycon 2019
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/presentations/nzitf2018/" class="dd-item">
        <div>
          <a href="/docs/presentations/nzitf2018/">
            NZITF 2018
          </a>
        </div>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li data-nav-id="/blog/" class="dd-item haschildren
        ">
      <div>
      <a href="/blog/">Velociraptor Blog</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/blog/medium/2019-12-31_digging-into-the-system-resource-usage-monitor-srum-afbadb1a375/" class="dd-item">
        <div>
          <a href="/blog/medium/2019-12-31_digging-into-the-system-resource-usage-monitor-srum-afbadb1a375/">
            Digging into the System Resource Usage Monitor (SRUM)
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/medium/2019-12-08-velociraptor-to-elasticsearch-3a9fc02c6568/" class="dd-item">
        <div>
          <a href="/blog/medium/2019-12-08-velociraptor-to-elasticsearch-3a9fc02c6568/">
            Velociraptor to Elasticsearch
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/medium/2019-11-15_recovering-deleted-ntfs-files-with-velociraptor-1fcf09855311/" class="dd-item">
        <div>
          <a href="/blog/medium/2019-11-15_recovering-deleted-ntfs-files-with-velociraptor-1fcf09855311/">
            Recovering deleted NTFS Files with Velociraptor
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/medium/2019-11-12_windows-event-logs-d8d8e615c9ca/" class="dd-item">
        <div>
          <a href="/blog/medium/2019-11-12_windows-event-logs-d8d8e615c9ca/">
            Windows Event Logs
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/medium/2019-10-08_triage-with-velociraptor-pt-3-d6f63215f579/" class="dd-item">
        <div>
          <a href="/blog/medium/2019-10-08_triage-with-velociraptor-pt-3-d6f63215f579/">
            Triage with Velociraptor — Pt 3
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/medium/2019-10-04_triage-with-velociraptor-pt-2-d0f79066ca0e/" class="dd-item">
        <div>
          <a href="/blog/medium/2019-10-04_triage-with-velociraptor-pt-2-d0f79066ca0e/">
            Triage with Velociraptor — Pt 2
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/medium/2019-10-02_triage-with-velociraptor-pt-1-253f57ce96c0/" class="dd-item">
        <div>
          <a href="/blog/medium/2019-10-02_triage-with-velociraptor-pt-1-253f57ce96c0/">
            Triage with Velociraptor — Pt 1
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/medium/2019-09-11_velociraptor-s-client-side-buffer-3ce03697a4e6/" class="dd-item">
        <div>
          <a href="/blog/medium/2019-09-11_velociraptor-s-client-side-buffer-3ce03697a4e6/">
            Velociraptor’s client side buffer
          </a>
        </div>
    </li>
        </ul>
    </li>




    <hr />
    <li></li>
    
    </ul>

 <section id="footer">
    </section>
  </div>
</nav>



<section id="body">
<div id="overlay"></div>
<div class="padding highlightable">

  <div id="top-bar">
    <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
        <span id="sidebar-toggle-span">
          <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
            <i class="fa fa-bars"></i>
          </a>
        </span>
        <span id="toc-menu"><i class="fa fa-list-alt"></i></span>
        <span class="links">
        










 <a href='/'>Velociraptor / Dig deeper</a> > <a href='/docs/'>Velociraptor Documentation</a> > <a href='/docs/artifacts/'>Artifact Reference</a> > Windows Triage Artifacts

 

 

 

   
        </span>
    </div>
    
    
    <div class="progress">
        <div class="wrapper">
    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#windows-triage-collectors-amcache">Windows.Triage.Collectors.Amcache</a></li>
<li><a href="#windows-triage-collectors-bcd">Windows.Triage.Collectors.BCD</a></li>
<li><a href="#windows-triage-collectors-chrome">Windows.Triage.Collectors.Chrome</a></li>
<li><a href="#windows-triage-collectors-edge">Windows.Triage.Collectors.Edge</a></li>
<li><a href="#windows-triage-collectors-eventlogs">Windows.Triage.Collectors.EventLogs</a></li>
<li><a href="#windows-triage-collectors-eventtracelogs">Windows.Triage.Collectors.EventTraceLogs</a></li>
<li><a href="#windows-triage-collectors-evidenceofexecution">Windows.Triage.Collectors.EvidenceOfExecution</a></li>
<li><a href="#windows-triage-collectors-firefox">Windows.Triage.Collectors.Firefox</a></li>
<li><a href="#windows-triage-collectors-internetexplorer">Windows.Triage.Collectors.InternetExplorer</a></li>
<li><a href="#windows-triage-collectors-jabber">Windows.Triage.Collectors.Jabber</a></li>
<li><a href="#windows-triage-collectors-lnkfiles">Windows.Triage.Collectors.LnkFiles</a></li>
<li><a href="#windows-triage-collectors-ntfsmetadata">Windows.Triage.Collectors.NTFSMetadata</a></li>
<li><a href="#windows-triage-collectors-outlookpst">Windows.Triage.Collectors.OutlookPST</a></li>
<li><a href="#windows-triage-collectors-powershellconsolelogs">Windows.Triage.Collectors.PowershellConsoleLogs</a></li>
<li><a href="#windows-triage-collectors-recyclebin">Windows.Triage.Collectors.RecycleBin</a></li>
<li><a href="#windows-triage-collectors-registryhives">Windows.Triage.Collectors.RegistryHives</a></li>
<li><a href="#windows-triage-collectors-srum">Windows.Triage.Collectors.SRUM</a></li>
<li><a href="#windows-triage-collectors-scheduledtasks">Windows.Triage.Collectors.ScheduledTasks</a></li>
<li><a href="#windows-triage-collectors-skype">Windows.Triage.Collectors.Skype</a></li>
<li><a href="#windows-triage-collectors-startupinfo">Windows.Triage.Collectors.StartupInfo</a></li>
<li><a href="#windows-triage-collectors-teracopy">Windows.Triage.Collectors.TeraCopy</a></li>
<li><a href="#windows-triage-collectors-thumbdb">Windows.Triage.Collectors.ThumbDB</a></li>
<li><a href="#windows-triage-collectors-usbdevicelogs">Windows.Triage.Collectors.USBDeviceLogs</a></li>
<li><a href="#windows-triage-collectors-wbem">Windows.Triage.Collectors.WBEM</a></li>
<li><a href="#windows-triage-collectors-windowsfirewall">Windows.Triage.Collectors.WindowsFirewall</a></li>
<li><a href="#windows-triage-collectors-windowsindex">Windows.Triage.Collectors.WindowsIndex</a></li>
<li><a href="#windows-triage-processmemory">Windows.Triage.ProcessMemory</a></li>
<li><a href="#windows-triage-webbrowsers">Windows.Triage.WebBrowsers</a></li>
<li><a href="#triage-collection-upload">Triage.Collection.Upload</a></li>
<li><a href="#triage-collection-uploadtable">Triage.Collection.UploadTable</a></li>
<li><a href="#windows-forensics-bam">Windows.Forensics.Bam</a></li>
<li><a href="#windows-forensics-filenamesearch">Windows.Forensics.FilenameSearch</a></li>
<li><a href="#windows-forensics-prefetch">Windows.Forensics.Prefetch</a></li>
<li><a href="#windows-forensics-recentapps">Windows.Forensics.RecentApps</a></li>
<li><a href="#windows-forensics-timeline">Windows.Forensics.Timeline</a></li>
</ul></li>
</ul>
</nav>
        </div>
    </div>
    

  </div>


<div id="body-inner">
  
    <h1>Windows Triage Artifacts</h1>
  



    
    
    
    

<h2 id="windows-triage-collectors-amcache">Windows.Triage.Collectors.Amcache</h2>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>triageTable</td>
<td>Type,Accessor,Glob\nAmcache,ntfs,C:\Windows\AppCompat\Programs\Amcache.hve\nAmcache transaction files,ntfs,C:\Windows\AppCompat\Programs\Amcache.hve.LOG*\n</td>
<td></td>
</tr>
</tbody>
</table>



<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fa fa-chevron-down' : 'fa fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fa fa-chevron-right"></i>
        <span>
        
        
        View Artifact Source
        
        </span>
    </div>
    <div class="expand-content" style="display: none;">
<pre><code>name: Windows.Triage.Collectors.Amcache

precondition: SELECT OS From info() where OS = 'windows'

parameters:
  - name: triageTable
    default: |
      Type,Accessor,Glob
      Amcache,ntfs,C:\Windows\AppCompat\Programs\Amcache.hve
      Amcache transaction files,ntfs,C:\Windows\AppCompat\Programs\Amcache.hve.LOG*

sources:
  - queries:
      - SELECT * FROM Artifact.Triage.Collection.UploadTable(triageTable=triageTable)
</code></pre>

    </div>
</div>


<h2 id="windows-triage-collectors-bcd">Windows.Triage.Collectors.BCD</h2>

<p>Boot Configuration Files.</p>



<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fa fa-chevron-down' : 'fa fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fa fa-chevron-right"></i>
        <span>
        
        
        View Artifact Source
        
        </span>
    </div>
    <div class="expand-content" style="display: none;">
<pre><code>name: Windows.Triage.Collectors.BCD
description: |
  Boot Configuration Files.

precondition: SELECT OS From info() where OS = 'windows'

sources:
  - queries:
      - |
        SELECT * FROM chain(
          a1={ SELECT * FROM Artifact.Triage.Collection.Upload(
               type=&quot;BCD&quot;,
               path=[
                  &quot;C:\\Boot\\BCD&quot;,
                  &quot;C:\\Boot\\BCD.LOG*&quot;
               ])
          }
        )
</code></pre>

    </div>
</div>


<h2 id="windows-triage-collectors-chrome">Windows.Triage.Collectors.Chrome</h2>

<p>Collect Chrome related artifacts.</p>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>triageTable</td>
<td>Type,Accessor,Glob\nChrome Bookmarks,file,C:\Documents and Settings\<em>\Local Settings\Application Data\Google\Chrome\User Data\*\Bookmarks</em>\nChrome Bookmarks,file,C:\Users\<em>\AppData\Local\Google\Chrome\User Data\*\Bookmarks</em>\nChrome Bookmarks,file,C:\Documents and Settings\<em>\Local Settings\Application Data\Google\Chrome\User Data\*\Bookmarks</em>\nChrome Bookmarks,file,C:\Users\<em>\AppData\Local\Google\Chrome\User Data\*\Bookmarks</em>\nChrome Cookies,file,C:\Documents and Settings\<em>\Local Settings\Application Data\Google\Chrome\User Data\*\Cookies</em>\nChrome Cookies,file,C:\Users\<em>\AppData\Local\Google\Chrome\User Data\*\Cookies</em>\nChrome Current Session,ntfs,C:\Documents and Settings\<em>\Local Settings\Application Data\Google\Chrome\User Data\*\Current Session\nChrome Current Session,ntfs,C:\Users\*\AppData\Local\Google\Chrome\User Data\*\Current Session\nChrome Current Tab,file,C:\Documents and Settings\*\Local Settings\Application Data\Google\Chrome\User Data\*\Current Tab\nChrome Current Tab,file,C:\Users\*\AppData\Local\Google\Chrome\User Data\*\Current Tab\nChrome Favicons,file,C:\Documents and Settings\*\Local Settings\Application Data\Google\Chrome\User Data\*\Favicons</em>\nChrome Favicons,file,C:\Users\<em>\AppData\Local\Google\Chrome\User Data\*\Favicons</em>\nChrome History,file,C:\Documents and Settings\<em>\Local Settings\Application Data\Google\Chrome\User Data\*\History</em>\nChrome History,file,C:\Users\<em>\AppData\Local\Google\Chrome\User Data\*\History</em>\nChrome Last Session,file,C:\Documents and Settings\<em>\Local Settings\Application Data\Google\Chrome\User Data\*\Last Session\nChrome Last Session,file,C:\Users\*\AppData\Local\Google\Chrome\User Data\*\Last Session\nChrome Last Tabs,file,C:\Documents and Settings\*\Local Settings\Application Data\Google\Chrome\User Data\*\Last Tabs\nChrome Last Tabs,file,C:\Users\*\AppData\Local\Google\Chrome\User Data\*\Last Tabs\nChrome Preferences,file,C:\Documents and Settings\*\Local Settings\Application Data\Google\Chrome\User Data\*\Preferences\nChrome Preferences,file,C:\Users\*\AppData\Local\Google\Chrome\User Data\*\Preferences\nChrome Shortcuts,file,C:\Documents and Settings\*\Local Settings\Application Data\Google\Chrome\User Data\*\Shortcuts</em>\nChrome Shortcuts,file,C:\Users\<em>\AppData\Local\Google\Chrome\User Data\*\Shortcuts</em>\nChrome Top Sites,file,C:\Documents and Settings\<em>\Local Settings\Application Data\Google\Chrome\User Data\*\Top Sites</em>\nChrome Top Sites,file,C:\Users\<em>\AppData\Local\Google\Chrome\User Data\*\Top Sites\nChrome Visited Links,file,C:\Documents and Settings\*\Local Settings\Application Data\Google\Chrome\User Data\*\Visited Links\nChrome Visited Links,file,C:\Users\*\AppData\Local\Google\Chrome\User Data\*\Visited Links\nChrome Web Data,file,C:\Documents and Settings\*\Local Settings\Application Data\Google\Chrome\User Data\*\Web Data</em>\nChrome Web Data,file,C:\Users\<em>\AppData\Local\Google\Chrome\User Data\*\Web Data</em>\n</td>
<td></td>
</tr>
</tbody>
</table>



<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fa fa-chevron-down' : 'fa fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fa fa-chevron-right"></i>
        <span>
        
        
        View Artifact Source
        
        </span>
    </div>
    <div class="expand-content" style="display: none;">
<pre><code>name: Windows.Triage.Collectors.Chrome
description: |
  Collect Chrome related artifacts.

precondition: SELECT OS From info() where OS = 'windows'

parameters:
  - name: triageTable
    default: |
      Type,Accessor,Glob
      Chrome Bookmarks,file,C:\Documents and Settings\*\Local Settings\Application Data\Google\Chrome\User Data\*\Bookmarks*
      Chrome Bookmarks,file,C:\Users\*\AppData\Local\Google\Chrome\User Data\*\Bookmarks*
      Chrome Bookmarks,file,C:\Documents and Settings\*\Local Settings\Application Data\Google\Chrome\User Data\*\Bookmarks*
      Chrome Bookmarks,file,C:\Users\*\AppData\Local\Google\Chrome\User Data\*\Bookmarks*
      Chrome Cookies,file,C:\Documents and Settings\*\Local Settings\Application Data\Google\Chrome\User Data\*\Cookies*
      Chrome Cookies,file,C:\Users\*\AppData\Local\Google\Chrome\User Data\*\Cookies*
      Chrome Current Session,ntfs,C:\Documents and Settings\*\Local Settings\Application Data\Google\Chrome\User Data\*\Current Session
      Chrome Current Session,ntfs,C:\Users\*\AppData\Local\Google\Chrome\User Data\*\Current Session
      Chrome Current Tab,file,C:\Documents and Settings\*\Local Settings\Application Data\Google\Chrome\User Data\*\Current Tab
      Chrome Current Tab,file,C:\Users\*\AppData\Local\Google\Chrome\User Data\*\Current Tab
      Chrome Favicons,file,C:\Documents and Settings\*\Local Settings\Application Data\Google\Chrome\User Data\*\Favicons*
      Chrome Favicons,file,C:\Users\*\AppData\Local\Google\Chrome\User Data\*\Favicons*
      Chrome History,file,C:\Documents and Settings\*\Local Settings\Application Data\Google\Chrome\User Data\*\History*
      Chrome History,file,C:\Users\*\AppData\Local\Google\Chrome\User Data\*\History*
      Chrome Last Session,file,C:\Documents and Settings\*\Local Settings\Application Data\Google\Chrome\User Data\*\Last Session
      Chrome Last Session,file,C:\Users\*\AppData\Local\Google\Chrome\User Data\*\Last Session
      Chrome Last Tabs,file,C:\Documents and Settings\*\Local Settings\Application Data\Google\Chrome\User Data\*\Last Tabs
      Chrome Last Tabs,file,C:\Users\*\AppData\Local\Google\Chrome\User Data\*\Last Tabs
      Chrome Preferences,file,C:\Documents and Settings\*\Local Settings\Application Data\Google\Chrome\User Data\*\Preferences
      Chrome Preferences,file,C:\Users\*\AppData\Local\Google\Chrome\User Data\*\Preferences
      Chrome Shortcuts,file,C:\Documents and Settings\*\Local Settings\Application Data\Google\Chrome\User Data\*\Shortcuts*
      Chrome Shortcuts,file,C:\Users\*\AppData\Local\Google\Chrome\User Data\*\Shortcuts*
      Chrome Top Sites,file,C:\Documents and Settings\*\Local Settings\Application Data\Google\Chrome\User Data\*\Top Sites*
      Chrome Top Sites,file,C:\Users\*\AppData\Local\Google\Chrome\User Data\*\Top Sites
      Chrome Visited Links,file,C:\Documents and Settings\*\Local Settings\Application Data\Google\Chrome\User Data\*\Visited Links
      Chrome Visited Links,file,C:\Users\*\AppData\Local\Google\Chrome\User Data\*\Visited Links
      Chrome Web Data,file,C:\Documents and Settings\*\Local Settings\Application Data\Google\Chrome\User Data\*\Web Data*
      Chrome Web Data,file,C:\Users\*\AppData\Local\Google\Chrome\User Data\*\Web Data*

sources:
  - queries:
      - SELECT * FROM Artifact.Triage.Collection.UploadTable(triageTable=triageTable)
</code></pre>

    </div>
</div>


<h2 id="windows-triage-collectors-edge">Windows.Triage.Collectors.Edge</h2>

<p>Collect Edge related artifacts.</p>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>triageTable</td>
<td>Type,Accessor,Glob\nEdge folder,ntfs,C:\Users\<em>\AppData\Local\Packages\Microsoft.MicrosoftEdge_</em>\*<em>\nWebcacheV01.dat,ntfs,C:\Users\*\AppData\Local\Microsoft\Windows\WebCache\*</em>\n</td>
<td></td>
</tr>
</tbody>
</table>



<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fa fa-chevron-down' : 'fa fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fa fa-chevron-right"></i>
        <span>
        
        
        View Artifact Source
        
        </span>
    </div>
    <div class="expand-content" style="display: none;">
<pre><code>name: Windows.Triage.Collectors.Edge
description: |
  Collect Edge related artifacts.

precondition: SELECT OS From info() where OS = 'windows'

parameters:
  - name: triageTable
    default: |
      Type,Accessor,Glob
      Edge folder,ntfs,C:\Users\*\AppData\Local\Packages\Microsoft.MicrosoftEdge_*\**
      WebcacheV01.dat,ntfs,C:\Users\*\AppData\Local\Microsoft\Windows\WebCache\**

sources:
  - queries:
      - SELECT * FROM Artifact.Triage.Collection.UploadTable(triageTable=triageTable)
</code></pre>

    </div>
</div>


<h2 id="windows-triage-collectors-eventlogs">Windows.Triage.Collectors.EventLogs</h2>

<p>Collect event log files.</p>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>EventLogGlobs</td>
<td>C:\Windows\system32\config\*.evt,C:\Windows\system32\winevt\logs\*.evtx</td>
<td></td>
</tr>
</tbody>
</table>



<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fa fa-chevron-down' : 'fa fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fa fa-chevron-right"></i>
        <span>
        
        
        View Artifact Source
        
        </span>
    </div>
    <div class="expand-content" style="display: none;">
<pre><code>name: Windows.Triage.Collectors.EventLogs
description: |
  Collect event log files.

parameters:
  - name: EventLogGlobs
    default: C:\Windows\system32\config\*.evt,C:\Windows\system32\winevt\logs\*.evtx

precondition: SELECT OS From info() where OS = 'windows'

sources:
  - queries:
      - |
        SELECT * FROM Artifact.Triage.Collection.Upload(
           type=&quot;EventLogs&quot;,
           path=split(string=EventLogGlobs, sep=&quot;,&quot;))
</code></pre>

    </div>
</div>


<h2 id="windows-triage-collectors-eventtracelogs">Windows.Triage.Collectors.EventTraceLogs</h2>

<p>Collect event trace log files.</p>



<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fa fa-chevron-down' : 'fa fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fa fa-chevron-right"></i>
        <span>
        
        
        View Artifact Source
        
        </span>
    </div>
    <div class="expand-content" style="display: none;">
<pre><code>name: Windows.Triage.Collectors.EventTraceLogs
description: |
  Collect event trace log files.

precondition: SELECT OS From info() where OS = 'windows'

sources:
  - queries:
      - |
        SELECT * FROM chain(
          a1={ SELECT * FROM Artifact.Triage.Collection.Upload(
            type=&quot;WDI Trace Logs&quot;,
            path=[
              &quot;C:\\Windows\\System32\\WDI\\LogFiles\\*.etl*&quot;,
              &quot;C:\\Windows\\System32\\WDI\\{*&quot;
            ])
          },
          a2={ SELECT * FROM Artifact.Triage.Collection.Upload(
            type=&quot;WMI Trace Logs&quot;,
            path=&quot;C:\\Windows\\System32\\LogFiles\\WMI\\*&quot;)
          },
          a3={ SELECT * FROM Artifact.Triage.Collection.Upload(
            type=&quot;SleepStudy Trace Logs&quot;,
            path=&quot;C:\\Windows\\System32\\SleepStudy*&quot;)
          },
          a4={ SELECT * FROM Artifact.Triage.Collection.Upload(
            type=&quot;Energy-NTKL Trace Logs&quot;,
            path=&quot;C:\\ProgramData\\Microsoft\\Windows\\PowerEfficiency Diagnostics\\energy-ntkl.etl&quot;)
          }
        )
</code></pre>

    </div>
</div>


<h2 id="windows-triage-collectors-evidenceofexecution">Windows.Triage.Collectors.EvidenceOfExecution</h2>



<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fa fa-chevron-down' : 'fa fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fa fa-chevron-right"></i>
        <span>
        
        
        View Artifact Source
        
        </span>
    </div>
    <div class="expand-content" style="display: none;">
<pre><code>name: Windows.Triage.Collectors.EvidenceOfExecution

precondition: SELECT OS From info() where OS = 'windows'

sources:
  - queries:
      - |
        SELECT * FROM chain(
          a1={ SELECT * FROM Artifact.Triage.Collection.Upload(
               type=&quot;Prefetch&quot;,
               path=&quot;C:\\Windows\\prefetch\\*.pf&quot;)
          },
          a2={ SELECT * FROM Artifact.Triage.Collection.Upload(
               type=&quot;RecentFileCache&quot;,
               path=&quot;C:\\Windows\\AppCompat\\Programs\\RecentFileCache.bcf&quot;)
          }
        )
</code></pre>

    </div>
</div>


<h2 id="windows-triage-collectors-firefox">Windows.Triage.Collectors.Firefox</h2>

<p>Collect Firefox related artifacts.</p>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>baseLocations</td>
<td>C:\Users\*\AppData\Roaming\Mozilla\Firefox\Profiles\*\,C:\Documents and Settings\*\Application Data\Mozilla\Firefox\Profiles\*\</td>
<td>Globs for different possible locations of firefox profiles.</td>
</tr>
</tbody>
</table>



<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fa fa-chevron-down' : 'fa fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fa fa-chevron-right"></i>
        <span>
        
        
        View Artifact Source
        
        </span>
    </div>
    <div class="expand-content" style="display: none;">
<pre><code>name: Windows.Triage.Collectors.Firefox
description: |
  Collect Firefox related artifacts.

precondition: SELECT OS From info() where OS = 'windows'

parameters:
  - name: baseLocations
    description: Globs for different possible locations of firefox profiles.
    default: C:\Users\*\AppData\Roaming\Mozilla\Firefox\Profiles\*\,C:\Documents and Settings\*\Application Data\Mozilla\Firefox\Profiles\*\

sources:
  - queries:
      - |
        SELECT * FROM chain(
          a1={ SELECT * FROM Artifact.Triage.Collection.Upload(
               type=&quot;Places&quot;,
               path=split(string=baseLocations, sep=&quot;,&quot;) + &quot;places.sqlite*&quot;)
          },
          a2={ SELECT * FROM Artifact.Triage.Collection.Upload(
               type=&quot;Downloads&quot;,
               path=split(string=baseLocations, sep=&quot;,&quot;) + &quot;downloads.sqlite*&quot;)
          },
          a3={ SELECT * FROM Artifact.Triage.Collection.Upload(
               type=&quot;Form history&quot;,
               path=split(string=baseLocations, sep=&quot;,&quot;) + &quot;formhistory.sqlite*&quot;)
          },
          a4={ SELECT * FROM Artifact.Triage.Collection.Upload(
               type=&quot;Cookies&quot;,
               path=split(string=baseLocations, sep=&quot;,&quot;) + &quot;cookies.sqlite*&quot;)
          },
          a5={ SELECT * FROM Artifact.Triage.Collection.Upload(
               type=&quot;Signons&quot;,
               path=split(string=baseLocations, sep=&quot;,&quot;) + &quot;signons.sqlite*&quot;)
          },
          a6={ SELECT * FROM Artifact.Triage.Collection.Upload(
               type=&quot;Webappstore&quot;,
               path=split(string=baseLocations, sep=&quot;,&quot;) + &quot;webappstore.sqlite*&quot;)
          },
          a7={ SELECT * FROM Artifact.Triage.Collection.Upload(
               type=&quot;Favicons&quot;,
               path=split(string=baseLocations, sep=&quot;,&quot;) + &quot;favicons.sqlite*&quot;)
          },
          a8={ SELECT * FROM Artifact.Triage.Collection.Upload(
               type=&quot;Addons&quot;,
               path=split(string=baseLocations, sep=&quot;,&quot;) + &quot;addons.sqlite*&quot;)
          },
          a9={ SELECT * FROM Artifact.Triage.Collection.Upload(
               type=&quot;Search&quot;,
               path=split(string=baseLocations, sep=&quot;,&quot;) + &quot;search.sqlite*&quot;)
          }
          )
</code></pre>

    </div>
</div>


<h2 id="windows-triage-collectors-internetexplorer">Windows.Triage.Collectors.InternetExplorer</h2>

<p>Collect Firefox related artifacts.</p>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>triageTable</td>
<td>Type,Accessor,Glob\nIndex.dat History,file,C:\Documents and Settings\<em>\Local Settings\History\History.IE5\index.dat\nIndex.dat History,file,C:\Documents and Settings\*\Local Settings\History\History.IE5\*\index.dat\nIndex.dat temp internet files,file,C:\Documents and Settings\*\Local Settings\Temporary Internet Files\Content.IE5\index.dat\nIndex.dat cookies,file,C:\Documents and Settings\*\Cookies\index.dat\nIndex.dat UserData,file,C:\Documents and Settings\*\Application Data\Microsoft\Internet Explorer\UserData\index.dat\nIndex.dat Office XP,file,C:\Documents and Settings\*\Application Data\Microsoft\Office\Recent\index.dat\nIndex.dat Office,file,C:\Users\*\AppData\Roaming\Microsoft\Office\Recent\index.dat\nLocal Internet Explorer folder,ntfs,C:\Users\*\AppData\Local\Microsoft\Internet Explorer\*</em>\nRoaming Internet Explorer folder,file,C:\Users\<em>\AppData\Roaming\Microsoft\Internet Explorer\*</em>\nIE <sup>9</sup>&frasl;<sub>10</sub> History,file,C:\Users\<em>\AppData\Local\Microsoft\Windows\History\*</em>\nIE <sup>9</sup>&frasl;<sub>10</sub> Cache,file,C:\Users\<em>\AppData\Local\Microsoft\Windows\Temporary Internet Files\*</em>\nIE <sup>9</sup>&frasl;<sub>10</sub> Cookies,file,C:\Users\<em>\AppData\Local\Microsoft\Windows\Cookies\*</em>\nIE <sup>9</sup>&frasl;<sub>10</sub> Download History,file,C:\Users\<em>\AppData\Local\Microsoft\Windows\IEDownloadHistory\*</em>\nIE 11 Metadata,ntfs,C:\Users\<em>\AppData\Local\Microsoft\Windows\WebCache\*</em>\nIE 11 Cache,ntfs,C:\Users\<em>\AppData\Local\Microsoft\Windows\INetCache\*</em>\nIE 11 Cookies,file,C:\Users\<em>\AppData\Local\Microsoft\Windows\INetCookies\*</em>\n</td>
<td></td>
</tr>
</tbody>
</table>



<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fa fa-chevron-down' : 'fa fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fa fa-chevron-right"></i>
        <span>
        
        
        View Artifact Source
        
        </span>
    </div>
    <div class="expand-content" style="display: none;">
<pre><code>name: Windows.Triage.Collectors.InternetExplorer
description: |
  Collect Firefox related artifacts.

precondition: SELECT OS From info() where OS = 'windows'

parameters:
  - name: triageTable
    default: |
      Type,Accessor,Glob
      Index.dat History,file,C:\Documents and Settings\*\Local Settings\History\History.IE5\index.dat
      Index.dat History,file,C:\Documents and Settings\*\Local Settings\History\History.IE5\*\index.dat
      Index.dat temp internet files,file,C:\Documents and Settings\*\Local Settings\Temporary Internet Files\Content.IE5\index.dat
      Index.dat cookies,file,C:\Documents and Settings\*\Cookies\index.dat
      Index.dat UserData,file,C:\Documents and Settings\*\Application Data\Microsoft\Internet Explorer\UserData\index.dat
      Index.dat Office XP,file,C:\Documents and Settings\*\Application Data\Microsoft\Office\Recent\index.dat
      Index.dat Office,file,C:\Users\*\AppData\Roaming\Microsoft\Office\Recent\index.dat
      Local Internet Explorer folder,ntfs,C:\Users\*\AppData\Local\Microsoft\Internet Explorer\**
      Roaming Internet Explorer folder,file,C:\Users\*\AppData\Roaming\Microsoft\Internet Explorer\**
      IE 9/10 History,file,C:\Users\*\AppData\Local\Microsoft\Windows\History\**
      IE 9/10 Cache,file,C:\Users\*\AppData\Local\Microsoft\Windows\Temporary Internet Files\**
      IE 9/10 Cookies,file,C:\Users\*\AppData\Local\Microsoft\Windows\Cookies\**
      IE 9/10 Download History,file,C:\Users\*\AppData\Local\Microsoft\Windows\IEDownloadHistory\**
      IE 11 Metadata,ntfs,C:\Users\*\AppData\Local\Microsoft\Windows\WebCache\**
      IE 11 Cache,ntfs,C:\Users\*\AppData\Local\Microsoft\Windows\INetCache\**
      IE 11 Cookies,file,C:\Users\*\AppData\Local\Microsoft\Windows\INetCookies\**

sources:
  - queries:
      - SELECT * FROM Artifact.Triage.Collection.UploadTable(triageTable=triageTable)
</code></pre>

    </div>
</div>


<h2 id="windows-triage-collectors-jabber">Windows.Triage.Collectors.Jabber</h2>

<p>Jabber.</p>



<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fa fa-chevron-down' : 'fa fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fa fa-chevron-right"></i>
        <span>
        
        
        View Artifact Source
        
        </span>
    </div>
    <div class="expand-content" style="display: none;">
<pre><code>name: Windows.Triage.Collectors.Jabber
description: |
  Jabber.

precondition: SELECT OS From info() where OS = 'windows'

sources:
  - queries:
      - |
        SELECT * FROM chain(
          a1={ SELECT * FROM Artifact.Triage.Collection.Upload(
               type=&quot;Cisco Jabber Database&quot;,
               accessor=&quot;ntfs&quot;,
               path=[
                 &quot;C:\\Users\\*\\AppData\\Local\\Cisco\\Unified Communications\\Jabber\\CSF\\History\\*.db&quot;
               ])
          }
        )
</code></pre>

    </div>
</div>


<h2 id="windows-triage-collectors-lnkfiles">Windows.Triage.Collectors.LnkFiles</h2>

<p>Lnk files and jump lists.</p>



<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fa fa-chevron-down' : 'fa fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fa fa-chevron-right"></i>
        <span>
        
        
        View Artifact Source
        
        </span>
    </div>
    <div class="expand-content" style="display: none;">
<pre><code>name: Windows.Triage.Collectors.LnkFiles
description: |
  Lnk files and jump lists.

precondition: SELECT OS From info() where OS = 'windows'

sources:
  - queries:
      - |
        SELECT * FROM chain(
          a1={ SELECT * FROM Artifact.Triage.Collection.Upload(
               type=&quot;Lnk files from Recent&quot;,
               path=[
                 &quot;C:\\Users\\*\\AppData\\Roaming\\Microsoft\\Windows\\Recent\\**&quot;,
                 &quot;C:\\Users\\*\\AppData\\Roaming\\Microsoft\\Office\\Recent\\**&quot;,
                 &quot;C:\\Documents and Settings\\*\\Recent\\**&quot;
               ])
          },
          a2={ SELECT * FROM Artifact.Triage.Collection.Upload(
               type=&quot;Desktop lnk files&quot;,
               path=[
                 &quot;C:\\Documents and Settings\\*\\Desktop\\*.lnk&quot;,
                 &quot;C:\\Users\\*\\Desktop\\*.lnk&quot;
              ])
          },
          a3={ SELECT * FROM Artifact.Triage.Collection.Upload(
               type=&quot;Restore point lnk files XP&quot;,
               path=&quot;C:\\System Volume Information\\_restore*\\RP*\\*.lnk&quot;)
          }
        )
</code></pre>

    </div>
</div>


<h2 id="windows-triage-collectors-ntfsmetadata">Windows.Triage.Collectors.NTFSMetadata</h2>



<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fa fa-chevron-down' : 'fa fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fa fa-chevron-right"></i>
        <span>
        
        
        View Artifact Source
        
        </span>
    </div>
    <div class="expand-content" style="display: none;">
<pre><code>name: Windows.Triage.Collectors.NTFSMetadata

precondition: SELECT OS From info() where OS = 'windows'

reference:
  - https://github.com/EricZimmerman/KapeFiles

sources:
  - name: NTFS Metadata Files
    queries:
      - |
        SELECT * FROM Artifact.Triage.Collection.Upload(
        type=&quot;NTFS Metadata Files&quot;,
        accessor=&quot;ntfs&quot;,
        path=[
            &quot;C:\\$MFT&quot;,
            &quot;C:\\$LogFile&quot;,
            &quot;C:\\$Extend\\$UsnJrnl:$J&quot;,
            &quot;C:\\$Extend\\$UsnJrnl:$Max&quot;,
            &quot;C:\\$Secure:$SDS&quot;,
            &quot;C:\\$Boot&quot;,
            &quot;C:\\$Extend\\$RmMetadata\\$TxfLog\\$Tops:$T&quot;
        ])
</code></pre>

    </div>
</div>


<h2 id="windows-triage-collectors-outlookpst">Windows.Triage.Collectors.OutlookPST</h2>

<p>Outlook PST and OST files.</p>



<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fa fa-chevron-down' : 'fa fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fa fa-chevron-right"></i>
        <span>
        
        
        View Artifact Source
        
        </span>
    </div>
    <div class="expand-content" style="display: none;">
<pre><code>name: Windows.Triage.Collectors.OutlookPST
description: |
  Outlook PST and OST files.

precondition: SELECT OS From info() where OS = 'windows'

sources:
  - queries:
      - |
        SELECT * FROM chain(
          a1={ SELECT * FROM Artifact.Triage.Collection.Upload(
               type=&quot;PST&quot;,
               path=[
                 &quot;C:\\Documents and Settings\\*\\Local Settings\\Application Data\\Microsoft\\Outlook\\*.pst&quot;,
                 &quot;C:\\Users\\*\\AppData\\Local\\Microsoft\\Outlook\\*.pst&quot;
               ])
          },
          a2={ SELECT * FROM Artifact.Triage.Collection.Upload(
               type=&quot;OST&quot;,
               path=[
                 &quot;C:\\Documents and Settings\\*\\Local Settings\\Application Data\\Microsoft\\Outlook\\*.ost&quot;,
                 &quot;C:\\Users\\*\\AppData\\Local\\Microsoft\\Outlook\\*.ost&quot;
              ])
          }
        )
</code></pre>

    </div>
</div>


<h2 id="windows-triage-collectors-powershellconsolelogs">Windows.Triage.Collectors.PowershellConsoleLogs</h2>

<p>PowerShell Console Log File.</p>



<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fa fa-chevron-down' : 'fa fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fa fa-chevron-right"></i>
        <span>
        
        
        View Artifact Source
        
        </span>
    </div>
    <div class="expand-content" style="display: none;">
<pre><code>name: Windows.Triage.Collectors.PowershellConsoleLogs
description: |
  PowerShell Console Log File.

precondition: SELECT OS From info() where OS = 'windows'

sources:
  - queries:
      - |
        SELECT * FROM chain(
          a1={ SELECT * FROM Artifact.Triage.Collection.Upload(
               type=&quot;PowerShell Console Log&quot;,
               path=&quot;C:\\users\\*\\Appdata\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadline\\ConsoleHost_history.txt&quot;)
          }
        )
</code></pre>

    </div>
</div>


<h2 id="windows-triage-collectors-recyclebin">Windows.Triage.Collectors.RecycleBin</h2>

<p>Collect contents of Recycle Bin.</p>



<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fa fa-chevron-down' : 'fa fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fa fa-chevron-right"></i>
        <span>
        
        
        View Artifact Source
        
        </span>
    </div>
    <div class="expand-content" style="display: none;">
<pre><code>name: Windows.Triage.Collectors.RecycleBin
description: |
  Collect contents of Recycle Bin.


precondition: SELECT OS From info() where OS = 'windows'

sources:
  - queries:
      - |
        SELECT * FROM chain(
          a1={ SELECT * FROM Artifact.Triage.Collection.Upload(
               type=&quot;Recycle.Bin&quot;,
               path=[
                 &quot;C:\\$Recycle.Bin\\**&quot;,
                 &quot;C:\\RECYCLER\\**&quot;
               ])
          }
        )
</code></pre>

    </div>
</div>


<h2 id="windows-triage-collectors-registryhives">Windows.Triage.Collectors.RegistryHives</h2>

<p>System and user related Registry hives.</p>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>triageTable</td>
<td>Type,Accessor,Glob\nntuser.dat registry hive,ntfs,C:\Documents and Settings\<em>\ntuser.dat\nntuser.dat registry hive,ntfs,C:\Users\*\ntuser.dat\nntuser.dat registry transaction files,ntfs,C:\Documents and Settings\*\ntuser.dat.LOG</em>\nntuser.dat registry transaction files,ntfs,C:\Users\<em>\ntuser.dat.LOG</em>\nUsrClass.dat registry hive,ntfs,C:\Users\<em>\AppData\Local\Microsoft\Windows\UsrClass.dat\nUsrClass.dat registry transaction files,ntfs,C:\Users\*\AppData\Local\Microsoft\Windows\UsrClass.dat.LOG</em>\nSAM registry transaction files,ntfs,C:\Windows\System32\config\SAM.LOG<em>\nSECURITY registry transaction files,ntfs,C:\Windows\System32\config\SECURITY.LOG</em>\nSYSTEM registry transaction files,ntfs,C:\Windows\System32\config\SYSTEM.LOG<em>\nSAM registry hive,ntfs,C:\Windows\System32\config\SAM\nSECURITY registry hive,ntfs,C:\Windows\System32\config\SECURITY\nSOFTWARE registry hive,ntfs,C:\Windows\System32\config\SOFTWARE\nSYSTEM registry hive,ntfs,C:\Windows\System32\config\SYSTEM\nRegBack registry transaction files,ntfs,C:\Windows\System32\config\RegBack\*.LOG</em>\nSAM registry hive (RegBack),ntfs,C:\Windows\System32\config\RegBack\SAM\nSECURITY registry hive (RegBack),ntfs,C:\Windows\System32\config\RegBack\SECURITY\nSOFTWARE registry hive (RegBack),ntfs,C:\Windows\System32\config\RegBack\SOFTWARE\nSYSTEM registry hive (RegBack),ntfs,C:\Windows\System32\config\RegBack\SYSTEM\nSystem Profile registry hive,ntfs,C:\Windows\System32\config\systemprofile\ntuser.dat\nSystem Profile registry transaction files,ntfs,C:\Windows\System32\config\systemprofile\ntuser.dat.LOG<em>\nLocal Service registry hive,ntfs,C:\Windows\ServiceProfiles\LocalService\ntuser.dat\nLocal Service registry transaction files,ntfs,C:\Windows\ServiceProfiles\LocalService\ntuser.dat.LOG</em>\nNetwork Service registry hive,ntfs,C:\Windows\ServiceProfiles\NetworkService\ntuser.dat\nNetwork Service registry transaction files,ntfs,C:\Windows\ServiceProfiles\NetworkService\ntuser.dat.LOG<em>\nSystem Restore Points Registry Hives (XP),ntfs,C:\System Volume Information\_restore</em>\RP<em>\snapshot\<em>REGISTRY</em></em>\n</td>
<td></td>
</tr>
</tbody>
</table>



<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fa fa-chevron-down' : 'fa fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fa fa-chevron-right"></i>
        <span>
        
        
        View Artifact Source
        
        </span>
    </div>
    <div class="expand-content" style="display: none;">
<pre><code>name: Windows.Triage.Collectors.RegistryHives
description: |
  System and user related Registry hives.

precondition: SELECT OS From info() where OS = 'windows'

reference:
  - https://github.com/EricZimmerman/KapeFiles

parameters:
  - name: triageTable
    default: |
      Type,Accessor,Glob
      ntuser.dat registry hive,ntfs,C:\Documents and Settings\*\ntuser.dat
      ntuser.dat registry hive,ntfs,C:\Users\*\ntuser.dat
      ntuser.dat registry transaction files,ntfs,C:\Documents and Settings\*\ntuser.dat.LOG*
      ntuser.dat registry transaction files,ntfs,C:\Users\*\ntuser.dat.LOG*
      UsrClass.dat registry hive,ntfs,C:\Users\*\AppData\Local\Microsoft\Windows\UsrClass.dat
      UsrClass.dat registry transaction files,ntfs,C:\Users\*\AppData\Local\Microsoft\Windows\UsrClass.dat.LOG*
      SAM registry transaction files,ntfs,C:\Windows\System32\config\SAM.LOG*
      SECURITY registry transaction files,ntfs,C:\Windows\System32\config\SECURITY.LOG*
      SYSTEM registry transaction files,ntfs,C:\Windows\System32\config\SYSTEM.LOG*
      SAM registry hive,ntfs,C:\Windows\System32\config\SAM
      SECURITY registry hive,ntfs,C:\Windows\System32\config\SECURITY
      SOFTWARE registry hive,ntfs,C:\Windows\System32\config\SOFTWARE
      SYSTEM registry hive,ntfs,C:\Windows\System32\config\SYSTEM
      RegBack registry transaction files,ntfs,C:\Windows\System32\config\RegBack\*.LOG*
      SAM registry hive (RegBack),ntfs,C:\Windows\System32\config\RegBack\SAM
      SECURITY registry hive (RegBack),ntfs,C:\Windows\System32\config\RegBack\SECURITY
      SOFTWARE registry hive (RegBack),ntfs,C:\Windows\System32\config\RegBack\SOFTWARE
      SYSTEM registry hive (RegBack),ntfs,C:\Windows\System32\config\RegBack\SYSTEM
      System Profile registry hive,ntfs,C:\Windows\System32\config\systemprofile\ntuser.dat
      System Profile registry transaction files,ntfs,C:\Windows\System32\config\systemprofile\ntuser.dat.LOG*
      Local Service registry hive,ntfs,C:\Windows\ServiceProfiles\LocalService\ntuser.dat
      Local Service registry transaction files,ntfs,C:\Windows\ServiceProfiles\LocalService\ntuser.dat.LOG*
      Network Service registry hive,ntfs,C:\Windows\ServiceProfiles\NetworkService\ntuser.dat
      Network Service registry transaction files,ntfs,C:\Windows\ServiceProfiles\NetworkService\ntuser.dat.LOG*
      System Restore Points Registry Hives (XP),ntfs,C:\System Volume Information\_restore*\RP*\snapshot\_REGISTRY_*

sources:
  - queries:
      - SELECT * FROM Artifact.Triage.Collection.UploadTable(
               triageTable=triageTable)
</code></pre>

    </div>
</div>


<h2 id="windows-triage-collectors-srum">Windows.Triage.Collectors.SRUM</h2>

<p>System Resource Usage Monitor (SRUM) Data.</p>



<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fa fa-chevron-down' : 'fa fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fa fa-chevron-right"></i>
        <span>
        
        
        View Artifact Source
        
        </span>
    </div>
    <div class="expand-content" style="display: none;">
<pre><code>name: Windows.Triage.Collectors.SRUM
description: |
  System Resource Usage Monitor (SRUM) Data.

precondition: SELECT OS From info() where OS = 'windows'

sources:
  - queries:
      - |
        SELECT * FROM chain(
          a1={ SELECT * FROM Artifact.Triage.Collection.Upload(
               type=&quot;SRUM&quot;,
               path=&quot;C:\\Windows\\System32\\SRU\\**&quot;)
          }
        )
</code></pre>

    </div>
</div>


<h2 id="windows-triage-collectors-scheduledtasks">Windows.Triage.Collectors.ScheduledTasks</h2>

<p>Scheduled tasks (*.job and XML).</p>



<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fa fa-chevron-down' : 'fa fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fa fa-chevron-right"></i>
        <span>
        
        
        View Artifact Source
        
        </span>
    </div>
    <div class="expand-content" style="display: none;">
<pre><code>name: Windows.Triage.Collectors.ScheduledTasks
description: |
  Scheduled tasks (*.job and XML).

precondition: SELECT OS From info() where OS = 'windows'

sources:
  - queries:
      - |
        SELECT * FROM chain(
          a1={ SELECT * FROM Artifact.Triage.Collection.Upload(
               type=&quot;at .job&quot;,
               path=&quot;C:\\Windows\\Tasks\\*.job&quot;)
          },
          a1={ SELECT * FROM Artifact.Triage.Collection.Upload(
               type=&quot;at SchedLgU.txt&quot;,
               path=&quot;C:\\Windows\\SchedLgU.txt&quot;)
          },
          a2={ SELECT * FROM Artifact.Triage.Collection.Upload(
               type=&quot;XML&quot;,
               path=&quot;C:\\Windows\\system32\\Tasks\\**&quot;)
          }
        )
</code></pre>

    </div>
</div>


<h2 id="windows-triage-collectors-skype">Windows.Triage.Collectors.Skype</h2>

<p>Skype.</p>



<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fa fa-chevron-down' : 'fa fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fa fa-chevron-right"></i>
        <span>
        
        
        View Artifact Source
        
        </span>
    </div>
    <div class="expand-content" style="display: none;">
<pre><code>name: Windows.Triage.Collectors.Skype
description: |
  Skype.

precondition: SELECT OS From info() where OS = 'windows'

sources:
  - queries:
      - |
        SELECT * FROM chain(
          a1={ SELECT * FROM Artifact.Triage.Collection.Upload(
               type=&quot;main.db&quot;,
               path=[
                  &quot;C:\\Users\\*\\AppData\\Local\\Packages\\Microsoft.SkypeApp_*\\LocalState\\*\\main.db&quot;,
                  &quot;C:\\Documents and Settings\\*\\Application Data\\Skype\\*\\main.db&quot;,
                  &quot;C:\\Users\\*\\AppData\\Roaming\\Skype\\*\\main.db&quot;
               ])
          }
        )
</code></pre>

    </div>
</div>


<h2 id="windows-triage-collectors-startupinfo">Windows.Triage.Collectors.StartupInfo</h2>

<p>StartupInfo XML Files.</p>



<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fa fa-chevron-down' : 'fa fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fa fa-chevron-right"></i>
        <span>
        
        
        View Artifact Source
        
        </span>
    </div>
    <div class="expand-content" style="display: none;">
<pre><code>name: Windows.Triage.Collectors.StartupInfo
description: |
  StartupInfo XML Files.

precondition: SELECT OS From info() where OS = 'windows'

sources:
  - queries:
      - |
        SELECT * FROM chain(
          a1={ SELECT * FROM Artifact.Triage.Collection.Upload(
               type=&quot;StartupInfo XML Files&quot;,
               path=[
                  &quot;C:\\Windows\\System32\\WDI\\LogFiles\\StartupInfo\\*.xml&quot;
               ])
          }
        )
</code></pre>

    </div>
</div>


<h2 id="windows-triage-collectors-teracopy">Windows.Triage.Collectors.TeraCopy</h2>

<p>TeraCopy log history.</p>



<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fa fa-chevron-down' : 'fa fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fa fa-chevron-right"></i>
        <span>
        
        
        View Artifact Source
        
        </span>
    </div>
    <div class="expand-content" style="display: none;">
<pre><code>name: Windows.Triage.Collectors.TeraCopy
description: |
  TeraCopy log history.

precondition: SELECT OS From info() where OS = 'windows'

sources:
  - queries:
      - |
        SELECT * FROM chain(
          a1={ SELECT * FROM Artifact.Triage.Collection.Upload(
               type=&quot;TeraCopy&quot;,
               path=[
                  &quot;C:\\Users\\*\\AppData\\Roaming\\TeraCopy&quot;
               ])
          }
        )
</code></pre>

    </div>
</div>


<h2 id="windows-triage-collectors-thumbdb">Windows.Triage.Collectors.ThumbDB</h2>

<p>Thumbcache DB.</p>



<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fa fa-chevron-down' : 'fa fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fa fa-chevron-right"></i>
        <span>
        
        
        View Artifact Source
        
        </span>
    </div>
    <div class="expand-content" style="display: none;">
<pre><code>name: Windows.Triage.Collectors.ThumbDB
description: |
  Thumbcache DB.

precondition: SELECT OS From info() where OS = 'windows'

sources:
  - queries:
      - |
        SELECT * FROM chain(
          a1={ SELECT * FROM Artifact.Triage.Collection.Upload(
               type=&quot;Thumbcache DB&quot;,
               path=[
                  &quot;C:\\Users\\*\\AppData\\Local\\Microsoft\\Windows\\Explorer\\thumbcache_*.db&quot;
               ])
          }
        )
</code></pre>

    </div>
</div>


<h2 id="windows-triage-collectors-usbdevicelogs">Windows.Triage.Collectors.USBDeviceLogs</h2>

<p>USB devices log files.</p>



<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fa fa-chevron-down' : 'fa fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fa fa-chevron-right"></i>
        <span>
        
        
        View Artifact Source
        
        </span>
    </div>
    <div class="expand-content" style="display: none;">
<pre><code>name: Windows.Triage.Collectors.USBDeviceLogs
description: |
  USB devices log files.

precondition: SELECT OS From info() where OS = 'windows'

sources:
  - queries:
      - |
        SELECT * FROM chain(
          a1={ SELECT * FROM Artifact.Triage.Collection.Upload(
               type=&quot;Setupapi.log&quot;,
               path=[
                  &quot;C:\\Windows\\setupapi.log&quot;,
                  &quot;C:\\Windows\\inf\\setupapi.dev.log&quot;
               ])
          }
        )
</code></pre>

    </div>
</div>


<h2 id="windows-triage-collectors-wbem">Windows.Triage.Collectors.WBEM</h2>

<p>Web-Based Enterprise Management (WBEM).</p>



<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fa fa-chevron-down' : 'fa fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fa fa-chevron-right"></i>
        <span>
        
        
        View Artifact Source
        
        </span>
    </div>
    <div class="expand-content" style="display: none;">
<pre><code>name: Windows.Triage.Collectors.WBEM
description: |
  Web-Based Enterprise Management (WBEM).

precondition: SELECT OS From info() where OS = 'windows'

sources:
  - queries:
      - |
        SELECT * FROM chain(
          a1={ SELECT * FROM Artifact.Triage.Collection.Upload(
               type=&quot;WBEM&quot;,
               path=[
                 &quot;C:\\Windows\\System32\\wbem\\Repository&quot;
               ])
          }
        )
</code></pre>

    </div>
</div>


<h2 id="windows-triage-collectors-windowsfirewall">Windows.Triage.Collectors.WindowsFirewall</h2>

<p>Windows Firewall Logs.</p>



<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fa fa-chevron-down' : 'fa fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fa fa-chevron-right"></i>
        <span>
        
        
        View Artifact Source
        
        </span>
    </div>
    <div class="expand-content" style="display: none;">
<pre><code>name: Windows.Triage.Collectors.WindowsFirewall
description: |
  Windows Firewall Logs.

precondition: SELECT OS From info() where OS = 'windows'

sources:
  - queries:
      - |
        SELECT * FROM chain(
          a1={ SELECT * FROM Artifact.Triage.Collection.Upload(
               type=&quot;Windows Firewall Logs&quot;,
               path=&quot;C:\\Windows\\System32\\LogFiles\\Firewall\\pfirewall.*&quot;)
          }
        )
</code></pre>

    </div>
</div>


<h2 id="windows-triage-collectors-windowsindex">Windows.Triage.Collectors.WindowsIndex</h2>

<p>Windows Index Search.</p>



<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fa fa-chevron-down' : 'fa fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fa fa-chevron-right"></i>
        <span>
        
        
        View Artifact Source
        
        </span>
    </div>
    <div class="expand-content" style="display: none;">
<pre><code>name: Windows.Triage.Collectors.WindowsIndex
description: |
  Windows Index Search.

precondition: SELECT OS From info() where OS = 'windows'

sources:
  - queries:
      - |
        SELECT * FROM chain(
          a1={ SELECT * FROM Artifact.Triage.Collection.Upload(
               type=&quot;WindowsIndexSearch&quot;,
               path=&quot;C:\\programdata\\microsoft\\search\\data\\applications\\windows\\Windows.edb&quot;)
          }
        )
</code></pre>

    </div>
</div>


<h2 id="windows-triage-processmemory">Windows.Triage.ProcessMemory</h2>

<p>Dump process memory and upload to the server</p>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>processRegex</td>
<td>notepad</td>
<td></td>
</tr>
</tbody>
</table>



<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fa fa-chevron-down' : 'fa fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fa fa-chevron-right"></i>
        <span>
        
        
        View Artifact Source
        
        </span>
    </div>
    <div class="expand-content" style="display: none;">
<pre><code>name: Windows.Triage.ProcessMemory
description: |
  Dump process memory and upload to the server

precondition: SELECT OS From info() where OS = 'windows'

parameters:
  - name: processRegex
    default: notepad

sources:
  - queries:
      - |
        LET processes = SELECT Name as ProcessName, CommandLine, Pid
            FROM pslist()
            WHERE Name =~ processRegex

      - |
        SELECT * FROM foreach(
          row=processes,
          query={
            SELECT ProcessName, CommandLine, Pid, FullPath,
                   upload(file=FullPath) as CrashDump
            FROM proc_dump(pid=Pid)
          })
</code></pre>

    </div>
</div>


<h2 id="windows-triage-webbrowsers">Windows.Triage.WebBrowsers</h2>

<p>A high level artifact for selecting all browser related artifacts.</p>



<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fa fa-chevron-down' : 'fa fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fa fa-chevron-right"></i>
        <span>
        
        
        View Artifact Source
        
        </span>
    </div>
    <div class="expand-content" style="display: none;">
<pre><code>name: Windows.Triage.WebBrowsers
description: |
  A high level artifact for selecting all browser related artifacts.

precondition: SELECT OS From info() where OS = 'windows'

sources:
  - queries:
      - |
        SELECT * FROM chain(
          a1={ SELECT * FROM Artifact.Windows.Triage.Collectors.Chrome() },
          a2={ SELECT * FROM Artifact.Windows.Triage.Collectors.Firefox() },
          a3={ SELECT * FROM Artifact.Windows.Triage.Collectors.Edge() },
          a4={ SELECT * FROM Artifact.Windows.Triage.Collectors.InternetExplorer() }
        )
</code></pre>

    </div>
</div>


<h2 id="triage-collection-upload">Triage.Collection.Upload</h2>

<p>A Generic uploader used by triaging artifacts.</p>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>path</td>
<td></td>
<td>This is the glob of the files we use.</td>
</tr>

<tr>
<td>type</td>
<td></td>
<td>The type of files these are.</td>
</tr>

<tr>
<td>accessor</td>
<td>file</td>
<td></td>
</tr>
</tbody>
</table>



<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fa fa-chevron-down' : 'fa fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fa fa-chevron-right"></i>
        <span>
        
        
        View Artifact Source
        
        </span>
    </div>
    <div class="expand-content" style="display: none;">
<pre><code>name: Triage.Collection.Upload
description: |
  A Generic uploader used by triaging artifacts.

parameters:
  - name: path
    description: This is the glob of the files we use.
  - name: type
    description: The type of files these are.
  - name: accessor
    default: file

sources:
  - queries:
      - |
        LET results = SELECT FullPath, Size,
               timestamp(epoch=Mtime.Sec) As Modified,
               type AS Type, {
                 SELECT * FROM upload(files=FullPath, accessor=accessor)
               } AS FileDetails
        FROM glob(globs=path, accessor=accessor)
        WHERE NOT IsDir
      - |
        SELECT FullPath, Size, Modified, Type,
               FileDetails.Path AS ZipPath,
               FileDetails.Md5 as Md5,
               FileDetails.Sha256 as SHA256
        FROM results
</code></pre>

    </div>
</div>


<h2 id="triage-collection-uploadtable">Triage.Collection.UploadTable</h2>

<p>A Generic uploader used by triaging artifacts. This is similar to
<code>Triage.Collection.Upload</code> but uses a CSV table to drive it.</p>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>triageTable</td>
<td>Type,Accessor,Glob\n</td>
<td>A CSV table controlling upload. Must have the headers: Type, Accessor, Glob.</td>
</tr>
</tbody>
</table>



<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fa fa-chevron-down' : 'fa fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fa fa-chevron-right"></i>
        <span>
        
        
        View Artifact Source
        
        </span>
    </div>
    <div class="expand-content" style="display: none;">
<pre><code>name: Triage.Collection.UploadTable
description: |
  A Generic uploader used by triaging artifacts. This is similar to
  `Triage.Collection.Upload` but uses a CSV table to drive it.

parameters:
  - name: triageTable
    description: &quot;A CSV table controlling upload. Must have the headers: Type, Accessor, Glob.&quot;
    default: |
      Type,Accessor,Glob

sources:
  - queries:
      - |
        LET results = SELECT FullPath, Size,
               timestamp(epoch=Mtime.Sec) As Modified,
               Type, {
                 SELECT * FROM upload(files=FullPath, accessor=Accessor)
               } AS FileDetails
        FROM glob(globs=split(string=Glob, sep=&quot;,&quot;), accessor=Accessor)
        WHERE NOT IsDir

      - |
        SELECT * FROM foreach(
         row={
           SELECT * FROM parse_csv(filename=triageTable, accessor='data')
         },
         query={
           SELECT FullPath, Size, Modified, Type,
               FileDetails.Path AS ZipPath,
               FileDetails.Md5 as Md5,
               FileDetails.Sha256 as SHA256
          FROM results
        })
</code></pre>

    </div>
</div>


<h2 id="windows-forensics-bam">Windows.Forensics.Bam</h2>

<p>The Background Activity Moderator (BAM) is a Windows service that
Controls activity of background applications.  This service exists
in Windows 10 only after Fall Creators update – version 1709.</p>

<p>It provides full path of the executable file that was run on the
system and last execution date/time</p>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>bamKeys</td>
<td>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\bam\UserSettings\*\*,HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\bam\State\UserSettings\*\*</td>
<td></td>
</tr>
</tbody>
</table>



<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fa fa-chevron-down' : 'fa fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fa fa-chevron-right"></i>
        <span>
        
        
        View Artifact Source
        
        </span>
    </div>
    <div class="expand-content" style="display: none;">
<pre><code>name: Windows.Forensics.Bam
description: |
  The Background Activity Moderator (BAM) is a Windows service that
  Controls activity of background applications.  This service exists
  in Windows 10 only after Fall Creators update – version 1709.

  It provides full path of the executable file that was run on the
  system and last execution date/time

reference:
  - https://www.andreafortuna.org/dfir/forensic-artifacts-evidences-of-program-execution-on-windows-systems/

parameters:
    - name: bamKeys
      default: HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\bam\UserSettings\*\*,HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\bam\State\UserSettings\*\*

sources:
  - precondition:
      SELECT OS from info() where OS = &quot;windows&quot;
    queries:
      - |
        LET users &lt;= SELECT Name, UUID FROM Artifact.Windows.Sys.Users()
      - |
        SELECT basename(path=dirname(path=FullPath)) as SID, {
            SELECT Name FROM users
            WHERE UUID = basename(path=dirname(path=FullPath))
          } As UserName,
          Name as Binary,
          timestamp(winfiletime=binary_parse(
               string=Data.value,
               target=&quot;int64&quot;).AsInteger) as Bam_time
        FROM glob(globs=split(string=bamKeys, sep=&quot;,&quot;), accessor=&quot;reg&quot;)
        WHERE Data.type = &quot;BINARY&quot;
</code></pre>

    </div>
</div>


<h2 id="windows-forensics-filenamesearch">Windows.Forensics.FilenameSearch</h2>

<p>Did a specific file exist on this machine in the past or does it
still exist on this machine?</p>

<p>This common question comes up frequently in cases of IP theft,
discovery and other matters. One way to answer this question is to
search the $MFT file for any references to the specific filename. If
the filename is fairly unique then a positive hit on that name
generally means the file was present.</p>

<p>Simply determining that a filename existed on an endpoint in the
past is significant for some investigations.</p>

<p>This artifact applies a YARA search for a set of filenames of
interest on the $MFT file. For any hit, the artifact then identified
the MFT entry where the hit was found and attempts to resolve that
to an actual filename.</p>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>yaraRule</td>
<td>wide nocase:my secret file.txt</td>
<td></td>
</tr>

<tr>
<td>Device</td>
<td>\\.\c:</td>
<td></td>
</tr>
</tbody>
</table>



<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fa fa-chevron-down' : 'fa fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fa fa-chevron-right"></i>
        <span>
        
        
        View Artifact Source
        
        </span>
    </div>
    <div class="expand-content" style="display: none;">
<pre><code>name: Windows.Forensics.FilenameSearch
description: |
  Did a specific file exist on this machine in the past or does it
  still exist on this machine?

  This common question comes up frequently in cases of IP theft,
  discovery and other matters. One way to answer this question is to
  search the $MFT file for any references to the specific filename. If
  the filename is fairly unique then a positive hit on that name
  generally means the file was present.

  Simply determining that a filename existed on an endpoint in the
  past is significant for some investigations.

  This artifact applies a YARA search for a set of filenames of
  interest on the $MFT file. For any hit, the artifact then identified
  the MFT entry where the hit was found and attempts to resolve that
  to an actual filename.

parameters:
    - name: yaraRule
      default: wide nocase:my secret file.txt
    - name: Device
      default: &quot;\\\\.\\c:&quot;

sources:
  - queries:
      - |
        SELECT String.Offset AS Offset,
               String.HexData AS HexData,
               parse_ntfs(device=Device,
                          mft=String.Offset / 1024) AS MFT
        FROM yara(
             rules=yaraRule, files=Device + &quot;/$MFT&quot;,
             end=10000000000,
             number_of_hits=1000,
             accessor=&quot;ntfs&quot;)
</code></pre>

    </div>
</div>


<h2 id="windows-forensics-prefetch">Windows.Forensics.Prefetch</h2>

<p>Windows keeps a cache of prefetch files. When an executable is run,
the system records properties about the executable to make it faster
to run next time. By parsing this information we are able to
determine when binaries are run in the past. On Windows10 we can see
the last 8 execution times.</p>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>prefetchGlobs</td>
<td>C:\Windows\Prefetch\*.pf</td>
<td></td>
</tr>
</tbody>
</table>



<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fa fa-chevron-down' : 'fa fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fa fa-chevron-right"></i>
        <span>
        
        
        View Artifact Source
        
        </span>
    </div>
    <div class="expand-content" style="display: none;">
<pre><code>name: Windows.Forensics.Prefetch
description: |
  Windows keeps a cache of prefetch files. When an executable is run,
  the system records properties about the executable to make it faster
  to run next time. By parsing this information we are able to
  determine when binaries are run in the past. On Windows10 we can see
  the last 8 execution times.

reference:
  - https://www.forensicswiki.org/wiki/Prefetch

parameters:
    - name: prefetchGlobs
      default: C:\Windows\Prefetch\*.pf

precondition: SELECT OS From info() where OS = 'windows'

sources:
  - queries:
      - |
        SELECT * FROM foreach(
          row={
             SELECT * FROM glob(globs=prefetchGlobs)
          },
          query={
             SELECT Name AS PrefetchFileName,
                    Executable, FileSize, LastRunTimes,
                    LastRunTimes.Unix AS LastExecutionTS,
                    RunCount
             FROM prefetch(filename=FullPath)
          })
</code></pre>

    </div>
</div>


<h2 id="windows-forensics-recentapps">Windows.Forensics.RecentApps</h2>

<p>GUI Program execution launched on the Win10 system is tracked in the
RecentApps key</p>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>UserFilter</td>
<td></td>
<td>If specified we filter by this user ID.</td>
</tr>

<tr>
<td>ExecutionTimeAfter</td>
<td></td>
<td>If specified only show executions after this time.</td>
</tr>

<tr>
<td>RecentAppsKey</td>
<td>Software\Microsoft\Windows\CurrentVersion\Search\RecentApps\*</td>
<td></td>
</tr>

<tr>
<td>UserHomes</td>
<td>C:\Users\*\NTUSER.DAT</td>
<td></td>
</tr>
</tbody>
</table>



<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fa fa-chevron-down' : 'fa fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fa fa-chevron-right"></i>
        <span>
        
        
        View Artifact Source
        
        </span>
    </div>
    <div class="expand-content" style="display: none;">
<pre><code>name: Windows.Forensics.RecentApps
description: |
  GUI Program execution launched on the Win10 system is tracked in the
  RecentApps key

reference:
  - https://www.sans.org/security-resources/posters/windows-forensics-evidence-of/75/download

precondition: SELECT OS From info() where OS = 'windows'

parameters:
  - name: UserFilter
    default: &quot;&quot;
    description: If specified we filter by this user ID.

  - name: ExecutionTimeAfter
    default: &quot;&quot;
    type: timestamp
    description: If specified only show executions after this time.

  - name: RecentAppsKey
    default: Software\Microsoft\Windows\CurrentVersion\Search\RecentApps\*

  - name: UserHomes
    default: C:\Users\*\NTUSER.DAT

sources:
  - queries:
      - LET TMP = SELECT * FROM foreach(
         row={
            SELECT FullPath FROM glob(globs=UserHomes)
         },
         query={
            SELECT AppId, AppPath, LaunchCount,
                   timestamp(winfiletime=LastAccessedTime) AS LastExecution,
                   timestamp(winfiletime=LastAccessedTime).Unix AS LastExecutionTS,
                   parse_string_with_regex(
                      string=Key.FullPath,
                      regex=&quot;/Users/(?P&lt;User&gt;[^/]+)/ntuser.dat&quot;).User AS User
            FROM read_reg_key(
               globs=url(scheme=&quot;ntfs&quot;,
                  path=FullPath,
                  fragment=RecentAppsKey).String,
               accessor=&quot;raw_reg&quot;)
         })

      - LET A1 = SELECT * FROM if(
          condition=UserFilter,
          then={
            SELECT * FROM TMP WHERE User =~ UserFilter
          }, else=TMP)

      - SELECT * FROM if(
          condition=ExecutionTimeAfter,
          then={
            SELECT * FROM A1 WHERE LastExecutionTS &gt; ExecutionTimeAfter
          }, else=A1)
</code></pre>

    </div>
</div>


<h2 id="windows-forensics-timeline">Windows.Forensics.Timeline</h2>

<p>Win10 records recently used applications and files in a “timeline”
accessible via the “WIN+TAB” key. The data is recorded in a SQLite
database.</p>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>UserFilter</td>
<td></td>
<td>If specified we filter by this user ID.</td>
</tr>

<tr>
<td>ExecutionTimeAfter</td>
<td></td>
<td>If specified only show executions after this time.</td>
</tr>

<tr>
<td>Win10TimelineGlob</td>
<td>C:\Users\<em>\AppData\Local\ConnectedDevicesPlatform\L.</em>\ActivitiesCache.db</td>
<td></td>
</tr>
</tbody>
</table>



<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fa fa-chevron-down' : 'fa fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fa fa-chevron-right"></i>
        <span>
        
        
        View Artifact Source
        
        </span>
    </div>
    <div class="expand-content" style="display: none;">
<pre><code>name: Windows.Forensics.Timeline
description: |
  Win10 records recently used applications and files in a “timeline”
  accessible via the “WIN+TAB” key. The data is recorded in a SQLite
  database.

parameters:
  - name: UserFilter
    default: &quot;&quot;
    description: If specified we filter by this user ID.

  - name: ExecutionTimeAfter
    default: &quot;&quot;
    type: timestamp
    description: If specified only show executions after this time.

  - name: Win10TimelineGlob
    default: C:\Users\*\AppData\Local\ConnectedDevicesPlatform\L.*\ActivitiesCache.db

precondition: SELECT OS From info() where OS = 'windows'

sources:
  - queries:
      - LET timeline = SELECT * FROM foreach(
         row={
            SELECT FullPath FROM glob(globs=Win10TimelineGlob)
         },
         query={
            SELECT AppId, FullPath, LastModifiedTime
            FROM sqlite(file=FullPath, query=&quot;SELECT * FROM Activity&quot;)
         })
      - LET TMP = SELECT get(
               item=parse_json_array(data=AppId).application,
               member=&quot;0&quot;) AS Application,
             parse_string_with_regex(
               string=FullPath,
               regex=&quot;\\\\L.(?P&lt;User&gt;[^\\\\]+)\\\\&quot;).User AS User,
               LastModifiedTime,
               LastModifiedTime.Unix as LastExecutionTS
        FROM timeline
      - LET A1 = SELECT * FROM if(
          condition=UserFilter,
          then={
            SELECT * FROM TMP WHERE User =~ UserFilter
          }, else=TMP)
      - SELECT * FROM if(
          condition=ExecutionTimeAfter,
          then={
            SELECT * FROM A1 WHERE LastExecutionTS &gt; ExecutionTimeAfter
          }, else=A1)
</code></pre>

    </div>
</div>



    
    
          <footer class=" footline" >
	
</footer>
  </div>
</div>

<div id="navigation">
<a class="nav nav-prev" href="/docs/artifacts/server/" title="Server Artifacts"> <i class="fa fa-chevron-left"></i><label>Server Artifacts</label></a>
    <a class="nav nav-next" href="/docs/artifacts/detection/" title="Windows Malware Detection" style="margin-right: 0px;"><label>Windows Malware Detection</label><i class="fa fa-chevron-right"></i></a></div>

</section>
<div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
  <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
</div>    

<script src="/js/clipboard.min.js"></script>
<script src="/js/featherlight.min.js"></script>
<script src="/js/html5shiv-printshiv.min.js"></script>

<script src="/js/modernizr.custom.71422.js"></script>
<script src="/js/docdock.js"></script>
<script src="/theme-original/script.js"></script>


    

    
    

    
  </body>
</html>