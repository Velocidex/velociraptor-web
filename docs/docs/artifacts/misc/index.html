<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.56.0-DEV" />
    <meta name="description" content="Various Artifacts which do not fit into other categories.">


    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>Miscelaneous Artifacts :: Velociraptor - Hunt Evil!</title>

    
    <link href="/css/nucleus.css?1560531008" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1560531008" rel="stylesheet">
    <link href="/css/hybrid.css?1560531008" rel="stylesheet">
    <link href="/css/featherlight.min.css?1560531008" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1560531008" rel="stylesheet">
    <link href="/css/auto-complete.css?1560531008" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1560531008" rel="stylesheet">
    <link href="/css/theme.css?1560531008" rel="stylesheet">
    <link href="/css/hugo-theme.css?1560531008" rel="stylesheet">
    
      <link href="/css/theme-mine.css?1560531008" rel="stylesheet">
    

    <script src="/js/jquery-3.3.1.min.js?1560531008"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/docs/artifacts/misc/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a href="/">
  <img src="/images/logo.svg" />
</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1560531008"></script>
<script type="text/javascript" src="/js/auto-complete.js?1560531008"></script>
<script type="text/javascript">
    
        var baseurl = "\/";
    
</script>
<script type="text/javascript" src="/js/search.js?1560531008"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/about/" title="About Velociraptor" class="dd-item 
        
        
        
        ">
      <a href="/about/">
          Overview
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/about/features/" title="Velociraptor Features" class="dd-item ">
        <a href="/about/features/">
        Velociraptor Features
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/about/license/" title="GNU Affero General Public License" class="dd-item ">
        <a href="/about/license/">
        License
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/docs/" title="Velociraptor Documentation" class="dd-item 
        parent
        
        
        ">
      <a href="/docs/">
          Velociraptor Documentation
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/docs/getting-started/" title="Getting Started" class="dd-item 
        
        
        
        ">
      <a href="/docs/getting-started/">
          Getting Started
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/docs/getting-started/stand_alone/" title="Standalone Deployment" class="dd-item ">
        <a href="/docs/getting-started/stand_alone/">
        Standalone Deployment
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/getting-started/deploying_clients/" title="Deploying Clients" class="dd-item ">
        <a href="/docs/getting-started/deploying_clients/">
        Deploying Clients
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/getting-started/cloud/" title="Deploying in the cloud" class="dd-item ">
        <a href="/docs/getting-started/cloud/">
        Cloud Deployment
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/getting-started/triaging/" title="Triaging" class="dd-item ">
        <a href="/docs/getting-started/triaging/">
        Triaging
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/docs/user-interface/" title="User Interface" class="dd-item 
        
        
        
        ">
      <a href="/docs/user-interface/">
          User Interface
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/docs/user-interface/flows/" title="Velociraptor Artifacts" class="dd-item ">
        <a href="/docs/user-interface/flows/">
        Velociraptor Artifacts
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/user-interface/gui/" title="Searching for clients" class="dd-item ">
        <a href="/docs/user-interface/gui/">
        Searching for clients
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/docs/use_cases/" title="Use Cases" class="dd-item 
        
        
        
        ">
      <a href="/docs/use_cases/">
          Use Cases
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/docs/presentations/" title="Presentations and Workshops" class="dd-item 
        
        
        
        ">
      <a href="/docs/presentations/">
          Presentations and Workshops
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/docs/presentations/crikeycon2019/" title="Crikeycon 2019 Training Workshop" class="dd-item ">
        <a href="/docs/presentations/crikeycon2019/">
        CrikeyCon 2019
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/presentations/nzitf2018/" title="New Zealand Internet Task Force Conference 2018" class="dd-item ">
        <a href="/docs/presentations/nzitf2018/">
        NZITF2018
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/tutorial/" title="Tutorial" class="dd-item ">
        <a href="/docs/tutorial/">
        Tutorial
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/docs/vql_reference/" title="VQL Reference" class="dd-item 
        
        
        
        ">
      <a href="/docs/vql_reference/">
          VQL Reference
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/docs/vql_reference/templates/" title="Report Templates" class="dd-item ">
        <a href="/docs/vql_reference/templates/">
        Report Templates
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/vql_reference/event_plugins/" title="VQL Event PLugins" class="dd-item ">
        <a href="/docs/vql_reference/event_plugins/">
        VQL Event PLugins
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/vql_reference/functions/" title="VQL Functions" class="dd-item ">
        <a href="/docs/vql_reference/functions/">
        VQL Functions
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/vql_reference/plugins/" title="VQL PLugins" class="dd-item ">
        <a href="/docs/vql_reference/plugins/">
        VQL PLugins
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/vql_reference/server/" title="VQL Server Plugins" class="dd-item ">
        <a href="/docs/vql_reference/server/">
        VQL Server Plugins
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/docs/artifacts/" title="Artifact Reference" class="dd-item 
        parent
        
        
        ">
      <a href="/docs/artifacts/">
          Artifact Reference
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/docs/artifacts/linux/linux/" title="Linux Artifacts" class="dd-item ">
        <a href="/docs/artifacts/linux/linux/">
        Linux Artifacts
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/artifacts/misc/" title="Miscelaneous Artifacts" class="dd-item active">
        <a href="/docs/artifacts/misc/">
        Miscelaneous
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/artifacts/server/" title="Server Artifacts" class="dd-item ">
        <a href="/docs/artifacts/server/">
        Server Artifacts
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/artifacts/detection/" title="Windows Malware Detection" class="dd-item ">
        <a href="/docs/artifacts/detection/">
        Windows Detection
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/artifacts/events/" title="Windows Event Monitoring" class="dd-item ">
        <a href="/docs/artifacts/events/">
        Windows Monitoring
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/artifacts/windows_system/" title="Windows System" class="dd-item ">
        <a href="/docs/artifacts/windows_system/">
        Windows System
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/artifacts/triage/" title="Windows Triage Artifacts" class="dd-item ">
        <a href="/docs/artifacts/triage/">
        Windows Triage
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/blog/" title="Velociraptor Blog" class="dd-item 
        
        
        
        ">
      <a href="/blog/">
          Velociraptor Blog
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2019/03/02/agentless_hunting_with_velociraptor.html" title="Agentless hunting with Velociraptor" class="dd-item ">
        <a href="/blog/html/2019/03/02/agentless_hunting_with_velociraptor.html">
        Agentless hunting with Velociraptor
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2019/02/14/alerting_on_event_patterns.html" title="Alerting on event patterns" class="dd-item ">
        <a href="/blog/html/2019/02/14/alerting_on_event_patterns.html">
        Alerting on event patterns
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2019/02/10/velociraptor_performance.html" title="Velociraptor Performance" class="dd-item ">
        <a href="/blog/html/2019/02/10/velociraptor_performance.html">
        Velociraptor Performance
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2019/02/09/velociraptor_python_api.html" title="The Velociraptor Python API" class="dd-item ">
        <a href="/blog/html/2019/02/09/velociraptor_python_api.html">
        The Velociraptor Python API
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/09/03/velociraptor_s_client_communications.html" title="Velociraptor&#39;s client communications" class="dd-item ">
        <a href="/blog/html/2018/09/03/velociraptor_s_client_communications.html">
        Velociraptor&#39;s client communications
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/12/23/deploying_velociraptor_with_oauth_sso.html" title="Deploying Velociraptor with OAuth SSO" class="dd-item ">
        <a href="/blog/html/2018/12/23/deploying_velociraptor_with_oauth_sso.html">
        Deploying Velociraptor with OAuth SSO
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/12/22/configuring_velociraptor_for_ssl.html" title="Configuring Velociraptor for SSL" class="dd-item ">
        <a href="/blog/html/2018/12/22/configuring_velociraptor_for_ssl.html">
        Configuring Velociraptor for SSL
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/12/11/velociraptor_interactive_shell.html" title="Velociraptor Interactive Shell" class="dd-item ">
        <a href="/blog/html/2018/12/11/velociraptor_interactive_shell.html">
        Velociraptor Interactive Shell
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/12/10/server_side_vql_queries_and_events.html" title="Server side VQL queries and Escalation Events" class="dd-item ">
        <a href="/blog/html/2018/12/10/server_side_vql_queries_and_events.html">
        Server side VQL queries and Escalation Events
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/12/09/more_on_client_event_collection.html" title="More on client event collection" class="dd-item ">
        <a href="/blog/html/2018/12/09/more_on_client_event_collection.html">
        More on client event collection
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/11/13/velociraptor_training_at_nzitf.html" title="Velociraptor training at NZITF" class="dd-item ">
        <a href="/blog/html/2018/11/13/velociraptor_training_at_nzitf.html">
        Velociraptor training at NZITF
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/11/09/event_queries_and_endpoint_monitoring.html" title="Event Queries and Endpoint Monitoring" class="dd-item ">
        <a href="/blog/html/2018/11/09/event_queries_and_endpoint_monitoring.html">
        Event Queries and Endpoint Monitoring
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/09/30/velorciraptor_s_filesystem_s_accessors.html" title="Velorciraptor&#39;s filesystem&#39;s accessors" class="dd-item ">
        <a href="/blog/html/2018/09/30/velorciraptor_s_filesystem_s_accessors.html">
        Velorciraptor&#39;s filesystem&#39;s accessors
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/09/29/detecting_powershell_persistence_with_velociraptor_and_yara.html" title="Detecting powershell persistence with Velociraptor and Yara" class="dd-item ">
        <a href="/blog/html/2018/09/29/detecting_powershell_persistence_with_velociraptor_and_yara.html">
        Detecting powershell persistence with Velociraptor and Yara
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/09/03/velociraptor_walk_through_and_demo.html" title="Velociraptor walk through and demo" class="dd-item ">
        <a href="/blog/html/2018/09/03/velociraptor_walk_through_and_demo.html">
        Velociraptor walk through and demo
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/08/20/velociraptor_artifacts.html" title="Velociraptor Artifacts" class="dd-item ">
        <a href="/blog/html/2018/08/20/velociraptor_artifacts.html">
        Velociraptor Artifacts
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/08/10/browsing_around_the_filesystem.html" title="Browsing around the filesystem." class="dd-item ">
        <a href="/blog/html/2018/08/10/browsing_around_the_filesystem.html">
        Browsing around the filesystem.
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/08/10/design_differences_between_velociraptor_and_grr.html" title="Design differences between Velociraptor and GRR" class="dd-item ">
        <a href="/blog/html/2018/08/10/design_differences_between_velociraptor_and_grr.html">
        Design differences between Velociraptor and GRR
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/02/09/files_files_everything_is_just_a_file.html" title="Files, files everything is just a file!" class="dd-item ">
        <a href="/blog/html/2018/02/09/files_files_everything_is_just_a_file.html">
        Files, files everything is just a file!
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/08/10/hunting_what_velociraptors_do_best.html" title="Hunting - What Velociraptors do best!" class="dd-item ">
        <a href="/blog/html/2018/08/10/hunting_what_velociraptors_do_best.html">
        Hunting - What Velociraptors do best!
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/08/10/interrogation_make_the_endpoint_tell_us_what_it_knows.html" title="Interrogation - Make the endpoint tell us what it knows!" class="dd-item ">
        <a href="/blog/html/2018/08/10/interrogation_make_the_endpoint_tell_us_what_it_knows.html">
        Interrogation - Make the endpoint tell us what it knows!
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/08/10/the_velocidex_query_language.html" title="Velocidex Query Language (VQL)" class="dd-item ">
        <a href="/blog/html/2018/08/10/the_velocidex_query_language.html">
        Velocidex Query Language (VQL)
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/08/10/introducing_velociraptor.html" title="Introducing Velociraptor" class="dd-item ">
        <a href="/blog/html/2018/08/10/introducing_velociraptor.html">
        Introducing Velociraptor
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    

    
    <section id="footer">
      
    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            
            
          
          
            <a href='/'>Velociraptor - Hunt Evil!</a> > <a href='/docs/'>Velociraptor Documentation</a> > <a href='/docs/artifacts/'>Artifact Reference</a> > Miscelaneous Artifacts
          
         
          
         
          
         
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#admin-client-upgrade">Admin.Client.Upgrade</a></li>
<li><a href="#admin-events-postprocessuploads">Admin.Events.PostProcessUploads</a></li>
<li><a href="#admin-system-compressuploads">Admin.System.CompressUploads</a></li>
<li><a href="#demo-plugins-fifo">Demo.Plugins.Fifo</a></li>
<li><a href="#generic-applications-office-keywords">Generic.Applications.Office.Keywords</a></li>
<li><a href="#generic-client-stats">Generic.Client.Stats</a></li>
<li><a href="#generic-forensic-carving-urls">Generic.Forensic.Carving.URLs</a></li>
<li><a href="#generic-forensic-timeline">Generic.Forensic.Timeline</a></li>
<li><a href="#network-externalipaddress">Network.ExternalIpAddress</a></li>
<li><a href="#reporting-hunts-details">Reporting.Hunts.Details</a></li>
<li><a href="#system-hunt-participation">System.Hunt.Participation</a></li>
<li><a href="#windows-applications-chocolateypackages">Windows.Applications.ChocolateyPackages</a></li>
<li><a href="#windows-applications-chrome-extensions">Windows.Applications.Chrome.Extensions</a></li>
<li><a href="#windows-applications-officemacros">Windows.Applications.OfficeMacros</a></li>
<li><a href="#windows-eventlogs-dhcp">Windows.EventLogs.DHCP</a></li>
<li><a href="#windows-network-arpcache">Windows.Network.ArpCache</a></li>
<li><a href="#windows-network-interfaceaddresses">Windows.Network.InterfaceAddresses</a></li>
<li><a href="#windows-network-listeningports">Windows.Network.ListeningPorts</a></li>
<li><a href="#windows-network-netstat">Windows.Network.Netstat</a></li>
<li><a href="#windows-packs-autoexec">Windows.Packs.Autoexec</a></li>
<li><a href="#windows-packs-persistence">Windows.Packs.Persistence</a></li>
<li><a href="#windows-registry-ntuser">Windows.Registry.NTUser</a></li>
<li><a href="#windows-registry-ntuser-upload">Windows.Registry.NTUser.Upload</a></li>
<li><a href="#windows-registry-sysinternals-eulacheck">Windows.Registry.Sysinternals.Eulacheck</a></li>
<li><a href="#windows-search-filefinder">Windows.Search.FileFinder</a></li>
<li><a href="#performance-note">Performance Note</a></li>
</ul></li>
</ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Miscelaneous Artifacts
            </h1>
          

        





<h2 id="admin-client-upgrade">Admin.Client.Upgrade</h2>

<p>Remotely push new client updates.</p>

<p>NOTE: The updates can be pulled from any web server. You need to
ensure they are properly secured with SSL and at least a random
nonce in their path. You may configure the Velociraptor server to
serve these through the public directory.</p>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>clientURL</td>
<td><a href="http://127.0.0.1:8000/public/velociraptor.exe">http://127.0.0.1:8000/public/velociraptor.exe</a></td>
<td></td>
</tr>

<tr>
<td>configURL</td>
<td><a href="http://127.0.0.1:8000/public/client.config.yaml">http://127.0.0.1:8000/public/client.config.yaml</a></td>
<td></td>
</tr>
</tbody>
</table>


<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fas fa-chevron-down' : 'fas fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fas fa-chevron-right"></i>
        <span>
        
    	
    	View Artifact Source
    	
    	</span>
    </div>
    <div class="expand-content" style="display: none;">
        <pre><code>name: Admin.Client.Upgrade
description: |
  Remotely push new client updates.

  NOTE: The updates can be pulled from any web server. You need to
  ensure they are properly secured with SSL and at least a random
  nonce in their path. You may configure the Velociraptor server to
  serve these through the public directory.

parameters:
  - name: clientURL
    default: http://127.0.0.1:8000/public/velociraptor.exe
  - name: configURL
    default: http://127.0.0.1:8000/public/client.config.yaml

sources:
  - precondition:
      SELECT OS From info() where OS = 'windows'
    queries:
      - |
        /* This query fetches the binary and config and stores them in
         temp files. Note that tempfiles will be automatically
         cleaned at query end.
         */
        LET tmpfiles &lt;= SELECT tempfile(
           data=query(vql={
             SELECT Content
             FROM http_client(url=clientURL, chunk_size=30000000)
           }),
           extension=&quot;.exe&quot;) as Binary,
        tempfile(
           data=query(vql={
             SELECT Content
             FROM http_client(url=configURL)
           })) as Config from scope()

      - |
        // Run the installer.
        SELECT * from foreach(
         row=tmpfiles,
         query={
            SELECT * from execve(
               argv=[Binary, &quot;--config&quot;, Config, &quot;-v&quot;, &quot;service&quot;, &quot;install&quot;]
            )
         })
</code></pre>

    </div>
</div>

<h2 id="admin-events-postprocessuploads">Admin.Events.PostProcessUploads</h2>

<p>Sometimes we would like to post process uploads collected as part of
the hunt&rsquo;s artifact collections</p>

<p>Post processing means to watch the hunt for completed flows and run
a post processing command on the files obtained from each host.</p>

<p>The command will receive the list of paths of the files uploaded by
the artifact. We dont actually care what the command does with those
files - we will just relay our stdout/stderr to the artifact&rsquo;s
result set.</p>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>uploadPostProcessCommand</td>
<td>[&ldquo;/bin/ls&rdquo;, &ldquo;-l&rdquo;]\n</td>
<td>The command to run - must be a json array of strings! The list\nof files will be appended to the end of the command.\n</td>
</tr>

<tr>
<td>uploadPostProcessArtifact</td>
<td>Windows.Registry.NTUser.Upload</td>
<td>The name of the artifact to watch.\n</td>
</tr>
</tbody>
</table>


<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fas fa-chevron-down' : 'fas fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fas fa-chevron-right"></i>
        <span>
        
    	
    	View Artifact Source
    	
    	</span>
    </div>
    <div class="expand-content" style="display: none;">
        <pre><code>name: Admin.Events.PostProcessUploads
description: |
  Sometimes we would like to post process uploads collected as part of
  the hunt's artifact collections

  Post processing means to watch the hunt for completed flows and run
  a post processing command on the files obtained from each host.

  The command will receive the list of paths of the files uploaded by
  the artifact. We dont actually care what the command does with those
  files - we will just relay our stdout/stderr to the artifact's
  result set.

type: SERVER_EVENT

parameters:
  - name: uploadPostProcessCommand
    description: |
      The command to run - must be a json array of strings! The list
      of files will be appended to the end of the command.
    default: |
      [&quot;/bin/ls&quot;, &quot;-l&quot;]

  - name: uploadPostProcessArtifact
    description: |
      The name of the artifact to watch.
    default: Windows.Registry.NTUser.Upload

sources:
  - precondition:
      SELECT server_config FROM scope()
    queries:
      - |
        LET files = SELECT Flow,
            array(a1=parse_json_array(data=uploadPostProcessCommand),
                  a2=file_store(path=Flow.FlowContext.uploaded_files)) as Argv
        FROM watch_monitoring(artifact='System.Flow.Completion')
        WHERE uploadPostProcessArtifact in Flow.FlowContext.artifacts

      - |
        SELECT * from foreach(
          row=files,
          query={
             SELECT Flow.Urn as FlowUrn, Argv,
                    Stdout, Stderr, ReturnCode
             FROM execve(argv=Argv)
          })
</code></pre>

    </div>
</div>

<h2 id="admin-system-compressuploads">Admin.System.CompressUploads</h2>

<p>Compresses all uploaded files.</p>

<p>When artifacts collect files they are normally stored on the server
uncompressed. This artifact watches all completed flows and
compresses the files in the file store when the flow completes. This
is very useful for cloud based deployments with limited storage
space or when collecting large files.</p>

<p>In order to run this artifact you would normally run it as part of
an artifact acquisition process:</p>

<pre><code>$ velociraptor --config /etc/server.config.yaml artifacts acquire Admin.System.CompressUploads
</code></pre>

<p>Note that there is nothing special about compressed files - you can
also just run <code>find</code> and <code>gzip</code> in the file store. Velociraptor will
automatically decompress the file when displaying it in the GUI
text/hexdump etc.</p>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>blacklistCompressionFilename</td>
<td>(?i).+ntuser.dat</td>
<td>Filenames which match this regex will be excluded from compression.</td>
</tr>
</tbody>
</table>


<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fas fa-chevron-down' : 'fas fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fas fa-chevron-right"></i>
        <span>
        
    	
    	View Artifact Source
    	
    	</span>
    </div>
    <div class="expand-content" style="display: none;">
        <pre><code>name: Admin.System.CompressUploads
description: |
  Compresses all uploaded files.

  When artifacts collect files they are normally stored on the server
  uncompressed. This artifact watches all completed flows and
  compresses the files in the file store when the flow completes. This
  is very useful for cloud based deployments with limited storage
  space or when collecting large files.

  In order to run this artifact you would normally run it as part of
  an artifact acquisition process:

</code></pre>

<p>$ velociraptor &ndash;config /etc/server.config.yaml artifacts acquire Admin.System.CompressUploads</p>

<pre><code>
  Note that there is nothing special about compressed files - you can
  also just run `find` and `gzip` in the file store. Velociraptor will
  automatically decompress the file when displaying it in the GUI
  text/hexdump etc.

type: SERVER_EVENT

parameters:
  - name: blacklistCompressionFilename
    description: Filenames which match this regex will be excluded from compression.
    default: '(?i).+ntuser.dat'

sources:
  - precondition:
      SELECT server_config FROM scope()
    queries:
      - |
        LET files = SELECT ClientId,
            Flow.Urn as Flow,
            Flow.FlowContext.uploaded_files as Files
        FROM watch_monitoring(artifact='System.Flow.Completion')
        WHERE Files and not Files =~ blacklistCompressionFilename

      - |
        SELECT ClientId, Flow, Files,
               compress(path=Files) as CompressedFiles
        FROM files
</code></pre>

    </div>
</div>

<h2 id="demo-plugins-fifo">Demo.Plugins.Fifo</h2>

<p>This is a demo of the fifo() plugin. The Fifo plugin collects and
caches rows from its inner query. Every subsequent execution of the
query then reads from the cache. The plugin will expire old rows
depending on its expiration policy - so we always see recent rows.</p>

<p>You can use this to build queries which consider historical events
together with current events at the same time. In this example, we
check for a successful logon preceeded by a number of failed logon
attempts.</p>

<p>In this example, we use the clock() plugin to simulate events. We
simulate failed logon attempts using the clock() plugin every
second. By feeding the failed logon events to the fifo() plugin we
ensure the fifo() plugin cache contains the last 5 failed logon
events.</p>

<p>We simulate a successful logon event every 3 seconds, again using
the clock plugin. Once a successful logon event is detected, we go
back over the last 5 login events, count them and collect the last
failed logon times (using the GROUP BY operator we group the
FailedTime for every unique SuccessTime).</p>

<p>If we receive more than 3 events, we emit the row.</p>

<p>This now represents a high value signal! It will only occur when a
successful logon event is preceeded by at least 3 failed logon
events in the last hour. It is now possible to escalate this on the
server via email or other alerts.</p>

<p>Here is sample output:</p>

<p>.. code-block:: json</p>

<pre><code>{
  &quot;Count&quot;: 5,
  &quot;FailedTime&quot;: [
    1549527272,
    1549527273,
    1549527274,
    1549527275,
    1549527276
  ],
  &quot;SuccessTime&quot;: 1549527277
}
</code></pre>

<p>Of course in the real artifact we would want to include more
information than just times (i.e. who logged on to where etc).</p>


<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fas fa-chevron-down' : 'fas fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fas fa-chevron-right"></i>
        <span>
        
    	
    	View Artifact Source
    	
    	</span>
    </div>
    <div class="expand-content" style="display: none;">
        <pre><code>name: Demo.Plugins.Fifo
description: |
  This is a demo of the fifo() plugin. The Fifo plugin collects and
  caches rows from its inner query. Every subsequent execution of the
  query then reads from the cache. The plugin will expire old rows
  depending on its expiration policy - so we always see recent rows.

  You can use this to build queries which consider historical events
  together with current events at the same time. In this example, we
  check for a successful logon preceeded by a number of failed logon
  attempts.

  In this example, we use the clock() plugin to simulate events. We
  simulate failed logon attempts using the clock() plugin every
  second. By feeding the failed logon events to the fifo() plugin we
  ensure the fifo() plugin cache contains the last 5 failed logon
  events.

  We simulate a successful logon event every 3 seconds, again using
  the clock plugin. Once a successful logon event is detected, we go
  back over the last 5 login events, count them and collect the last
  failed logon times (using the GROUP BY operator we group the
  FailedTime for every unique SuccessTime).

  If we receive more than 3 events, we emit the row.

  This now represents a high value signal! It will only occur when a
  successful logon event is preceeded by at least 3 failed logon
  events in the last hour. It is now possible to escalate this on the
  server via email or other alerts.

  Here is sample output:

  .. code-block:: json

      {
        &quot;Count&quot;: 5,
        &quot;FailedTime&quot;: [
          1549527272,
          1549527273,
          1549527274,
          1549527275,
          1549527276
        ],
        &quot;SuccessTime&quot;: 1549527277
      }

  Of course in the real artifact we would want to include more
  information than just times (i.e. who logged on to where etc).
type: CLIENT_EVENT

sources:
  - queries:
      # This query simulates failed logon attempts.
      - |
        LET failed_logon = SELECT Unix as FailedTime from clock(period=1)

      # This is the fifo which holds the last 5 failed logon attempts
      # within the last hour.
      - |
        LET last_5_events = SELECT FailedTime
            FROM fifo(query=failed_logon, max_rows=5, max_age=3600)

      # We need to get it started collecting data immediately by
      # materializing the cache contents. Otherwise the fifo wont
      # start until it is first called (i.e. the first successful
      # login and we will miss the failed events before hand).
      - |
        LET foo &lt;= SELECT * FROM last_5_events

      # This simulates successful logon - we assume every 3 seonds.
      - |
        LET success_logon = SELECT Unix as SuccessTime from clock(period=3)

      # For each successful logon, query the last failed logon
      # attempts from the fifo(). We also count the total number of
      # failed logons. We only actually emit results if there are more
      # than 3 failed logon attempts before each successful one.
      - |
        SELECT * FROM foreach(
          row=success_logon,
          query={
           SELECT SuccessTime,
              enumerate(items=FailedTime) as FailedTime,
              count(items=FailedTime) as Count
           FROM last_5_events GROUP BY SuccessTime
          }) WHERE Count &gt; 3
</code></pre>

    </div>
</div>

<h2 id="generic-applications-office-keywords">Generic.Applications.Office.Keywords</h2>

<p>Microsoft Office documents among other document format (such as
LibraOffice) are actually stored in zip files. The zip file contain
the document encoded as XML in a number of zip members.</p>

<p>This makes it difficult to search for keywords within office
documents because the ZIP files are typically compressed.</p>

<p>This artifact searches for office documents by file extension and
glob then uses the zip filesystem accessor to launch a yara scan
again the uncompressed data of the document. Keywords are more
likely to match when scanning the decompressed XML data.</p>

<p>The artifact returns a context around the keyword hit.</p>

<p>NOTE: The InternalMtime column shows the creation time of the zip
member within the document which may represent when the document was
initially created.</p>

<p>See
<a href="https://en.wikipedia.org/wiki/List_of_Microsoft_Office_filename_extensions">https://en.wikipedia.org/wiki/List_of_Microsoft_Office_filename_extensions</a>
<a href="https://wiki.openoffice.org/wiki/Documentation/OOo3_User_Guides/Getting_Started/File_formats">https://wiki.openoffice.org/wiki/Documentation/OOo3_User_Guides/Getting_Started/File_formats</a></p>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>documentGlobs</td>
<td>/*.{docx,docm,dotx,dotm,docb,xlsx,xlsm,xltx,xltm,pptx,pptm,potx,potm,ppam,ppsx,ppsm,sldx,sldm,odt,ott,oth,odm}</td>
<td></td>
</tr>

<tr>
<td>searchGlob</td>
<td>C:\Users\**</td>
<td></td>
</tr>

<tr>
<td>yaraRule</td>
<td>rule Hit {\n  strings:\n    $a = &ldquo;secret&rdquo; wide nocase\n    $b = &ldquo;secret&rdquo; nocase\n\n  condition:\n    any of them\n}\n</td>
<td></td>
</tr>
</tbody>
</table>


<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fas fa-chevron-down' : 'fas fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fas fa-chevron-right"></i>
        <span>
        
    	
    	View Artifact Source
    	
    	</span>
    </div>
    <div class="expand-content" style="display: none;">
        <pre><code>name: Generic.Applications.Office.Keywords
description: |
  Microsoft Office documents among other document format (such as
  LibraOffice) are actually stored in zip files. The zip file contain
  the document encoded as XML in a number of zip members.

  This makes it difficult to search for keywords within office
  documents because the ZIP files are typically compressed.

  This artifact searches for office documents by file extension and
  glob then uses the zip filesystem accessor to launch a yara scan
  again the uncompressed data of the document. Keywords are more
  likely to match when scanning the decompressed XML data.

  The artifact returns a context around the keyword hit.

  NOTE: The InternalMtime column shows the creation time of the zip
  member within the document which may represent when the document was
  initially created.

  See
  https://en.wikipedia.org/wiki/List_of_Microsoft_Office_filename_extensions
  https://wiki.openoffice.org/wiki/Documentation/OOo3_User_Guides/Getting_Started/File_formats

parameters:
  - name: documentGlobs
    default: /*.{docx,docm,dotx,dotm,docb,xlsx,xlsm,xltx,xltm,pptx,pptm,potx,potm,ppam,ppsx,ppsm,sldx,sldm,odt,ott,oth,odm}
  - name: searchGlob
    default: C:\Users\**
  - name: yaraRule
    default: |
      rule Hit {
        strings:
          $a = &quot;secret&quot; wide nocase
          $b = &quot;secret&quot; nocase

        condition:
          any of them
      }

sources:
  - queries:
      - |
        LET office_docs = SELECT FullPath AS OfficePath,
             timestamp(epoch=Mtime.Sec) as OfficeMtime,
             Size as OfficeSize
          FROM glob(globs=searchGlob + documentGlobs)

      # A list of zip members inside the doc that have some content.
      - |
        LET document_parts = SELECT OfficePath,
             FullPath AS ZipMemberPath
          FROM glob(globs=url(
             scheme=&quot;file&quot;, path=OfficePath, fragment=&quot;/**&quot;).String,
             accessor='zip')
          WHERE not IsDir and Size &gt; 0

      # For each document, scan all its parts for the keyword.
      - |
        SELECT OfficePath,
               OfficeMtime,
               OfficeSize,
               File.ModTime as InternalMtime,
               Strings.HexData as HexContext
         FROM foreach(
           row=office_docs,
           query={
              SELECT File, Strings, OfficePath,
                     OfficeMtime, OfficeSize
              FROM yara(
                 rules=yaraRule,
                 files=document_parts.ZipMemberPath,
                 context=200,
                 accessor='zip')
         })
</code></pre>

    </div>
</div>

<h2 id="generic-client-stats">Generic.Client.Stats</h2>

<p>An Event artifact which generates client&rsquo;s CPU and memory statistics.</p>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>Frequency</td>
<td>10</td>
<td>Return stats every this many seconds.</td>
</tr>
</tbody>
</table>


<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fas fa-chevron-down' : 'fas fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fas fa-chevron-right"></i>
        <span>
        
    	
    	View Artifact Source
    	
    	</span>
    </div>
    <div class="expand-content" style="display: none;">
        <pre><code>name: Generic.Client.Stats
description: An Event artifact which generates client's CPU and memory statistics.
parameters:
  - name: Frequency
    description: Return stats every this many seconds.
    default: &quot;10&quot;
type: CLIENT_EVENT

sources:
  - queries:
      - |
        SELECT * from foreach(
         row={
           SELECT UnixNano FROM clock(period=atoi(string=Frequency))
         },
         query={
           SELECT UnixNano / 1000000000 as Timestamp,
                  Times.user + Times.system as CPU,
                  MemoryInfo.RSS as RSS
           FROM pslist(pid=getpid())
         })


reports:
  - type: SERVER_EVENT
    template: |
      {{ define &quot;resources&quot; }}
           SELECT Timestamp, rate(x=CPU, y=Timestamp) * 100 As CPUPercent,
                  RSS / 1000000 AS MemoryUse
           FROM source()
           WHERE CPUPercent &gt;= 0
      {{ end }}

      {{ Query &quot;resources&quot; | LineChart &quot;xaxis_mode&quot; &quot;time&quot; &quot;RSS.yaxis&quot; 2 }}

  - type: MONITORING_DAILY
    template: |
      {{ define &quot;resources&quot; }}
           SELECT Timestamp, rate(x=CPU, y=Timestamp) * 100 As CPUPercent,
                  RSS / 1000000 AS MemoryUse
           FROM source()
           WHERE CPUPercent &gt;= 0
      {{ end }}

      {{ $client_info := Query &quot;SELECT * FROM clients(client_id=ClientId) LIMIT 1&quot; }}

      # Client Footprint for {{ Get $client_info &quot;0.OsInfo.Fqdn&quot; }}

      The client has a client ID of {{ Get $client_info &quot;0.ClientId&quot; }}.
      Clients report the Velociraptor process footprint to the
      server every 10 seconds. The data includes the total CPU
      utilization, and the resident memory size used by the client.

      The following graph shows the total utilization. Memory
      utilization is meausred in `Mb` while CPU Utilization is
      measured by `Percent of one core`.

      We would expect the client to use around 1-5% of one core when
      idle, but if a heavy hunt is running this might climb
      substantially.

      {{ Query &quot;resources&quot; | LineChart &quot;xaxis_mode&quot; &quot;time&quot; &quot;RSS.yaxis&quot; 2 }}

      ## VQL Query

      The following VQL query was used to plot the graph above.

      ```sql
      {{ template &quot;resources&quot; }}
      ```

      &gt; To learn about managing end point performance with Velociraptor see
        the [blog post](https://docs.velociraptor.velocidex.com/blog/html/2019/02/10/velociraptor_performance.html).
</code></pre>

    </div>
</div>

<h2 id="generic-forensic-carving-urls">Generic.Forensic.Carving.URLs</h2>

<p>Carve URLs from files located in a glob. Note that we do not parse
any files - we simply carve anything that looks like a URL.</p>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>UrlGlob</td>
<td>[&ldquo;C:/Documents and Settings/*/Local Settings/Application Data/Google/Chrome/User Data/<strong>&rdquo;,\n &ldquo;C:/Users/*/AppData/Local/Google/Chrome/User Data/</strong>&rdquo;,\n &ldquo;C:/Documents and Settings/*/Local Settings/History/<strong>&rdquo;,\n &ldquo;C:/Documents and Settings/*/Local Settings/Temporary Internet Files/</strong>&rdquo;,\n &ldquo;C:/Users/*/AppData/Local/Microsoft/Windows/WebCache/<strong>&rdquo;,\n &ldquo;C:/Users/*/AppData/Local/Microsoft/Windows/INetCache/</strong>&rdquo;,\n &ldquo;C:/Users/*/AppData/Local/Microsoft/Windows/INetCookies/<strong>&rdquo;,\n &ldquo;C:/Users/*/AppData/Roaming/Mozilla/Firefox/Profiles/</strong>&rdquo;,\n &ldquo;C:/Documents and Settings/*/Application Data/Mozilla/Firefox/Profiles/**&rdquo;\n ]\n</td>
<td></td>
</tr>
</tbody>
</table>


<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fas fa-chevron-down' : 'fas fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fas fa-chevron-right"></i>
        <span>
        
    	
    	View Artifact Source
    	
    	</span>
    </div>
    <div class="expand-content" style="display: none;">
        <pre><code>name: Generic.Forensic.Carving.URLs
description: |
  Carve URLs from files located in a glob. Note that we do not parse
  any files - we simply carve anything that looks like a URL.


parameters:
  - name: UrlGlob
    default: |
      [&quot;C:/Documents and Settings/*/Local Settings/Application Data/Google/Chrome/User Data/**&quot;,
       &quot;C:/Users/*/AppData/Local/Google/Chrome/User Data/**&quot;,
       &quot;C:/Documents and Settings/*/Local Settings/History/**&quot;,
       &quot;C:/Documents and Settings/*/Local Settings/Temporary Internet Files/**&quot;,
       &quot;C:/Users/*/AppData/Local/Microsoft/Windows/WebCache/**&quot;,
       &quot;C:/Users/*/AppData/Local/Microsoft/Windows/INetCache/**&quot;,
       &quot;C:/Users/*/AppData/Local/Microsoft/Windows/INetCookies/**&quot;,
       &quot;C:/Users/*/AppData/Roaming/Mozilla/Firefox/Profiles/**&quot;,
       &quot;C:/Documents and Settings/*/Application Data/Mozilla/Firefox/Profiles/**&quot;
       ]

sources:
  - queries:
      - |
        LET matching = SELECT FullPath FROM glob(
            globs=parse_json_array(data=UrlGlob))
      - |
        SELECT FullPath, URL FROM foreach(
          row=matching,
          query={
            SELECT FullPath,
                   URL FROM parse_records_with_regex(file=FullPath,
               regex=&quot;(?P&lt;URL&gt;https?:\\/\\/[\\w\\.-]+[\\/\\w \\.-]*)&quot;)
          })
</code></pre>

    </div>
</div>

<h2 id="generic-forensic-timeline">Generic.Forensic.Timeline</h2>

<p>This artifact generates a timeline of a file glob in bodyfile
format. We currently do not calculate the md5 because it is quite
expensive.</p>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>timelineGlob</td>
<td>C:\Users\**</td>
<td></td>
</tr>

<tr>
<td>timelineAccessor</td>
<td>file</td>
<td></td>
</tr>
</tbody>
</table>


<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fas fa-chevron-down' : 'fas fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fas fa-chevron-right"></i>
        <span>
        
    	
    	View Artifact Source
    	
    	</span>
    </div>
    <div class="expand-content" style="display: none;">
        <pre><code>name: Generic.Forensic.Timeline
description: |
  This artifact generates a timeline of a file glob in bodyfile
  format. We currently do not calculate the md5 because it is quite
  expensive.

parameters:
  - name: timelineGlob
    default: C:\Users\**
  - name: timelineAccessor
    default: file

sources:
  # For NTFS accessors we write the MFT id as the inode. On windows
  # the file accessor does not give the inode at all.
  - precondition:
      SELECT OS From info() where OS = 'windows' AND timelineAccessor = 'ntfs'
    queries:
      - |
        SELECT 0 AS Md5, FullPath,
               Sys.mft as Inode,
               Mode.String AS Mode, 0 as Uid, 0 as Gid, Size,
               Atime.Sec AS Atime, Mtime.Sec AS Mtime, Ctime.Sec AS Ctime
        FROM glob(globs=timelineGlob, accessor=timelineAccessor)

  # For linux we can get the Inode from Sys.Ino
  - precondition:
      SELECT * From scope() where timelineAccessor = 'file'
    queries:
      - |
        SELECT 0 AS Md5, FullPath,
               Sys.Ino as Inode,
               Mode.String AS Mode, Sys.Uid AS Uid, Sys.Gid AS Gid, Size,
               Atime.Sec AS Atime, Mtime.Sec AS Mtime, Ctime.Sec AS Ctime
        FROM glob(globs=timelineGlob, accessor=timelineAccessor)
</code></pre>

    </div>
</div>

<h2 id="network-externalipaddress">Network.ExternalIpAddress</h2>

<p>Detect the external ip address of the end point.</p>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>externalUrl</td>
<td><a href="http://www.myexternalip.com/raw">http://www.myexternalip.com/raw</a></td>
<td>The URL of the external IP detection site.</td>
</tr>
</tbody>
</table>


<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fas fa-chevron-down' : 'fas fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fas fa-chevron-right"></i>
        <span>
        
    	
    	View Artifact Source
    	
    	</span>
    </div>
    <div class="expand-content" style="display: none;">
        <pre><code>name: Network.ExternalIpAddress
description: Detect the external ip address of the end point.
parameters:
  - name: externalUrl
    default: http://www.myexternalip.com/raw
    description: The URL of the external IP detection site.
sources:
  - precondition: SELECT * from info()
    queries:
      - |
        SELECT Content as IP from http_client(url=externalUrl)
</code></pre>

    </div>
</div>

<h2 id="reporting-hunts-details">Reporting.Hunts.Details</h2>

<p>Report details about which client ran each hunt, how long it took
and if it has completed.</p>


<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fas fa-chevron-down' : 'fas fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fas fa-chevron-right"></i>
        <span>
        
    	
    	View Artifact Source
    	
    	</span>
    </div>
    <div class="expand-content" style="display: none;">
        <pre><code>name: Reporting.Hunts.Details
description: |
  Report details about which client ran each hunt, how long it took
  and if it has completed.

sources:
  - precondition:
      SELECT server_config FROM scope()

    queries:
      - |
        LET hunts = SELECT basename(path=hunt_id) as hunt_id,
            create_time,
            hunt_description
        FROM hunts() order by create_time desc limit 6
      - |
        LET flows = select hunt_id,
          hunt_description,
          Fqdn,
          ClientId,
          { SELECT os_info.system FROM clients(search=ClientId) } as OS,
          timestamp(epoch=Flow.FlowContext.create_time/1000000) as create_time,
          basename(path=Flow.Urn) as flow_id,
          (Flow.FlowContext.active_time - Flow.FlowContext.create_time) / 1000000 as Duration,
          format(format='%v', args=[Flow.FlowContext.state]) as State
        FROM hunt_flows(hunt_id=hunt_id) order by create_time desc
      - |
        SELECT * from foreach(row=hunts, query=flows)
</code></pre>

    </div>
</div>

<h2 id="system-hunt-participation">System.Hunt.Participation</h2>

<p>Endpoints may participate in hunts. This artifact collects which hunt
each system participated in.</p>

<p>Note: This is an automated system hunt. You do not need to start it.</p>


<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fas fa-chevron-down' : 'fas fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fas fa-chevron-right"></i>
        <span>
        
    	
    	View Artifact Source
    	
    	</span>
    </div>
    <div class="expand-content" style="display: none;">
        <pre><code>name: System.Hunt.Participation
description: |
     Endpoints may participate in hunts. This artifact collects which hunt
     each system participated in.

     Note: This is an automated system hunt. You do not need to start it.

reports:
  - type: MONITORING_DAILY
    template: |
      {{ define &quot;all_hunts&quot; }}LET allhunts &lt;= SELECT * FROM hunts(){{ end }}
      {{ define &quot;hunts&quot; }}
           SELECT * FROM foreach(
             row={ SELECT timestamp(epoch=Timestamp) AS Scheduled,
                          HuntId as ParticipatedHuntId
                   FROM source(client_id=ClientId,
                       artifact='System.Hunt.Participation') },
             query={
                SELECT Scheduled,
                       HuntId,
                       HuntDescription,
                       StartRequest.Args.Artifacts.Names
                FROM allhunts
                WHERE HuntId = ParticipatedHuntId
             })
      {{ end }}

      {{ $client_info := Query &quot;SELECT * FROM clients(client_id=ClientId) LIMIT 1&quot; }}

      # Hunt participation for {{ Get $client_info &quot;0.OsInfo.Fqdn&quot; }}

      The client with a client ID of {{ Get $client_info &quot;0.ClientId&quot; }} participated in some hunts today.

      {{ Query &quot;all_hunts&quot; &quot;hunts&quot; | Table }}

      ## VQL Query
      The following VQL query was used to plot the graph above.

      ```sql
      {{ template &quot;hunts&quot; }}
      ```
</code></pre>

    </div>
</div>

<h2 id="windows-applications-chocolateypackages">Windows.Applications.ChocolateyPackages</h2>

<p>Chocolatey packages installed in a system.</p>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>ChocolateyInstall</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>


<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fas fa-chevron-down' : 'fas fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fas fa-chevron-right"></i>
        <span>
        
    	
    	View Artifact Source
    	
    	</span>
    </div>
    <div class="expand-content" style="display: none;">
        <pre><code>name: Windows.Applications.ChocolateyPackages
description: Chocolatey packages installed in a system.
parameters:
  - name: ChocolateyInstall
    default: &quot;&quot;

sources:
  - precondition:
      SELECT OS From info() where OS = 'windows'
    queries:
      - |
        LET files =
          SELECT FullPath, parse_xml(file=FullPath) AS Metadata
          -- Use the ChocolateyInstall parameter if it is set.
          FROM glob(globs=if(
             condition=ChocolateyInstall,
             then=ChocolateyInstall,
             -- Otherwise just use the environment.
             else=environ(var='ChocolateyInstall')) + '/lib/*/*.nuspec')
      - |
        SELECT * FROM if(
        condition={
            SELECT * FROM if(
               condition=ChocolateyInstall,
               then=ChocolateyInstall,
               else=environ(var=&quot;ChocolateyInstall&quot;))
          },
        then={
            SELECT FullPath,
                   Metadata.package.metadata.id as Name,
                   Metadata.package.metadata.version as Version,
                   Metadata.package.metadata.summary as Summary,
                   Metadata.package.metadata.authors as Authors,
                   Metadata.package.metadata.licenseUrl as License
            FROM files
        })
</code></pre>

    </div>
</div>

<h2 id="windows-applications-chrome-extensions">Windows.Applications.Chrome.Extensions</h2>

<p>Fetch Chrome extensions.</p>

<p>Chrome extensions are installed into the user&rsquo;s home directory.  We
search for manifest.json files in a known path within each system
user&rsquo;s home directory. We then parse the manifest file as JSON.</p>

<p>Many extensions use locale packs to resolve strings like name and
description. In this case we detect the default locale and load
those locale files. We then resolve the extension&rsquo;s name and
description from there.</p>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>extensionGlobs</td>
<td>\AppData\Local\Google\Chrome\User Data\*\Extensions\*\*\manifest.json</td>
<td></td>
</tr>
</tbody>
</table>


<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fas fa-chevron-down' : 'fas fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fas fa-chevron-right"></i>
        <span>
        
    	
    	View Artifact Source
    	
    	</span>
    </div>
    <div class="expand-content" style="display: none;">
        <pre><code>name: Windows.Applications.Chrome.Extensions
description: |
  Fetch Chrome extensions.

  Chrome extensions are installed into the user's home directory.  We
  search for manifest.json files in a known path within each system
  user's home directory. We then parse the manifest file as JSON.

  Many extensions use locale packs to resolve strings like name and
  description. In this case we detect the default locale and load
  those locale files. We then resolve the extension's name and
  description from there.

parameters:
  - name: extensionGlobs
    default: \AppData\Local\Google\Chrome\User Data\*\Extensions\*\*\manifest.json
sources:
  - precondition: |
      SELECT OS From info() where OS = 'windows'
    queries:
      - |
        /* For each user on the system, search for extension manifests
           in their home directory. */
        LET extension_manifests = SELECT * from foreach(
          row={
             SELECT Uid, Name AS User, Directory from Artifact.Windows.Sys.Users()
          },
          query={
             SELECT FullPath, Mtime, Ctime, User, Uid from glob(
               globs=Directory + extensionGlobs)
          })

      - |
        /* If the Manifest declares a default_locale then we
           load and parse the messages file. In this case the
           messages are actually stored in the locale file
           instead of the main manifest.json file.
        */
        LET maybe_read_locale_file =
           SELECT * from if(
              condition={
                 select * from scope() where Manifest.default_locale
              },
              then={
                 SELECT Manifest,
                        Uid, User,
                        Filename as LocaleFilename,
                        ManifestFilename,
                        parse_json(data=Data) AS LocaleManifest
                 FROM read_file(
                         -- Munge the filename to get the messages.json path.
                         filenames=regex_replace(
                           source=ManifestFilename,
                           replace=&quot;\\_locales\\&quot; + Manifest.default_locale +
                                   &quot;\\messages.json&quot;,
                           re=&quot;\\\\manifest.json$&quot;))
              },
              else={
                  -- Just fill in empty Locale results.
                  SELECT Manifest,
                         Uid, User,
                         &quot;&quot; AS LocaleFilename,
                         &quot;&quot; AS ManifestFilename,
                         &quot;&quot; AS LocaleManifest
                  FROM scope()
              })

      - |
        LET parse_json_files = SELECT * from foreach(
           row={
             SELECT Filename as ManifestFilename,
                    Uid, User,
                    parse_json(data=Data) as Manifest
             FROM read_file(filenames=FullPath)
           },
           query=maybe_read_locale_file)

      - |
        LET parsed_manifest_files = SELECT * from foreach(
          row=extension_manifests,
          query=parse_json_files)

      - |
        SELECT Uid, User,

               /* If the manifest name contains __MSG_ then the real
                  name is stored in the locale manifest. This condition
                  resolves the Name column either to the main manifest or
                  the locale manifest.
               */
               if(condition=&quot;__MSG_&quot; in Manifest.name,
                  then=get(item=LocaleManifest,
                     member=regex_replace(
                        source=Manifest.name,
                        replace=&quot;$1&quot;,
                        re=&quot;(?:__MSG_(.+)__)&quot;)).message,
                  else=Manifest.name) as Name,

               if(condition=&quot;__MSG_&quot; in Manifest.description,
                  then=get(item=LocaleManifest,
                     member=regex_replace(
                        source=Manifest.description,
                        replace=&quot;$1&quot;,
                        re=&quot;(?:__MSG_(.+)__)&quot;)).message,
                  else=Manifest.description) as Description,

               /* Get the Identifier and Version from the manifest filename */
               regex_replace(
                 source=ManifestFilename,
                 replace=&quot;$1&quot;,
                 re=&quot;(?:.+Extensions\\\\([^\\\\]+)\\\\([^\\\\]+)\\\\manifest.json)$&quot;) AS Identifier,
               regex_replace(
                 source=ManifestFilename,
                 replace=&quot;$2&quot;,
                 re=&quot;(?:.+Extensions\\\\([^\\\\]+)\\\\([^\\\\]+)\\\\manifest.json)$&quot;) AS Version,

               Manifest.author as Author,
               Manifest.background.persistent AS Persistent,
               regex_replace(
                 source=ManifestFilename,
                 replace=&quot;$1&quot;,
                 re=&quot;(.+Extensions\\\\.+\\\\)manifest.json$&quot;) AS Path,

               Manifest.oauth2.scopes as Scopes,
               Manifest.permissions as Permissions,
               Manifest.key as Key

        FROM parsed_manifest_files
</code></pre>

    </div>
</div>

<h2 id="windows-applications-officemacros">Windows.Applications.OfficeMacros</h2>

<p>Office macros are a favourite initial infection vector. Many users
click through the warning dialogs.</p>

<p>This artifact scans through the given directory glob for common
office files. We then try to extract any embedded macros by parsing
the OLE file structure.</p>

<p>If a macro calls an external program (e.g. Powershell) this is very
suspicious!</p>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>officeExtensions</td>
<td>*.{xls,xlsm,doc,docx,ppt,pptm}</td>
<td></td>
</tr>

<tr>
<td>officeFileSearchGlob</td>
<td>C:\Users\**\</td>
<td>The directory to search for office documents.</td>
</tr>
</tbody>
</table>


<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fas fa-chevron-down' : 'fas fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fas fa-chevron-right"></i>
        <span>
        
    	
    	View Artifact Source
    	
    	</span>
    </div>
    <div class="expand-content" style="display: none;">
        <pre><code>name: Windows.Applications.OfficeMacros
description: |
  Office macros are a favourite initial infection vector. Many users
  click through the warning dialogs.

  This artifact scans through the given directory glob for common
  office files. We then try to extract any embedded macros by parsing
  the OLE file structure.

  If a macro calls an external program (e.g. Powershell) this is very
  suspicious!

parameters:
  - name: officeExtensions
    default: &quot;*.{xls,xlsm,doc,docx,ppt,pptm}&quot;
  - name: officeFileSearchGlob
    default: C:\Users\**\
    description: The directory to search for office documents.

sources:
  - queries:
      - |
        SELECT * FROM foreach(
           row={
              SELECT FullPath FROM glob(globs=officeFileSearchGlob + officeExtensions)
           },
           query={
               SELECT * from olevba(file=FullPath)
           })
</code></pre>

    </div>
</div>

<h2 id="windows-eventlogs-dhcp">Windows.EventLogs.DHCP</h2>

<p>This artifact parses the windows dhcp event log looking for evidence
of IP address assignments.</p>

<p>In some investigations it is important to be able to identify the
machine which was assigned a particular IP address at a point in
time. Usually these logs are available from the DHCP server, but in
many cases the server logs are not available (for example, if the
endpoint was visiting a different network or the DHCP server is on a
wireless router with no log retention).</p>

<p>On windows, there are two types of logs:</p>

<ol>
<li><p>The first type is the admin log
 (<code>Microsoft-Windows-Dhcp-Client%4Admin.evt</code>). These only contain
 errors such as an endpoint trying to continue its lease, but
 the lease is rejected by the server.</p></li>

<li><p>The operational log
 (<code>Microsoft-Windows-Dhcp-Client%4Operational.evtx</code>) contains
 the full log of each lease. Unfortunately this log is disabled
 by default. If it is available we can rely on the information.</p></li>
</ol>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>eventDirGlob</td>
<td>C:\Windows\system32\winevt\logs\</td>
<td></td>
</tr>

<tr>
<td>adminLog</td>
<td>Microsoft-Windows-Dhcp-Client%4Admin.evtx</td>
<td></td>
</tr>

<tr>
<td>operationalLog</td>
<td>Microsoft-Windows-Dhcp-Client%4Operational.evtx</td>
<td></td>
</tr>

<tr>
<td>accessor</td>
<td>file</td>
<td></td>
</tr>
</tbody>
</table>


<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fas fa-chevron-down' : 'fas fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fas fa-chevron-right"></i>
        <span>
        
    	
    	View Artifact Source
    	
    	</span>
    </div>
    <div class="expand-content" style="display: none;">
        <pre><code>name: Windows.EventLogs.DHCP
description: |

  This artifact parses the windows dhcp event log looking for evidence
  of IP address assignments.

  In some investigations it is important to be able to identify the
  machine which was assigned a particular IP address at a point in
  time. Usually these logs are available from the DHCP server, but in
  many cases the server logs are not available (for example, if the
  endpoint was visiting a different network or the DHCP server is on a
  wireless router with no log retention).

  On windows, there are two types of logs:

    1. The first type is the admin log
       (`Microsoft-Windows-Dhcp-Client%4Admin.evt`). These only contain
       errors such as an endpoint trying to continue its lease, but
       the lease is rejected by the server.

    2. The operational log
       (`Microsoft-Windows-Dhcp-Client%4Operational.evtx`) contains
       the full log of each lease. Unfortunately this log is disabled
       by default. If it is available we can rely on the information.

parameters:
  - name: eventDirGlob
    default: C:\Windows\system32\winevt\logs\
  - name: adminLog
    default: Microsoft-Windows-Dhcp-Client%4Admin.evtx

  - name: operationalLog
    default: Microsoft-Windows-Dhcp-Client%4Operational.evtx

  - name: accessor
    default: file

sources:
  - name: RejectedDHCP
    queries:
      - |
        LET files = SELECT * FROM glob(
            globs=eventDirGlob + adminLog,
            accessor=accessor)
      - |
        SELECT Time AS _Time,
               timestamp(epoch=Time) As Timestamp,
               Computer, MAC, ClientIP, DHCPServer, Type FROM foreach(
           row=files,
           query={
              SELECT System.TimeCreated.SystemTime as Time,
                     System.Computer AS Computer,
                     format(format=&quot;%x:%x:%x:%x:%x:%x&quot;, args=[EventData.HWAddress]) AS MAC,
                     ip(netaddr4_le=EventData.Address1) AS ClientIP,
                     ip(netaddr4_le=EventData.Address2) AS DHCPServer,
                     &quot;Lease Rejected&quot; AS Type
              FROM parse_evtx(filename=FullPath, accessor=accessor)
              WHERE System.EventID.Value = 1002
           })

  - name: AssignedDHCP
    queries:
      - |
        LET files = SELECT * FROM glob(
            globs=eventDirGlob + operationalLog,
            accessor=accessor)
      - |
        SELECT Time AS _Time,
               timestamp(epoch=Time) As Timestamp,
               Computer, MAC, ClientIP, DHCPServer, Type FROM foreach(
           row=files,
           query={
              SELECT System.TimeCreated.SystemTime as Time,
                     System.Computer AS Computer,
                     EventData.InterfaceGuid AS MAC,
                     ip(netaddr4_le=EventData.Address1) AS ClientIP,
                     ip(netaddr4_le=EventData.Address2) AS DHCPServer,
                     &quot;Lease Assigned&quot; AS Type
              FROM parse_evtx(filename=FullPath, accessor=accessor)
              WHERE System.EventID.Value = 60000
           })


reports:
  - type: CLIENT
    template: |
      Evidence of DHCP assigned IP addresses
      ======================================

      {{ .Description }}

      {{ define &quot;assigned_dhcp&quot; }}
            SELECT Computer, ClientIP,
                   count(items=Timestamp) AS Total,
                   enumerate(items=Timestamp) AS Times
            FROM source(source='AssignedDHCP')
            GROUP BY ClientIP
      {{ end }}
      {{ define &quot;rejected_dhcp&quot; }}
            SELECT Computer, ClientIP,
                   count(items=Timestamp) AS Total,
                   enumerate(items=Timestamp) AS Times
            FROM source(source='RejectedDHCP')
            GROUP BY ClientIP
      {{ end }}

      {{ $assigned := Query &quot;assigned_dhcp&quot;}}
      {{ if $assigned }}
      ## Operational logs

      This machine has DHCP operational logging enabled. We therefore
      can see complete references to all granted leases:
        {{ Table $assigned }}

      ## Timeline

      {{ Query &quot;SELECT _Time * 1000, ClientIP FROM source(source='AssignedDHCP')&quot; | Timeline }}

      {{ end }}

      ## Admin logs

      The admin logs show errors with DHCP lease requests. Typically
      rejected leases indicate that the machine held a least on a IP
      address in the past, but this lease is invalid for its current
      environment. For example, the machine has been moved to a
      different network.

      {{ Query &quot;rejected_dhcp&quot; | Table }}

      {{ Query &quot;SELECT _Time * 1000, ClientIP FROM source(source='RejectedDHCP')&quot; | Timeline }}
</code></pre>

    </div>
</div>

<h2 id="windows-network-arpcache">Windows.Network.ArpCache</h2>

<p>Address resolution cache, both static and dynamic (from ARP, NDP).</p>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>wmiQuery</td>
<td>SELECT AddressFamily, Store, State, InterfaceIndex, IPAddress,\n       InterfaceAlias, LinkLayerAddress\nfrom MSFT_NetNeighbor\n</td>
<td></td>
</tr>

<tr>
<td>wmiNamespace</td>
<td>ROOT\StandardCimv2</td>
<td></td>
</tr>

<tr>
<td>kMapOfState</td>
<td>{\n &ldquo;0&rdquo;: &ldquo;Unreachable&rdquo;,\n &ldquo;1&rdquo;: &ldquo;Incomplete&rdquo;,\n &ldquo;2&rdquo;: &ldquo;Probe&rdquo;,\n &ldquo;3&rdquo;: &ldquo;Delay&rdquo;,\n &ldquo;4&rdquo;: &ldquo;Stale&rdquo;,\n &ldquo;5&rdquo;: &ldquo;Reachable&rdquo;,\n &ldquo;6&rdquo;: &ldquo;Permanent&rdquo;,\n &ldquo;7&rdquo;: &ldquo;TBD&rdquo;\n}\n</td>
<td></td>
</tr>
</tbody>
</table>


<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fas fa-chevron-down' : 'fas fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fas fa-chevron-right"></i>
        <span>
        
    	
    	View Artifact Source
    	
    	</span>
    </div>
    <div class="expand-content" style="display: none;">
        <pre><code>name: Windows.Network.ArpCache
description: Address resolution cache, both static and dynamic (from ARP, NDP).
parameters:
  - name: wmiQuery
    default: |
      SELECT AddressFamily, Store, State, InterfaceIndex, IPAddress,
             InterfaceAlias, LinkLayerAddress
      from MSFT_NetNeighbor
  - name: wmiNamespace
    default: ROOT\StandardCimv2

  - name: kMapOfState
    default: |
     {
      &quot;0&quot;: &quot;Unreachable&quot;,
      &quot;1&quot;: &quot;Incomplete&quot;,
      &quot;2&quot;: &quot;Probe&quot;,
      &quot;3&quot;: &quot;Delay&quot;,
      &quot;4&quot;: &quot;Stale&quot;,
      &quot;5&quot;: &quot;Reachable&quot;,
      &quot;6&quot;: &quot;Permanent&quot;,
      &quot;7&quot;: &quot;TBD&quot;
     }

sources:
  - precondition:
      SELECT OS From info() where OS = 'windows'
    queries:
      - |
        LET interfaces &lt;=
          SELECT Index, HardwareAddr, IP
          FROM Artifact.Windows.Network.InterfaceAddresses()

      - |
        LET arp_cache = SELECT if(condition=AddressFamily=23,
                    then=&quot;IPv6&quot;,
                  else=if(condition=AddressFamily=2,
                    then=&quot;IPv4&quot;,
                  else=AddressFamily)) as AddressFamily,

               if(condition=Store=0,
                    then=&quot;Persistent&quot;,
                  else=if(condition=(Store=1),
                    then=&quot;Active&quot;,
                  else=&quot;?&quot;)) as Store,

               get(item=parse_json(data=kMapOfState),
                   member=encode(string=State, type='string')) AS State,
               InterfaceIndex, IPAddress,
               InterfaceAlias, LinkLayerAddress
            FROM wmi(query=wmiQuery, namespace=wmiNamespace)
      - |
        SELECT * FROM foreach(
          row=arp_cache,
          query={
             SELECT AddressFamily, Store, State, InterfaceIndex,
                    IP AS LocalAddress, HardwareAddr, IPAddress as RemoteAddress,
                    InterfaceAlias, LinkLayerAddress AS RemoteMACAddress
             FROM interfaces
             WHERE InterfaceIndex = Index
          })
</code></pre>

    </div>
</div>

<h2 id="windows-network-interfaceaddresses">Windows.Network.InterfaceAddresses</h2>

<p>Network interfaces and relevant metadata.</p>


<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fas fa-chevron-down' : 'fas fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fas fa-chevron-right"></i>
        <span>
        
    	
    	View Artifact Source
    	
    	</span>
    </div>
    <div class="expand-content" style="display: none;">
        <pre><code>name: Windows.Network.InterfaceAddresses
description: Network interfaces and relevant metadata.
sources:
  - precondition:
      SELECT OS From info() where OS = 'windows'
    queries:
      - |
        LET interface_address =
           SELECT Index, MTU, Name, HardwareAddr, Flags, Addrs
           from interfaces()

      - |
        SELECT Index, MTU, Name, HardwareAddr.String As HardwareAddr,
           Flags, Addrs.IP as IP, Addrs.Mask.String as Mask
        FROM flatten(query=interface_address)
</code></pre>

    </div>
</div>

<h2 id="windows-network-listeningports">Windows.Network.ListeningPorts</h2>

<p>Processes with listening (bound) network sockets/ports.</p>


<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fas fa-chevron-down' : 'fas fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fas fa-chevron-right"></i>
        <span>
        
    	
    	View Artifact Source
    	
    	</span>
    </div>
    <div class="expand-content" style="display: none;">
        <pre><code>name: Windows.Network.ListeningPorts
description: Processes with listening (bound) network sockets/ports.
sources:
  - precondition:
      SELECT OS From info() where OS = 'windows'
    queries:
      - |
        LET process &lt;= SELECT Name, Pid from pslist()

      - |
        SELECT * from foreach(
          row={
            SELECT Pid AS PortPid, Laddr.Port AS Port,
                   TypeString as Protocol, FamilyString as Family,
                   Laddr.IP as Address
            FROM netstat() where Status = 'LISTEN'
          },
          query={
            SELECT Pid, Name, Port, Protocol, Family, Address
            FROM process where Pid = PortPid
          })
</code></pre>

    </div>
</div>

<h2 id="windows-network-netstat">Windows.Network.Netstat</h2>

<p>Show information about open sockets. On windows the time when the
socket was first bound is also shown.</p>


<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fas fa-chevron-down' : 'fas fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fas fa-chevron-right"></i>
        <span>
        
    	
    	View Artifact Source
    	
    	</span>
    </div>
    <div class="expand-content" style="display: none;">
        <pre><code>name: Windows.Network.Netstat
description: |
  Show information about open sockets. On windows the time when the
  socket was first bound is also shown.

sources:
  - precondition:
      SELECT OS From info() where OS = 'windows'
    queries:
      - |
        SELECT Pid, FamilyString as Family,
               TypeString as Type,
               Status,
               Laddr.IP, Laddr.Port,
               Raddr.IP, Raddr.Port,
               Timestamp
               FROM netstat()
</code></pre>

    </div>
</div>

<h2 id="windows-packs-autoexec">Windows.Packs.Autoexec</h2>

<p>Aggregate of executables that will automatically execute on the
target machine. This is an amalgamation of other tables like
services, scheduled_tasks, startup_items and more.</p>


<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fas fa-chevron-down' : 'fas fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fas fa-chevron-right"></i>
        <span>
        
    	
    	View Artifact Source
    	
    	</span>
    </div>
    <div class="expand-content" style="display: none;">
        <pre><code>name: Windows.Packs.Autoexec
description: |
  Aggregate of executables that will automatically execute on the
  target machine. This is an amalgamation of other tables like
  services, scheduled_tasks, startup_items and more.

sources:
  - precondition:
      SELECT OS From info() where OS = 'windows'
    queries:
      - |
        SELECT * from chain(
          q1={
            SELECT Name, Command AS Path, &quot;StartupItems&quot; as Source
            FROM Artifact.Windows.Sys.StartupItems()
          })
</code></pre>

    </div>
</div>

<h2 id="windows-packs-persistence">Windows.Packs.Persistence</h2>

<p>This artifact pack collects various persistence mechanisms in Windows.</p>


<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fas fa-chevron-down' : 'fas fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fas fa-chevron-right"></i>
        <span>
        
    	
    	View Artifact Source
    	
    	</span>
    </div>
    <div class="expand-content" style="display: none;">
        <pre><code>name: Windows.Packs.Persistence
description: |
  This artifact pack collects various persistence mechanisms in Windows.

precondition:
  SELECT OS from info() where OS = &quot;windows&quot;

sources:
  - name: WMI Event Filters
    description: |
      {{ DocFrom &quot;Windows.Persistence.PermanentWMIEvents&quot; }}

    queries:
      - |
        SELECT * FROM Artifact.Windows.Persistence.PermanentWMIEvents()

  - name: Startup Items
    description: |
      {{ DocFrom &quot;Windows.Sys.StartupItems&quot; }}

    queries:
      - |
        SELECT * FROM Artifact.Windows.Sys.StartupItems()

  - name: Debug Bootstraping
    description: |
      {{ DocFrom &quot;Windows.Persistence.Debug&quot; }}

      If there are any rows in the table below then executing the
      program will also launch the program listed under the Debugger
      column.

    queries:
      - SELECT * FROM Artifact.Windows.Persistence.Debug()
</code></pre>

    </div>
</div>

<h2 id="windows-registry-ntuser">Windows.Registry.NTUser</h2>

<p>This artifact searches for keys or values within the user&rsquo;s
NTUser.dat registry hives.</p>

<p>When a user logs into a windows machine the system creates their own
&ldquo;profile&rdquo; which consists of a registry hive mapped into the
HKEY_USERS hive. This hive file is locked as long as the user is
logged in. If the user is not logged in, the file is not mapped at
all.</p>

<p>This artifact bypasses the locking mechanism by parsing the raw NTFS
filesystem to recover the registry hives. We then parse the registry
hives to search for the glob provided.</p>

<p>This artifact is designed to be reused by other artifacts that need
to access user data.</p>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>KeyGlob</td>
<td>Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\**</td>
<td></td>
</tr>

<tr>
<td>UserHomes</td>
<td>C:\Users\*\NTUSER.DAT</td>
<td></td>
</tr>
</tbody>
</table>


<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fas fa-chevron-down' : 'fas fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fas fa-chevron-right"></i>
        <span>
        
    	
    	View Artifact Source
    	
    	</span>
    </div>
    <div class="expand-content" style="display: none;">
        <pre><code>name: Windows.Registry.NTUser
description: |
  This artifact searches for keys or values within the user's
  NTUser.dat registry hives.

  When a user logs into a windows machine the system creates their own
  &quot;profile&quot; which consists of a registry hive mapped into the
  HKEY_USERS hive. This hive file is locked as long as the user is
  logged in. If the user is not logged in, the file is not mapped at
  all.

  This artifact bypasses the locking mechanism by parsing the raw NTFS
  filesystem to recover the registry hives. We then parse the registry
  hives to search for the glob provided.

  This artifact is designed to be reused by other artifacts that need
  to access user data.

parameters:
 - name: KeyGlob
   default: Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\**
 - name: UserHomes
   default: C:\Users\*\NTUSER.DAT

sources:
 - queries:
     - |
       SELECT * FROM foreach(
         row={
            SELECT FullPath FROM glob(globs=UserHomes)
         },
         query={
            SELECT FullPath, Data, Mtime.Sec AS Mtime FROM glob(
               globs=url(scheme=&quot;ntfs&quot;,
                  path=FullPath,
                  fragment=KeyGlob).String,
               accessor=&quot;raw_reg&quot;)
         })
</code></pre>

    </div>
</div>

<h2 id="windows-registry-ntuser-upload">Windows.Registry.NTUser.Upload</h2>

<p>This artifact collects all the user&rsquo;s NTUser.dat registry hives.</p>

<p>When a user logs into a windows machine the system creates their own
&ldquo;profile&rdquo; which consists of a registry hive mapped into the
HKEY_USERS hive. This hive file is locked as long as the user is
logged in.</p>

<p>This artifact bypasses the locking mechanism by extracting the
registry hives using raw NTFS parsing. We then just upload all hives
to the server.</p>


<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fas fa-chevron-down' : 'fas fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fas fa-chevron-right"></i>
        <span>
        
    	
    	View Artifact Source
    	
    	</span>
    </div>
    <div class="expand-content" style="display: none;">
        <pre><code>name: Windows.Registry.NTUser.Upload
description: |
  This artifact collects all the user's NTUser.dat registry hives.

  When a user logs into a windows machine the system creates their own
  &quot;profile&quot; which consists of a registry hive mapped into the
  HKEY_USERS hive. This hive file is locked as long as the user is
  logged in.

  This artifact bypasses the locking mechanism by extracting the
  registry hives using raw NTFS parsing. We then just upload all hives
  to the server.

sources:
  - precondition: |
      SELECT OS From info() where OS = 'windows'
    queries:
      - |
        LET users = SELECT Name, Directory as HomeDir
            FROM Artifact.Windows.Sys.Users()
            WHERE Directory

      - |
        SELECT upload(file=&quot;\\\\.\\&quot; + HomeDir + &quot;\\ntuser.dat&quot;,
                      accessor=&quot;ntfs&quot;) as Upload
        FROM users
</code></pre>

    </div>
</div>

<h2 id="windows-registry-sysinternals-eulacheck">Windows.Registry.Sysinternals.Eulacheck</h2>

<p>Checks for the Accepted Sysinternals EULA from the registry key
&ldquo;HKCU\Software\Sysinternals[TOOL]\&ldquo;.  When a Sysinternals tool is
first run on a system, the EULA must be accepted. This writes a
value called EulaAccepted under that key.</p>

<p>Note: This artifact uses HKEY_USERS and therefore will not detect
users that are not currently logged on.</p>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>Sysinternals_Reg_Key</td>
<td>HKEY_USERS\*\Software\Sysinternals\*</td>
<td></td>
</tr>
</tbody>
</table>


<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fas fa-chevron-down' : 'fas fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fas fa-chevron-right"></i>
        <span>
        
    	
    	View Artifact Source
    	
    	</span>
    </div>
    <div class="expand-content" style="display: none;">
        <pre><code>name: Windows.Registry.Sysinternals.Eulacheck
description: |
  Checks for the Accepted Sysinternals EULA from the registry key
  &quot;HKCU\Software\Sysinternals\[TOOL]\&quot;.  When a Sysinternals tool is
  first run on a system, the EULA must be accepted. This writes a
  value called EulaAccepted under that key.

  Note: This artifact uses HKEY_USERS and therefore will not detect
  users that are not currently logged on.

parameters:
   - name: Sysinternals_Reg_Key
     default: HKEY_USERS\*\Software\Sysinternals\*

sources:
  - precondition:
      SELECT OS From info() where OS = 'windows'

    queries:
    - |
      LET users &lt;= SELECT Name, UUID FROM Artifact.Windows.Sys.Users()
    - |
      SELECT Key.Name as ProgramName,
             Key.FullPath as Key,
             timestamp(epoch=Key.Mtime.Sec) AS TimeAccepted,
             {
                SELECT Name FROM users WHERE UUID=regex_replace(
                   source=Key.FullPath, re=&quot;.+\\\\(S-[^\\\\]+)\\\\.+&quot;, replace=&quot;$1&quot;)
             } as User,
             EulaAccepted
      FROM read_reg_key(globs=split(string=Sysinternals_Reg_Key, sep=',[\\s]*'))
</code></pre>

    </div>
</div>

<h2 id="windows-search-filefinder">Windows.Search.FileFinder</h2>

<p>Find files on the filesystem using the filename or content.</p>

<h2 id="performance-note">Performance Note</h2>

<p>This artifact can be quite expensive, especially if we search file
content. It will require opening each file and reading its entire
content. To minimize the impact on the endpoint we recommend this
artifact is collected with a rate limited way (about 20-50 ops per
second).</p>

<p>This artifact is usefull in the following scenarios:</p>

<ul>
<li><p>We need to locate all the places on our network where customer
data has been copied.</p></li>

<li><p>We’ve identified malware in a data breach, named using short
random strings in specific folders and need to search for other
instances across the network.</p></li>

<li><p>We believe our user account credentials have been dumped and
need to locate them.</p></li>

<li><p>We need to search for exposed credit card data to satisfy PCI
requirements.</p></li>

<li><p>We have a sample of data that has been disclosed and need to
locate other similar files</p></li>
</ul>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>SearchFilesGlob</td>
<td>C:\Users\**</td>
<td>Use a glob to define the files that will be searched.</td>
</tr>

<tr>
<td>Keywords</td>
<td>None</td>
<td>A comma delimited list of strings to search for.</td>
</tr>

<tr>
<td>Use_Raw_NTFS</td>
<td>Y</td>
<td></td>
</tr>

<tr>
<td>Upload_File</td>
<td>N</td>
<td></td>
</tr>

<tr>
<td>Calculate_Hash</td>
<td>N</td>
<td></td>
</tr>

<tr>
<td>MoreRecentThan</td>
<td></td>
<td></td>
</tr>

<tr>
<td>ModifiedBefore</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>


<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fas fa-chevron-down' : 'fas fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fas fa-chevron-right"></i>
        <span>
        
    	
    	View Artifact Source
    	
    	</span>
    </div>
    <div class="expand-content" style="display: none;">
        <pre><code>name: Windows.Search.FileFinder
description: |
  Find files on the filesystem using the filename or content.


  ## Performance Note

  This artifact can be quite expensive, especially if we search file
  content. It will require opening each file and reading its entire
  content. To minimize the impact on the endpoint we recommend this
  artifact is collected with a rate limited way (about 20-50 ops per
  second).

  This artifact is usefull in the following scenarios:

    * We need to locate all the places on our network where customer
      data has been copied.

    * We’ve identified malware in a data breach, named using short
      random strings in specific folders and need to search for other
      instances across the network.

    * We believe our user account credentials have been dumped and
      need to locate them.

    * We need to search for exposed credit card data to satisfy PCI
      requirements.

    * We have a sample of data that has been disclosed and need to
      locate other similar files


precondition:
  SELECT * FROM info() where OS = 'windows'

parameters:
  - name: SearchFilesGlob
    default: C:\Users\**
    description: Use a glob to define the files that will be searched.

  - name: Keywords
    default:
    description: A comma delimited list of strings to search for.

  - name: Use_Raw_NTFS
    default: Y
    type: bool

  - name: Upload_File
    default: N
    type: bool

  - name: Calculate_Hash
    default: N
    type: bool

  - name: MoreRecentThan
    default: &quot;&quot;
    type: timestamp

  - name: ModifiedBefore
    default: &quot;&quot;
    type: timestamp


sources:
  - queries:
    - |
      LET ntfs_search = SELECT FullPath,
               Sys.mft as Inode,
               Mode.String AS Mode, Size,
               Mtime.Sec AS Modified,
               timestamp(epoch=Atime.Sec) AS ATime,
               timestamp(epoch=Mtime.Sec) AS MTime,
               timestamp(epoch=Ctime.Sec) AS CTime,
               if(condition=(Upload_File = &quot;Y&quot; and NOT IsDir ),
                  then=upload(file=FullPath, accessor=&quot;ntfs&quot;)) AS Upload,
               if(condition=(Calculate_Hash = &quot;Y&quot; and NOT IsDir ),
                  then=hash(path=FullPath, accessor=&quot;ntfs&quot;)) AS Hash
        FROM glob(globs=SearchFilesGlob, accessor=&quot;ntfs&quot;)

    - |
      LET file_search = SELECT FullPath,
               Sys.mft as Inode,
               Mode.String AS Mode, Size,
               Mtime.Sec AS Modified,
               timestamp(epoch=Atime.Sec) AS ATime,
               timestamp(epoch=Mtime.Sec) AS MTime,
               timestamp(epoch=Ctime.Sec) AS CTime,
               if(condition=(Upload_File = &quot;Y&quot; and NOT IsDir ),
                  then=upload(file=FullPath, accessor=&quot;file&quot;)) AS Upload,
               if(condition=(Calculate_Hash = &quot;Y&quot; and NOT IsDir ),
                  then=hash(path=FullPath, accessor=&quot;file&quot;)) AS Hash
        FROM glob(globs=SearchFilesGlob, accessor=&quot;file&quot;)

    - |
      LET combined_search = SELECT * FROM if(
        condition=(Use_Raw_NTFS = &quot;Y&quot;),
        then=ntfs_search,
        else=file_search)

    - |
      LET more_recent = SELECT * FROM if(
        condition=MoreRecentThan,
        then={
          SELECT * FROM combined_search
          WHERE Modified &gt; atoi(string=MoreRecentThan)
        }, else=combined_search)

    - |
      SELECT * FROM if(
        condition=ModifiedBefore,
        then={
          SELECT * FROM more_recent
          WHERE Modified &lt; atoi(string=ModifiedBefore)
        }, else=more_recent)
</code></pre>

    </div>
</div>


<footer class=" footline" >
	
</footer>


        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/docs/artifacts/linux/linux/" title="Linux Artifacts"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/docs/artifacts/server/" title="Server Artifacts" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1560531008"></script>
    <script src="/js/perfect-scrollbar.min.js?1560531008"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1560531008"></script>
    <script src="/js/jquery.sticky.js?1560531008"></script>
    <script src="/js/featherlight.min.js?1560531008"></script>
    <script src="/js/html5shiv-printshiv.min.js?1560531008"></script>
    <script src="/js/highlight.pack.js?1560531008"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1560531008"></script>
    <script src="/js/learn.js?1560531008"></script>
    <script src="/js/hugo-learn.js?1560531008"></script>

    <link href="/mermaid/mermaid.css?1560531008" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1560531008"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>

