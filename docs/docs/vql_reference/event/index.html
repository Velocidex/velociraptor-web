<!DOCTYPE html>
<html>
  <head>
    <title>Velociraptor / Dig deeper</title>
    
      <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>Event Plugins :: Velociraptor / Dig deeper</title>
<link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon" />
<link rel="stylesheet" href="/css/bootstrap.min.css">
<link href="/css/nucleus.css" rel="stylesheet">
<link href="/css/font-awesome.min.css" rel="stylesheet">
<link href="/css/hybrid.css" rel="stylesheet">
<link href="/css/featherlight.min.css" rel="stylesheet">
<link href="/css/auto-complete.css" rel="stylesheet">
<link href="/theme-original/style.css" rel="stylesheet">

  <link href="/theme-original/variant-mine.css" rel="stylesheet">


<script src="/js/jquery-2.x.min.js"></script>
<style type="text/css">
  :root #header + #content > #left > #rlblock_left {
    display:none !important;
  }
</style>
<link rel="stylesheet" href="/css/theme-mine.css">
<script src="/js/custom.js"></script>


    
  </head>
  <body data-url="/docs/vql_reference/event/">
    
      <div id="headermain"></div>
<nav id="sidebar" class="">



<div class="highlightable">
  <div id="header-wrapper">
    <div id="header">
      
	
  
    <a href="/">
  <img src="/images/logo.svg">
</a>

  


    </div>
        <div class="searchbox">
                    <label for="search-by"><i class="fa fa-search"></i></label>
                    <input data-search-input id="search-by" type="text" placeholder="Search...">
                    <span data-search-clear=""><i class="fa fa-close"></i></span>
                </div>
                <script type="text/javascript" src="/js/lunr.min.js"></script>
                <script type="text/javascript" src="/js/auto-complete.js"></script>
                <script type="text/javascript">
        
            var baseurl = "\/";
        
                </script>
                <script type="text/javascript" src="/js/search.js"></script>
  </div>

      <ul class="topics">
    <li data-nav-id="/about/" class="dd-item haschildren
        ">
      <div>
      <a href="/about/">About Velociraptor</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/about/features/" class="dd-item">
        <div>
          <a href="/about/features/">
            Velociraptor Features
          </a>
        </div>
    </li>
      <li data-nav-id="/about/license/" class="dd-item">
        <div>
          <a href="/about/license/">
            License
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/docs/" class="dd-item parent haschildren
        ">
      <div>
      <a href="/docs/">Velociraptor Documentation</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/docs/getting-started/" class="dd-item haschildren
        ">
      <div>
      <a href="/docs/getting-started/">Getting Started</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/docs/getting-started/stand_alone/" class="dd-item
        ">
      <div>
      <a href="/docs/getting-started/stand_alone/">Standalone Deployment</a>
      </div>
    </li>
    <li data-nav-id="/docs/getting-started/deploying_clients/" class="dd-item
        ">
      <div>
      <a href="/docs/getting-started/deploying_clients/">Deploying Clients</a>
      </div>
    </li>
    <li data-nav-id="/docs/getting-started/cloud/" class="dd-item
        ">
      <div>
      <a href="/docs/getting-started/cloud/">Deploying in the cloud</a>
      </div>
    </li>
    <li data-nav-id="/docs/getting-started/performance/" class="dd-item
        ">
      <div>
      <a href="/docs/getting-started/performance/">Performance</a>
      </div>
    </li>
    <li data-nav-id="/docs/getting-started/triaging/" class="dd-item
        ">
      <div>
      <a href="/docs/getting-started/triaging/">Triaging</a>
      </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/docs/user-interface/" class="dd-item haschildren
        ">
      <div>
      <a href="/docs/user-interface/">User Interface</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/docs/user-interface/investigating_clients/" class="dd-item haschildren
        ">
      <div>
      <a href="/docs/user-interface/investigating_clients/">Investigating Clients</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/docs/user-interface/investigating_clients/searching_clients/" class="dd-item
        ">
      <div>
      <a href="/docs/user-interface/investigating_clients/searching_clients/">Searching for clients</a>
      </div>
    </li>
    <li data-nav-id="/docs/user-interface/investigating_clients/virtual_filesystem/" class="dd-item
        ">
      <div>
      <a href="/docs/user-interface/investigating_clients/virtual_filesystem/">The Virtual File System</a>
      </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/docs/user-interface/artifacts/" class="dd-item haschildren
        ">
      <div>
      <a href="/docs/user-interface/artifacts/">Velociraptor Artifacts</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/docs/user-interface/artifacts/client_artifacts/" class="dd-item
        ">
      <div>
      <a href="/docs/user-interface/artifacts/client_artifacts/">Client Artifacts</a>
      </div>
    </li>
    <li data-nav-id="/docs/user-interface/artifacts/client_events/" class="dd-item
        ">
      <div>
      <a href="/docs/user-interface/artifacts/client_events/">Client Event Artifacts</a>
      </div>
    </li>
    <li data-nav-id="/docs/user-interface/artifacts/server_artifacts/" class="dd-item
        ">
      <div>
      <a href="/docs/user-interface/artifacts/server_artifacts/">Server Artifacts</a>
      </div>
    </li>
    <li data-nav-id="/docs/user-interface/artifacts/server_events/" class="dd-item
        ">
      <div>
      <a href="/docs/user-interface/artifacts/server_events/">Server Event Artifacts</a>
      </div>
    </li>
    <li data-nav-id="/docs/user-interface/artifacts/add_artifacts/" class="dd-item
        ">
      <div>
      <a href="/docs/user-interface/artifacts/add_artifacts/">Customizing Artifacts</a>
      </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/docs/user-interface/api/" class="dd-item
        ">
      <div>
      <a href="/docs/user-interface/api/">The Velociraptor API</a>
      </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/docs/vql_reference/" class="dd-item parent haschildren
        ">
      <div>
      <a href="/docs/vql_reference/">VQL Reference</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/docs/vql_reference/basic/" class="dd-item
        ">
      <div>
      <a href="/docs/vql_reference/basic/">Basic VQL functions and plugins</a>
      </div>
    </li>
    <li data-nav-id="/docs/vql_reference/windows/" class="dd-item
        ">
      <div>
      <a href="/docs/vql_reference/windows/">Windows Specific Functionality</a>
      </div>
    </li>
    <li data-nav-id="/docs/vql_reference/parsers/" class="dd-item
        ">
      <div>
      <a href="/docs/vql_reference/parsers/">Parsers and data extractors</a>
      </div>
    </li>
    <li data-nav-id="/docs/vql_reference/server/" class="dd-item
        ">
      <div>
      <a href="/docs/vql_reference/server/">Server Side Functionality</a>
      </div>
    </li>
    <li data-nav-id="/docs/vql_reference/plugin/" class="dd-item
        ">
      <div>
      <a href="/docs/vql_reference/plugin/">Client Side Functionality</a>
      </div>
    </li>
    <li data-nav-id="/docs/vql_reference/event/" class="dd-item parent active
        ">
      <div>
      <a href="/docs/vql_reference/event/">Event Plugins</a>
      </div>
    </li>
    <li data-nav-id="/docs/vql_reference/experimental/" class="dd-item
        ">
      <div>
      <a href="/docs/vql_reference/experimental/">Experimental Functionality</a>
      </div>
    </li>
    <li data-nav-id="/docs/vql_reference/filesystem_accessors/" class="dd-item
        ">
      <div>
      <a href="/docs/vql_reference/filesystem_accessors/">Filesystem Accessors</a>
      </div>
    </li>
    <li data-nav-id="/docs/vql_reference/templates/" class="dd-item
        ">
      <div>
      <a href="/docs/vql_reference/templates/">Report Templates</a>
      </div>
    </li>
    <li data-nav-id="/docs/vql_reference/tips/" class="dd-item
        ">
      <div>
      <a href="/docs/vql_reference/tips/">Artifact Tips</a>
      </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/docs/artifacts/" class="dd-item haschildren
        ">
      <div>
      <a href="/docs/artifacts/">Artifact Reference</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/docs/artifacts/linux/" class="dd-item
        ">
      <div>
      <a href="/docs/artifacts/linux/">Linux Artifacts</a>
      </div>
    </li>
    <li data-nav-id="/docs/artifacts/windows_system/" class="dd-item haschildren
        ">
      <div>
      <a href="/docs/artifacts/windows_system/">Windows</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/docs/artifacts/windows_system/events/" class="dd-item
        ">
      <div>
      <a href="/docs/artifacts/windows_system/events/">Event Logs</a>
      </div>
    </li>
    <li data-nav-id="/docs/artifacts/windows_system/system/" class="dd-item
        ">
      <div>
      <a href="/docs/artifacts/windows_system/system/">System</a>
      </div>
    </li>
    <li data-nav-id="/docs/artifacts/windows_system/registry/" class="dd-item
        ">
      <div>
      <a href="/docs/artifacts/windows_system/registry/">Registry</a>
      </div>
    </li>
    <li data-nav-id="/docs/artifacts/windows_system/network/" class="dd-item
        ">
      <div>
      <a href="/docs/artifacts/windows_system/network/">Network</a>
      </div>
    </li>
    <li data-nav-id="/docs/artifacts/windows_system/applications/" class="dd-item
        ">
      <div>
      <a href="/docs/artifacts/windows_system/applications/">Applications</a>
      </div>
    </li>
    <li data-nav-id="/docs/artifacts/windows_system/detection/" class="dd-item
        ">
      <div>
      <a href="/docs/artifacts/windows_system/detection/">Malware Detection</a>
      </div>
    </li>
    <li data-nav-id="/docs/artifacts/windows_system/triage/" class="dd-item
        ">
      <div>
      <a href="/docs/artifacts/windows_system/triage/">Triage Artifacts</a>
      </div>
    </li>
    <li data-nav-id="/docs/artifacts/windows_system/remediation/" class="dd-item
        ">
      <div>
      <a href="/docs/artifacts/windows_system/remediation/">Remdiation</a>
      </div>
    </li>
    <li data-nav-id="/docs/artifacts/windows_system/monitoring/" class="dd-item
        ">
      <div>
      <a href="/docs/artifacts/windows_system/monitoring/">Event Monitoring</a>
      </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/docs/artifacts/server/" class="dd-item
        ">
      <div>
      <a href="/docs/artifacts/server/">Server Artifacts</a>
      </div>
    </li>
    <li data-nav-id="/docs/artifacts/misc/" class="dd-item
        ">
      <div>
      <a href="/docs/artifacts/misc/">Miscelaneous Artifacts</a>
      </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/docs/presentations/" class="dd-item haschildren
        ">
      <div>
      <a href="/docs/presentations/">Presentations and Workshops</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/docs/presentations/comfycon.2020/" class="dd-item
        ">
      <div>
      <a href="/docs/presentations/comfycon.2020/">Comfycon 2020</a>
      </div>
    </li>
    <li data-nav-id="/docs/presentations/training_2020/" class="dd-item
        ">
      <div>
      <a href="/docs/presentations/training_2020/">Enterprise Hunting and Incident Response with Velociraptor 2020</a>
      </div>
    </li>
    <li data-nav-id="/docs/presentations/linux.conf.au.2020/" class="dd-item
        ">
      <div>
      <a href="/docs/presentations/linux.conf.au.2020/">Linux.Conf.Au 2020</a>
      </div>
    </li>
    <li data-nav-id="/docs/presentations/sans_dfir_summit2019/" class="dd-item
        ">
      <div>
      <a href="/docs/presentations/sans_dfir_summit2019/">SANS Summit 2019</a>
      </div>
    </li>
    <li data-nav-id="/docs/presentations/rsa/" class="dd-item
        ">
      <div>
      <a href="/docs/presentations/rsa/">RSA Asia Pacific and Japan 2019</a>
      </div>
    </li>
    <li data-nav-id="/docs/presentations/crikeycon2019/" class="dd-item
        ">
      <div>
      <a href="/docs/presentations/crikeycon2019/">Crikeycon 2019 Training Workshop</a>
      </div>
    </li>
    <li data-nav-id="/docs/presentations/nzitf2018/" class="dd-item
        ">
      <div>
      <a href="/docs/presentations/nzitf2018/">New Zealand Internet Task Force Conference 2018</a>
      </div>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li data-nav-id="/blog/" class="dd-item haschildren
        ">
      <div>
      <a href="/blog/">Velociraptor Blog</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/blog/medium/2020-08-16-profiling-the-beast-58913437fd16/" class="dd-item">
        <div>
          <a href="/blog/medium/2020-08-16-profiling-the-beast-58913437fd16/">
            Profiling the beast
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/medium/2020-07-14-triage-with-velociraptor-pt-4-cf0e60810d1e/" class="dd-item">
        <div>
          <a href="/blog/medium/2020-07-14-triage-with-velociraptor-pt-4-cf0e60810d1e/">
            Triage with Velociraptor — Pt 4
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/medium/2020-07-13-velociraptor-in-the-tool-age-d896dfe71b9/" class="dd-item">
        <div>
          <a href="/blog/medium/2020-07-13-velociraptor-in-the-tool-age-d896dfe71b9/">
            Velociraptor in the tool age
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/medium/2020-06-19-the-velociraptor-query-language-pt-2-fe92bb7aa150/" class="dd-item">
        <div>
          <a href="/blog/medium/2020-06-19-the-velociraptor-query-language-pt-2-fe92bb7aa150/">
            The Velociraptor Query Language Pt 2
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/medium/2020-06-14-the-velociraptor-query-language-pt-1-d721bff100bf/" class="dd-item">
        <div>
          <a href="/blog/medium/2020-06-14-the-velociraptor-query-language-pt-1-d721bff100bf/">
            The Velociraptor Query Language Pt 1
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/medium/2020-04-16-velociraptor-e48a47e0317d/" class="dd-item">
        <div>
          <a href="/blog/medium/2020-04-16-velociraptor-e48a47e0317d/">
            Velociraptor
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/medium/2020-03-29-velociraptors-acl-model-7f497575daee/" class="dd-item">
        <div>
          <a href="/blog/medium/2020-03-29-velociraptors-acl-model-7f497575daee/">
            Velociraptor’s ACL model
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/medium/2020-03-28-velociraptor-notebooks-d02e0bd11230/" class="dd-item">
        <div>
          <a href="/blog/medium/2020-03-28-velociraptor-notebooks-d02e0bd11230/">
            Velociraptor notebooks
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/medium/2020-03-07-extending-vql-plugins-7fb004cb6ec4/" class="dd-item">
        <div>
          <a href="/blog/medium/2020-03-07-extending-vql-plugins-7fb004cb6ec4/">
            Extending VQL plugins
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/medium/2020-03-06-velociraptor-post-processing-with-jupyter-notebook-and-pandas-8a344d05ee8c/" class="dd-item">
        <div>
          <a href="/blog/medium/2020-03-06-velociraptor-post-processing-with-jupyter-notebook-and-pandas-8a344d05ee8c/">
            Velociraptor Post-processing with Jupyter Notebook and Pandas
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/medium/2020-01-12_hunting-malware-using-mutants-ea08e86dfc19/" class="dd-item">
        <div>
          <a href="/blog/medium/2020-01-12_hunting-malware-using-mutants-ea08e86dfc19/">
            Hunting Malware using Mutants
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/medium/2019-12-31_digging-into-the-system-resource-usage-monitor-srum-afbadb1a375/" class="dd-item">
        <div>
          <a href="/blog/medium/2019-12-31_digging-into-the-system-resource-usage-monitor-srum-afbadb1a375/">
            Digging into the System Resource Usage Monitor (SRUM)
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/medium/2019-12-08-velociraptor-to-elasticsearch-3a9fc02c6568/" class="dd-item">
        <div>
          <a href="/blog/medium/2019-12-08-velociraptor-to-elasticsearch-3a9fc02c6568/">
            Velociraptor to Elasticsearch
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/medium/2019-11-15_recovering-deleted-ntfs-files-with-velociraptor-1fcf09855311/" class="dd-item">
        <div>
          <a href="/blog/medium/2019-11-15_recovering-deleted-ntfs-files-with-velociraptor-1fcf09855311/">
            Recovering deleted NTFS Files with Velociraptor
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/medium/2019-11-12_windows-event-logs-d8d8e615c9ca/" class="dd-item">
        <div>
          <a href="/blog/medium/2019-11-12_windows-event-logs-d8d8e615c9ca/">
            Windows Event Logs
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/medium/2019-10-08_triage-with-velociraptor-pt-3-d6f63215f579/" class="dd-item">
        <div>
          <a href="/blog/medium/2019-10-08_triage-with-velociraptor-pt-3-d6f63215f579/">
            Triage with Velociraptor — Pt 3
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/medium/2019-10-04_triage-with-velociraptor-pt-2-d0f79066ca0e/" class="dd-item">
        <div>
          <a href="/blog/medium/2019-10-04_triage-with-velociraptor-pt-2-d0f79066ca0e/">
            Triage with Velociraptor — Pt 2
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/medium/2019-10-02_triage-with-velociraptor-pt-1-253f57ce96c0/" class="dd-item">
        <div>
          <a href="/blog/medium/2019-10-02_triage-with-velociraptor-pt-1-253f57ce96c0/">
            Triage with Velociraptor — Pt 1
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/medium/2019-09-11_velociraptor-s-client-side-buffer-3ce03697a4e6/" class="dd-item">
        <div>
          <a href="/blog/medium/2019-09-11_velociraptor-s-client-side-buffer-3ce03697a4e6/">
            Velociraptor’s client side buffer
          </a>
        </div>
    </li>
        </ul>
    </li>




    <hr />
    <li></li>

    </ul>

 <section id="footer">
    </section>
  </div>
</nav>



<section id="body">
<div id="overlay"></div>
<div class="padding highlightable">

  <div id="top-bar">
    <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
        <span id="sidebar-toggle-span">
          <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
            <i class="fa fa-bars"></i>
          </a>
        </span>
        <span id="toc-menu"><i class="fa fa-list-alt"></i></span>
        <span class="links">
        










 <a href='/'>Velociraptor / Dig deeper</a> > <a href='/docs/'>Velociraptor Documentation</a> > <a href='/docs/vql_reference/'>VQL Reference</a> > Event Plugins








        </span>
    </div>

    
    <div class="progress">
        <div class="wrapper">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#clock">clock</a>
      <ul>
        <li><a href="#example">Example</a></li>
      </ul>
    </li>
    <li><a href="#diff">diff</a>
      <ul>
        <li><a href="#example-1">Example</a></li>
      </ul>
    </li>
    <li><a href="#fifo">fifo</a>
      <ul>
        <li><a href="#example-2">Example</a></li>
      </ul>
    </li>
    <li><a href="#watch_auditd">watch_auditd</a></li>
    <li><a href="#watch_csv">watch_csv</a></li>
    <li><a href="#watch_evtx">watch_evtx</a></li>
    <li><a href="#watch_monitoring">watch_monitoring</a></li>
    <li><a href="#watch_syslog">watch_syslog</a></li>
    <li><a href="#wmi_events">wmi_events</a></li>
  </ul>
</nav>
        </div>
    </div>
    

  </div>


<div id="body-inner">
  
      <h1>Event Plugins</h1>
      
  



    
    
    

<p>VQL Event plugins are plugins which never terminate - but instead
generate rows based on events. Event plugins are useful for creating
client monitoring artifacts. Currently, client side monitoring
artifacts are specified in the <code>Events</code> section of the server
configuration file. When clients connect to the server, they receive a
list of monitoring artifacts they are to run. The client runs all
artifacts in parallel and their results are streamed to the server.</p>
<h2 id="clock">clock</h2>
<p><span class='vql_type pull-right'>Plugin</span></p>
<p>Generate a timestamp periodically. This is mostly useful for event
queries.</p>
<p>This plugin generates events periodically. The periodicity can be
controlled either via the <code>period</code> or the <code>ms</code> parameter. Each row
will be a go <a href="https://golang.org/pkg/time/#Time">time.Time</a>
object. You can access its unix epoch time with the Sec column.</p>
<h3 id="example">Example</h3>
<p>The following will generate an event every 10 seconds.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SELECT</span> Sec <span style="color:#66d9ef">FROM</span> clock(period<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>)
</code></pre></div><p>The <code>start</code> parameter can be used to schedule the plugin to start
at a particular time. This can be an integer (which will be
interpreted as seconds since the epoch), a string or a time value.</p>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>start</td>
<td>Start at this time.</td>
<td>Any</td>
</tr>
<tr>
<td>period</td>
<td>Wait this many seconds between events.</td>
<td>int64</td>
</tr>
<tr>
<td>ms</td>
<td>Wait this many ms between events.</td>
<td>int64</td>
</tr>
</tbody>
</table>
<h2 id="diff">diff</h2>
<p><span class='vql_type pull-right'>Plugin</span></p>
<p>Executes &lsquo;query&rsquo; periodically and emit differences from the last query.</p>
<p>The <code>diff()</code> plugin runs a non-event query periodically and calculates
the difference between its result set from the last run.</p>
<p>This can be used to create event queries which watch for changes from
simpler non-event queries.</p>
<p>The <code>key</code> parameter is the name of the column which is used to
determine row equivalency.</p>
<div class="notices note" ><p>There is only a single equivalence row specified by the <code>key</code>
parameter, and it must be a string. If you need to watch multiple
columns you need to create a new column which is the concatenation of
other columns. For example <code>format(format=&quot;%s%d&quot;, args=[Name, Pid])</code></p>
</div>

<h3 id="example-1">Example</h3>
<p>The following VQL monitors all removable drives and lists files on
newly inserted drives, or files that have been added to removable
drives.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">LET removable_disks <span style="color:#f92672">=</span> <span style="color:#66d9ef">SELECT</span> Name <span style="color:#66d9ef">AS</span> Drive, <span style="color:#66d9ef">Size</span>
<span style="color:#66d9ef">FROM</span> glob(globs<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/*&#34;</span>, accessor<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;file&#34;</span>)
<span style="color:#66d9ef">WHERE</span> <span style="color:#66d9ef">Data</span>.Description <span style="color:#f92672">=~</span> <span style="color:#e6db74">&#34;Removable&#34;</span>

LET file_listing <span style="color:#f92672">=</span> <span style="color:#66d9ef">SELECT</span> FullPath, <span style="color:#66d9ef">timestamp</span>(epoch<span style="color:#f92672">=</span>Mtime.Sec) <span style="color:#66d9ef">As</span> Modified, <span style="color:#66d9ef">Size</span>
<span style="color:#66d9ef">FROM</span> glob(globs<span style="color:#f92672">=</span>Drive<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;\\**&#34;</span>, accessor<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;file&#34;</span>) <span style="color:#66d9ef">LIMIT</span> <span style="color:#ae81ff">1000</span>

<span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">FROM</span> diff(
  query<span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">{</span> <span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">FROM</span> foreach(<span style="color:#66d9ef">row</span><span style="color:#f92672">=</span>removable_disks, query<span style="color:#f92672">=</span>file_listing) <span style="color:#960050;background-color:#1e0010">}</span>,
  <span style="color:#66d9ef">key</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;FullPath&#34;</span>,
  period<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>)
  <span style="color:#66d9ef">WHERE</span> Diff <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;added&#34;</span>
</code></pre></div><table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>query</td>
<td>Source for cached rows.</td>
<td>StoredQuery (required)</td>
</tr>
<tr>
<td>key</td>
<td>The column to use as key.</td>
<td>string (required)</td>
</tr>
<tr>
<td>period</td>
<td>Number of seconds between evaluation of the query.</td>
<td>int64</td>
</tr>
</tbody>
</table>
<h2 id="fifo">fifo</h2>
<p><span class='vql_type pull-right'>Plugin</span></p>
<p>Executes &lsquo;query&rsquo; and cache a number of rows from it. For each invocation
we present the set of past rows.</p>
<p>The <code>fifo()</code> plugin allows for VQL queries to apply across historical
data. The fifo plugin accepts another event query as parameter, then
retains the last <code>max_rows</code> rows from it in an internal queue. Every
subsequent evaluation from the query will return the full set of rows
in the queue. Older rows are expired from the queue according to the
<code>max_age</code> parameter.</p>
<p>Fifos are usually used to form queries that look for specific pattern
of behavior. For example, a successful logon followed by failed
logons. In this case the fifo retains the recent history of failed
logons in its internal queue, then when a successful logon occurs we
can check the recent failed ones in its queue.</p>
<h3 id="example-2">Example</h3>
<p>The following checks for 5 failed logons followed by a successful
logon.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">LET failed_logon <span style="color:#f92672">=</span> <span style="color:#66d9ef">SELECT</span> EventData <span style="color:#66d9ef">as</span> FailedEventData,
   <span style="color:#66d9ef">System</span> <span style="color:#66d9ef">as</span> FailedSystem
<span style="color:#66d9ef">FROM</span> watch_evtx(filename<span style="color:#f92672">=</span>securityLogFile)
<span style="color:#66d9ef">WHERE</span> <span style="color:#66d9ef">System</span>.EventID.Value <span style="color:#f92672">=</span> <span style="color:#ae81ff">4625</span>

LET last_5_events <span style="color:#f92672">=</span> <span style="color:#66d9ef">SELECT</span> FailedEventData, FailedSystem
    <span style="color:#66d9ef">FROM</span> fifo(query<span style="color:#f92672">=</span>failed_logon,
              max_rows<span style="color:#f92672">=</span><span style="color:#ae81ff">500</span>,
              max_age<span style="color:#f92672">=</span>atoi(string<span style="color:#f92672">=</span>failedLogonTimeWindow))

LET success_logon <span style="color:#f92672">=</span> <span style="color:#66d9ef">SELECT</span> EventData <span style="color:#66d9ef">as</span> SuccessEventData,
   <span style="color:#66d9ef">System</span> <span style="color:#66d9ef">as</span> SuccessSystem
<span style="color:#66d9ef">FROM</span> watch_evtx(filename<span style="color:#f92672">=</span>securityLogFile)
<span style="color:#66d9ef">WHERE</span> <span style="color:#66d9ef">System</span>.EventID.Value <span style="color:#f92672">=</span> <span style="color:#ae81ff">4624</span>

<span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">FROM</span> foreach(
  <span style="color:#66d9ef">row</span><span style="color:#f92672">=</span>success_logon,
  query<span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">{</span>
   <span style="color:#66d9ef">SELECT</span> SuccessSystem.TimeCreated.SystemTime <span style="color:#66d9ef">AS</span> LogonTime,
          SuccessSystem, SuccessEventData,
          enumerate(items<span style="color:#f92672">=</span>FailedEventData) <span style="color:#66d9ef">as</span> FailedEventData,
          FailedSystem, <span style="color:#66d9ef">count</span>(items<span style="color:#f92672">=</span>SuccessSystem) <span style="color:#66d9ef">as</span> <span style="color:#66d9ef">Count</span>
   <span style="color:#66d9ef">FROM</span> last_5_events
   <span style="color:#66d9ef">WHERE</span> FailedEventData.SubjectUserName <span style="color:#f92672">=</span> SuccessEventData.SubjectUserName
   <span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> LogonTime
      <span style="color:#960050;background-color:#1e0010">}</span>)  <span style="color:#66d9ef">WHERE</span> <span style="color:#66d9ef">Count</span> <span style="color:#f92672">&gt;</span> atoi(string<span style="color:#f92672">=</span>failureCount)
</code></pre></div><table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>query</td>
<td>Source for cached rows.</td>
<td>StoredQuery (required)</td>
</tr>
<tr>
<td>max_age</td>
<td>Maximum number of seconds to hold rows in the fifo.</td>
<td>int64</td>
</tr>
<tr>
<td>max_rows</td>
<td>Maximum number of rows to hold in the fifo.</td>
<td>int64</td>
</tr>
</tbody>
</table>
<h2 id="watch_auditd">watch_auditd</h2>
<p><span class='vql_type pull-right'>Plugin</span></p>
<p>Watch log files generated by auditd.</p>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>filename</td>
<td>A list of log files to parse.</td>
<td>list of string (required)</td>
</tr>
<tr>
<td>accessor</td>
<td>The accessor to use.</td>
<td>string</td>
</tr>
</tbody>
</table>
<h2 id="watch_csv">watch_csv</h2>
<p><span class='vql_type pull-right'>Plugin</span></p>
<p>Watch a CSV file and stream events from it. Note: This is an event
plugin which does not complete.</p>
<p>This plugin is the event version of <code>parse_csv()</code>. When the CSV file
grows this plugin will emit the new rows.</p>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>filename</td>
<td>CSV files to open</td>
<td>list of string (required)</td>
</tr>
<tr>
<td>accessor</td>
<td>The accessor to use</td>
<td>string</td>
</tr>
</tbody>
</table>
<h2 id="watch_evtx">watch_evtx</h2>
<p><span class='vql_type pull-right'>Plugin</span></p>
<p>Watch an EVTX file and stream events from it.</p>
<p>This is the Event plugin version of <code>parse_evtx()</code>.</p>
<div class="notices note" ><p>It often takes several seconds for events to be flushed to the event
log and so this plugin&rsquo;s event may be delayed. For some applications
this results in a race condition with the event itself - for example,
files mentioned in the event may already be removed by the time the
event is triggered.</p>
</div>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>filename</td>
<td>A list of event log files to parse.</td>
<td>list of string (required)</td>
</tr>
<tr>
<td>accessor</td>
<td>The accessor to use.</td>
<td>string</td>
</tr>
<tr>
<td>messagedb</td>
<td>A Message database from <a href="https://github.com/Velocidex/evtx-data">https://github.com/Velocidex/evtx-data</a>.</td>
<td>string</td>
</tr>
</tbody>
</table>
<h2 id="watch_monitoring">watch_monitoring</h2>
<p><span class='vql_type pull-right'>Plugin</span></p>
<p>Watch clients&rsquo; monitoring log. This is an event plugin. This
plugin will produce events from all clients.</p>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>artifact</td>
<td>The event artifact name to watch</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<h2 id="watch_syslog">watch_syslog</h2>
<p><span class='vql_type pull-right'>Plugin</span></p>
<p>Watch a syslog file and stream events from it.</p>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>filename</td>
<td>A list of log files to parse.</td>
<td>list of string (required)</td>
</tr>
<tr>
<td>accessor</td>
<td>The accessor to use.</td>
<td>string</td>
</tr>
</tbody>
</table>
<h2 id="wmi_events">wmi_events</h2>
<p><span class='vql_type pull-right'>Plugin</span></p>
<p>Executes an evented WMI queries asynchronously.</p>
<p>This plugin sets up a <a href="https://docs.microsoft.com/en-us/windows/desktop/wmisdk/receiving-a-wmi-event">WMI event</a> listener query.</p>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>query</td>
<td>WMI query to run.</td>
<td>string (required)</td>
</tr>
<tr>
<td>namespace</td>
<td>WMI namespace</td>
<td>string (required)</td>
</tr>
<tr>
<td>wait</td>
<td>Wait this many seconds for events and then quit.</td>
<td>int64 (required)</td>
</tr>
</tbody>
</table>



    
    
          <footer class=" footline" >
	
</footer>
  </div>
</div>

<div id="navigation">
<a class="nav nav-prev" href="/docs/vql_reference/plugin/" title="Client Side Functionality"> <i class="fa fa-chevron-left"></i><label>Client Side Functionality</label></a>
    <a class="nav nav-next" href="/docs/vql_reference/experimental/" title="Experimental Functionality" style="margin-right: 0px;"><label>Experimental Functionality</label><i class="fa fa-chevron-right"></i></a></div>

</section>
<div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
  <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
</div>    

<script src="/js/clipboard.min.js"></script>
<script src="/js/featherlight.min.js"></script>
<script src="/js/html5shiv-printshiv.min.js"></script>

<script src="/js/modernizr.custom.71422.js"></script>
<script src="/js/docdock.js"></script>
<script src="/theme-original/script.js"></script>


    

    
    

    
  </body>
</html>