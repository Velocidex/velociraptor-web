<!DOCTYPE html>
<html>
  <head>
    <title>Velociraptor / Dig deeper</title>
    
      <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>Basic VQL functions and plugins :: Velociraptor / Dig deeper</title>
<link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon" />
<link rel="stylesheet" href="/css/bootstrap.min.css">
<link href="/css/nucleus.css" rel="stylesheet">
<link href="/css/font-awesome.min.css" rel="stylesheet">
<link href="/css/hybrid.css" rel="stylesheet">
<link href="/css/featherlight.min.css" rel="stylesheet">
<link href="/css/auto-complete.css" rel="stylesheet">
<link href="/theme-original/style.css" rel="stylesheet">

  <link href="/theme-original/variant-mine.css" rel="stylesheet">


<script src="/js/jquery-2.x.min.js"></script>
<style type="text/css">
  :root #header + #content > #left > #rlblock_left {
    display:none !important;
  }
</style>
<link rel="stylesheet" href="/css/theme-mine.css">
<script src="/js/custom.js"></script>


    
  </head>
  <body data-url="/docs/vql_reference/basic/">
    
      <div id="headermain"></div>
<nav id="sidebar" class="">



<div class="highlightable">
  <div id="header-wrapper">
    <div id="header">
      
	
  
    <a href="/">
  <img src="/images/logo.svg">
</a>

  


    </div>
        <div class="searchbox">
                    <label for="search-by"><i class="fa fa-search"></i></label>
                    <input data-search-input id="search-by" type="text" placeholder="Search...">
                    <span data-search-clear=""><i class="fa fa-close"></i></span>
                </div>
                <script type="text/javascript" src="/js/lunr.min.js"></script>
                <script type="text/javascript" src="/js/auto-complete.js"></script>
                <script type="text/javascript">
        
            var baseurl = "\/";
        
                </script>
                <script type="text/javascript" src="/js/search.js"></script>
  </div>

      <ul class="topics">
    <li data-nav-id="/about/" class="dd-item haschildren
        ">
      <div>
      <a href="/about/">About Velociraptor</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/about/features/" class="dd-item">
        <div>
          <a href="/about/features/">
            Velociraptor Features
          </a>
        </div>
    </li>
      <li data-nav-id="/about/license/" class="dd-item">
        <div>
          <a href="/about/license/">
            License
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/docs/" class="dd-item parent haschildren
        ">
      <div>
      <a href="/docs/">Velociraptor Documentation</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/docs/getting-started/" class="dd-item haschildren
        ">
      <div>
      <a href="/docs/getting-started/">Getting Started</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/docs/getting-started/stand_alone/" class="dd-item
        ">
      <div>
      <a href="/docs/getting-started/stand_alone/">Standalone Deployment</a>
      </div>
    </li>
    <li data-nav-id="/docs/getting-started/deploying_clients/" class="dd-item
        ">
      <div>
      <a href="/docs/getting-started/deploying_clients/">Deploying Clients</a>
      </div>
    </li>
    <li data-nav-id="/docs/getting-started/cloud/" class="dd-item
        ">
      <div>
      <a href="/docs/getting-started/cloud/">Deploying in the cloud</a>
      </div>
    </li>
    <li data-nav-id="/docs/getting-started/performance/" class="dd-item
        ">
      <div>
      <a href="/docs/getting-started/performance/">Performance</a>
      </div>
    </li>
    <li data-nav-id="/docs/getting-started/triaging/" class="dd-item
        ">
      <div>
      <a href="/docs/getting-started/triaging/">Triaging</a>
      </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/docs/user-interface/" class="dd-item haschildren
        ">
      <div>
      <a href="/docs/user-interface/">User Interface</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/docs/user-interface/investigating_clients/" class="dd-item haschildren
        ">
      <div>
      <a href="/docs/user-interface/investigating_clients/">Investigating Clients</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/docs/user-interface/investigating_clients/searching_clients/" class="dd-item
        ">
      <div>
      <a href="/docs/user-interface/investigating_clients/searching_clients/">Searching for clients</a>
      </div>
    </li>
    <li data-nav-id="/docs/user-interface/investigating_clients/virtual_filesystem/" class="dd-item
        ">
      <div>
      <a href="/docs/user-interface/investigating_clients/virtual_filesystem/">The Virtual File System</a>
      </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/docs/user-interface/artifacts/" class="dd-item haschildren
        ">
      <div>
      <a href="/docs/user-interface/artifacts/">Velociraptor Artifacts</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/docs/user-interface/artifacts/client_artifacts/" class="dd-item
        ">
      <div>
      <a href="/docs/user-interface/artifacts/client_artifacts/">Client Artifacts</a>
      </div>
    </li>
    <li data-nav-id="/docs/user-interface/artifacts/client_events/" class="dd-item
        ">
      <div>
      <a href="/docs/user-interface/artifacts/client_events/">Client Event Artifacts</a>
      </div>
    </li>
    <li data-nav-id="/docs/user-interface/artifacts/server_artifacts/" class="dd-item
        ">
      <div>
      <a href="/docs/user-interface/artifacts/server_artifacts/">Server Artifacts</a>
      </div>
    </li>
    <li data-nav-id="/docs/user-interface/artifacts/server_events/" class="dd-item
        ">
      <div>
      <a href="/docs/user-interface/artifacts/server_events/">Server Event Artifacts</a>
      </div>
    </li>
    <li data-nav-id="/docs/user-interface/artifacts/add_artifacts/" class="dd-item
        ">
      <div>
      <a href="/docs/user-interface/artifacts/add_artifacts/">Customizing Artifacts</a>
      </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/docs/user-interface/api/" class="dd-item
        ">
      <div>
      <a href="/docs/user-interface/api/">The Velociraptor API</a>
      </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/docs/vql_reference/" class="dd-item parent haschildren
        ">
      <div>
      <a href="/docs/vql_reference/">VQL Reference</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/docs/vql_reference/basic/" class="dd-item active
        ">
      <div>
      <a href="/docs/vql_reference/basic/">Basic VQL functions and plugins</a>
      </div>
    </li>
    <li data-nav-id="/docs/vql_reference/windows/" class="dd-item
        ">
      <div>
      <a href="/docs/vql_reference/windows/">Windows Specific Functionality</a>
      </div>
    </li>
    <li data-nav-id="/docs/vql_reference/parsers/" class="dd-item
        ">
      <div>
      <a href="/docs/vql_reference/parsers/">Parsers and data extractors</a>
      </div>
    </li>
    <li data-nav-id="/docs/vql_reference/server/" class="dd-item
        ">
      <div>
      <a href="/docs/vql_reference/server/">Server Side Functionality</a>
      </div>
    </li>
    <li data-nav-id="/docs/vql_reference/plugin/" class="dd-item
        ">
      <div>
      <a href="/docs/vql_reference/plugin/">Client Side Functionality</a>
      </div>
    </li>
    <li data-nav-id="/docs/vql_reference/event/" class="dd-item
        ">
      <div>
      <a href="/docs/vql_reference/event/">Event Plugins</a>
      </div>
    </li>
    <li data-nav-id="/docs/vql_reference/experimental/" class="dd-item
        ">
      <div>
      <a href="/docs/vql_reference/experimental/">Experimental Functionality</a>
      </div>
    </li>
    <li data-nav-id="/docs/vql_reference/filesystem_accessors/" class="dd-item
        ">
      <div>
      <a href="/docs/vql_reference/filesystem_accessors/">Filesystem Accessors</a>
      </div>
    </li>
    <li data-nav-id="/docs/vql_reference/templates/" class="dd-item
        ">
      <div>
      <a href="/docs/vql_reference/templates/">Report Templates</a>
      </div>
    </li>
    <li data-nav-id="/docs/vql_reference/tips/" class="dd-item
        ">
      <div>
      <a href="/docs/vql_reference/tips/">Artifact Tips</a>
      </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/docs/artifacts/" class="dd-item haschildren
        ">
      <div>
      <a href="/docs/artifacts/">Artifact Reference</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/docs/artifacts/linux/" class="dd-item
        ">
      <div>
      <a href="/docs/artifacts/linux/">Linux Artifacts</a>
      </div>
    </li>
    <li data-nav-id="/docs/artifacts/windows_system/" class="dd-item haschildren
        ">
      <div>
      <a href="/docs/artifacts/windows_system/">Windows</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/docs/artifacts/windows_system/events/" class="dd-item
        ">
      <div>
      <a href="/docs/artifacts/windows_system/events/">Event Logs</a>
      </div>
    </li>
    <li data-nav-id="/docs/artifacts/windows_system/system/" class="dd-item
        ">
      <div>
      <a href="/docs/artifacts/windows_system/system/">System</a>
      </div>
    </li>
    <li data-nav-id="/docs/artifacts/windows_system/registry/" class="dd-item
        ">
      <div>
      <a href="/docs/artifacts/windows_system/registry/">Registry</a>
      </div>
    </li>
    <li data-nav-id="/docs/artifacts/windows_system/network/" class="dd-item
        ">
      <div>
      <a href="/docs/artifacts/windows_system/network/">Network</a>
      </div>
    </li>
    <li data-nav-id="/docs/artifacts/windows_system/applications/" class="dd-item
        ">
      <div>
      <a href="/docs/artifacts/windows_system/applications/">Applications</a>
      </div>
    </li>
    <li data-nav-id="/docs/artifacts/windows_system/detection/" class="dd-item
        ">
      <div>
      <a href="/docs/artifacts/windows_system/detection/">Malware Detection</a>
      </div>
    </li>
    <li data-nav-id="/docs/artifacts/windows_system/triage/" class="dd-item
        ">
      <div>
      <a href="/docs/artifacts/windows_system/triage/">Triage Artifacts</a>
      </div>
    </li>
    <li data-nav-id="/docs/artifacts/windows_system/remediation/" class="dd-item
        ">
      <div>
      <a href="/docs/artifacts/windows_system/remediation/">Remdiation</a>
      </div>
    </li>
    <li data-nav-id="/docs/artifacts/windows_system/monitoring/" class="dd-item
        ">
      <div>
      <a href="/docs/artifacts/windows_system/monitoring/">Event Monitoring</a>
      </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/docs/artifacts/server/" class="dd-item
        ">
      <div>
      <a href="/docs/artifacts/server/">Server Artifacts</a>
      </div>
    </li>
    <li data-nav-id="/docs/artifacts/misc/" class="dd-item
        ">
      <div>
      <a href="/docs/artifacts/misc/">Miscelaneous Artifacts</a>
      </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/docs/presentations/" class="dd-item haschildren
        ">
      <div>
      <a href="/docs/presentations/">Presentations and Workshops</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/docs/presentations/training_2020/" class="dd-item
        ">
      <div>
      <a href="/docs/presentations/training_2020/">Enterprise Hunting and Incident Response with Velociraptor 2020</a>
      </div>
    </li>
    <li data-nav-id="/docs/presentations/linux.conf.au.2020/" class="dd-item
        ">
      <div>
      <a href="/docs/presentations/linux.conf.au.2020/">Linux.Conf.Au 2020</a>
      </div>
    </li>
    <li data-nav-id="/docs/presentations/sans_dfir_summit2019/" class="dd-item
        ">
      <div>
      <a href="/docs/presentations/sans_dfir_summit2019/">SANS Summit 2019</a>
      </div>
    </li>
    <li data-nav-id="/docs/presentations/rsa/" class="dd-item
        ">
      <div>
      <a href="/docs/presentations/rsa/">RSA Asia Pacific and Japan 2019</a>
      </div>
    </li>
    <li data-nav-id="/docs/presentations/crikeycon2019/" class="dd-item
        ">
      <div>
      <a href="/docs/presentations/crikeycon2019/">Crikeycon 2019 Training Workshop</a>
      </div>
    </li>
    <li data-nav-id="/docs/presentations/nzitf2018/" class="dd-item
        ">
      <div>
      <a href="/docs/presentations/nzitf2018/">New Zealand Internet Task Force Conference 2018</a>
      </div>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li data-nav-id="/blog/" class="dd-item haschildren
        ">
      <div>
      <a href="/blog/">Velociraptor Blog</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/blog/medium/2020-04-16-velociraptor-e48a47e0317d/" class="dd-item">
        <div>
          <a href="/blog/medium/2020-04-16-velociraptor-e48a47e0317d/">
            Velociraptor
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/medium/2020-03-29-velociraptors-acl-model-7f497575daee/" class="dd-item">
        <div>
          <a href="/blog/medium/2020-03-29-velociraptors-acl-model-7f497575daee/">
            Velociraptor’s ACL model
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/medium/2020-03-28-velociraptor-notebooks-d02e0bd11230/" class="dd-item">
        <div>
          <a href="/blog/medium/2020-03-28-velociraptor-notebooks-d02e0bd11230/">
            Velociraptor notebooks
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/medium/2020-03-07-extending-vql-plugins-7fb004cb6ec4/" class="dd-item">
        <div>
          <a href="/blog/medium/2020-03-07-extending-vql-plugins-7fb004cb6ec4/">
            Extending VQL plugins
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/medium/2020-03-06-velociraptor-post-processing-with-jupyter-notebook-and-pandas-8a344d05ee8c/" class="dd-item">
        <div>
          <a href="/blog/medium/2020-03-06-velociraptor-post-processing-with-jupyter-notebook-and-pandas-8a344d05ee8c/">
            Velociraptor Post-processing with Jupyter Notebook and Pandas
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/medium/2020-01-12_hunting-malware-using-mutants-ea08e86dfc19/" class="dd-item">
        <div>
          <a href="/blog/medium/2020-01-12_hunting-malware-using-mutants-ea08e86dfc19/">
            Hunting Malware using Mutants
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/medium/2019-12-31_digging-into-the-system-resource-usage-monitor-srum-afbadb1a375/" class="dd-item">
        <div>
          <a href="/blog/medium/2019-12-31_digging-into-the-system-resource-usage-monitor-srum-afbadb1a375/">
            Digging into the System Resource Usage Monitor (SRUM)
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/medium/2019-12-08-velociraptor-to-elasticsearch-3a9fc02c6568/" class="dd-item">
        <div>
          <a href="/blog/medium/2019-12-08-velociraptor-to-elasticsearch-3a9fc02c6568/">
            Velociraptor to Elasticsearch
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/medium/2019-11-15_recovering-deleted-ntfs-files-with-velociraptor-1fcf09855311/" class="dd-item">
        <div>
          <a href="/blog/medium/2019-11-15_recovering-deleted-ntfs-files-with-velociraptor-1fcf09855311/">
            Recovering deleted NTFS Files with Velociraptor
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/medium/2019-11-12_windows-event-logs-d8d8e615c9ca/" class="dd-item">
        <div>
          <a href="/blog/medium/2019-11-12_windows-event-logs-d8d8e615c9ca/">
            Windows Event Logs
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/medium/2019-10-08_triage-with-velociraptor-pt-3-d6f63215f579/" class="dd-item">
        <div>
          <a href="/blog/medium/2019-10-08_triage-with-velociraptor-pt-3-d6f63215f579/">
            Triage with Velociraptor — Pt 3
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/medium/2019-10-04_triage-with-velociraptor-pt-2-d0f79066ca0e/" class="dd-item">
        <div>
          <a href="/blog/medium/2019-10-04_triage-with-velociraptor-pt-2-d0f79066ca0e/">
            Triage with Velociraptor — Pt 2
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/medium/2019-10-02_triage-with-velociraptor-pt-1-253f57ce96c0/" class="dd-item">
        <div>
          <a href="/blog/medium/2019-10-02_triage-with-velociraptor-pt-1-253f57ce96c0/">
            Triage with Velociraptor — Pt 1
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/medium/2019-09-11_velociraptor-s-client-side-buffer-3ce03697a4e6/" class="dd-item">
        <div>
          <a href="/blog/medium/2019-09-11_velociraptor-s-client-side-buffer-3ce03697a4e6/">
            Velociraptor’s client side buffer
          </a>
        </div>
    </li>
        </ul>
    </li>




    <hr />
    <li></li>

    </ul>

 <section id="footer">
    </section>
  </div>
</nav>



<section id="body">
<div id="overlay"></div>
<div class="padding highlightable">

  <div id="top-bar">
    <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
        <span id="sidebar-toggle-span">
          <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
            <i class="fa fa-bars"></i>
          </a>
        </span>
        <span id="toc-menu"><i class="fa fa-list-alt"></i></span>
        <span class="links">
        










 <a href='/'>Velociraptor / Dig deeper</a> > <a href='/docs/'>Velociraptor Documentation</a> > <a href='/docs/vql_reference/'>VQL Reference</a> > Basic VQL functions and plugins








        </span>
    </div>

    
    <div class="progress">
        <div class="wrapper">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#array">array</a></li>
    <li><a href="#atoi">atoi</a></li>
    <li><a href="#base64decode">base64decode</a></li>
    <li><a href="#base64encode">base64encode</a></li>
    <li><a href="#basename">basename</a></li>
    <li><a href="#copy">copy</a></li>
    <li><a href="#count">count</a></li>
    <li><a href="#dict">dict</a></li>
    <li><a href="#dirname">dirname</a></li>
    <li><a href="#encode">encode</a></li>
    <li><a href="#enumerate">enumerate</a></li>
    <li><a href="#environ">environ</a></li>
    <li><a href="#expand">expand</a></li>
    <li><a href="#filter">filter</a></li>
    <li><a href="#format">format</a></li>
    <li><a href="#get">get</a>
      <ul>
        <li><a href="#example">Example</a></li>
      </ul>
    </li>
    <li><a href="#getpid">getpid</a></li>
    <li><a href="#humanize">humanize</a></li>
    <li><a href="#if">if</a></li>
    <li><a href="#join">join</a></li>
    <li><a href="#len">len</a></li>
    <li><a href="#log">log</a></li>
    <li><a href="#lowcase">lowcase</a></li>
    <li><a href="#max">max</a>
      <ul>
        <li><a href="#example-1">Example</a></li>
      </ul>
    </li>
    <li><a href="#min">min</a>
      <ul>
        <li><a href="#example-2">Example</a></li>
      </ul>
    </li>
    <li><a href="#now">now</a></li>
    <li><a href="#path_join">path_join</a></li>
    <li><a href="#query">query</a></li>
    <li><a href="#rand">rand</a></li>
    <li><a href="#read_file">read_file</a></li>
    <li><a href="#scope">scope</a></li>
    <li><a href="#serialize">serialize</a></li>
    <li><a href="#sleep">sleep</a></li>
    <li><a href="#split">split</a></li>
    <li><a href="#str">str</a></li>
    <li><a href="#strip">strip</a></li>
    <li><a href="#timestamp">timestamp</a></li>
    <li><a href="#upcase">upcase</a></li>
    <li><a href="#url">url</a></li>
    <li><a href="#utf16">utf16</a></li>
    <li><a href="#utf16_encode">utf16_encode</a></li>
  </ul>
</nav>
        </div>
    </div>
    

  </div>


<div id="body-inner">
  
      <h1>Basic VQL functions and plugins</h1>
      
  



    
    
    

<p>VQL provides a basic set of functions and plugins allowing
queries to maniulate data and implement logic. This page details
those plugins which are considered foundational to the VQL
language and therefore may be useful in all types of artifacts.</p>
<div class="notices note" ><p>VQL plugins are not the same as VQL functions. A plugin is the subject
of the VQL query - i.e. plugins always follow the <code>FROM</code> keyword,
while functions (which return a single value instead of a sequence of
rows) are only present in column specification (e.g. after <code>SELECT</code>)
or in condition clauses (i.e. after the <code>WHERE</code> keyword).</p>
</div>

<h2 id="array">array</h2>
<p><span class='vql_type pull-right'>Function</span></p>
<p>Create an array with all the args.</p>
<p>This function accepts arbitrary arguments and creates an array by
flattening the arguments. For example <code>array(a=1, b=2)</code> will return
<code>[1, 2]</code>.</p>
<p>You can use this to flatten a subquery as well:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SELECT</span> array(a1<span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">{</span> <span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">User</span> <span style="color:#66d9ef">FROM</span> Artifact.Windows.<span style="color:#66d9ef">System</span>.Users() <span style="color:#960050;background-color:#1e0010">}</span>) <span style="color:#66d9ef">as</span> Users <span style="color:#66d9ef">FROM</span> <span style="color:#66d9ef">scope</span>()
</code></pre></div><p>Will return a single row with Users being an array of names.</p>
<h2 id="atoi">atoi</h2>
<p><span class='vql_type pull-right'>Function</span></p>
<p>Convert a string to an int.</p>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>string</td>
<td>A string to convert to int</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<h2 id="base64decode">base64decode</h2>
<p><span class='vql_type pull-right'>Function</span></p>
<p>Decodes a base64 encoded string.</p>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>string</td>
<td>A string to decode</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<h2 id="base64encode">base64encode</h2>
<p><span class='vql_type pull-right'>Function</span></p>
<p>Encodes a string into base64.</p>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>string</td>
<td>A string to decode</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<h2 id="basename">basename</h2>
<p><span class='vql_type pull-right'>Function</span></p>
<p>Return the basename of the path.</p>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>path</td>
<td>Extract directory name of path</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<h2 id="copy">copy</h2>
<p><span class='vql_type pull-right'>Function</span></p>
<p>Copy a file.</p>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>filename</td>
<td>The file to copy from.</td>
<td>string (required)</td>
</tr>
<tr>
<td>accessor</td>
<td>The accessor to use</td>
<td>string</td>
</tr>
<tr>
<td>dest</td>
<td>The destination file to write.</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<h2 id="count">count</h2>
<p><span class='vql_type pull-right'>Function</span></p>
<p>Counts the items.</p>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>items</td>
<td></td>
<td>Any (required)</td>
</tr>
</tbody>
</table>
<h2 id="dict">dict</h2>
<p><span class='vql_type pull-right'>Function</span></p>
<p>Construct a dict from arbitrary keyword args.</p>
<h2 id="dirname">dirname</h2>
<p><span class='vql_type pull-right'>Function</span></p>
<p>Return the directory path.</p>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>path</td>
<td>Extract directory name of path</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<h2 id="encode">encode</h2>
<p><span class='vql_type pull-right'>Function</span></p>
<p>Encodes a string as as different type. Currently supported types include &lsquo;hex&rsquo;, &lsquo;base64&rsquo;.</p>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>string</td>
<td></td>
<td>Any (required)</td>
</tr>
<tr>
<td>type</td>
<td></td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<h2 id="enumerate">enumerate</h2>
<p><span class='vql_type pull-right'>Function</span></p>
<p>Collect all the items in each group by bin.</p>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>items</td>
<td></td>
<td>Any (required)</td>
</tr>
</tbody>
</table>
<h2 id="environ">environ</h2>
<p><span class='vql_type pull-right'>Function</span></p>
<p>Get an environment variable.</p>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>var</td>
<td>Extract the var from the environment.</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<h2 id="expand">expand</h2>
<p><span class='vql_type pull-right'>Function</span></p>
<p>Expand the path using the environment.</p>
<p>This function expands environment variables into the path. It is
normally needed after using registry values of type REG_EXPAND_SZ as
they typically contain environment strings. Velociraptor does not
automatically expand such values since environment variables typically
depend on the specific user account which reads the registry value
(different user accounts can have different environment variables).</p>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>path</td>
<td>A path with environment escapes</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<h2 id="filter">filter</h2>
<p><span class='vql_type pull-right'>Function</span></p>
<p>Filters a strings array by regex.</p>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>list</td>
<td>A list of items too filter</td>
<td>list of string (required)</td>
</tr>
<tr>
<td>regex</td>
<td>A regex to test each item</td>
<td>list of string (required)</td>
</tr>
</tbody>
</table>
<h2 id="format">format</h2>
<p><span class='vql_type pull-right'>Function</span></p>
<p>Format one or more items according to a format string.</p>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>format</td>
<td>Format string to use</td>
<td>string (required)</td>
</tr>
<tr>
<td>args</td>
<td>An array of elements to apply into the format string.</td>
<td>Any</td>
</tr>
</tbody>
</table>
<h2 id="get">get</h2>
<p><span class='vql_type pull-right'>Function</span></p>
<p>Gets the member field from item.</p>
<p>This is useful to index an item from an array. For example:</p>
<h3 id="example">Example</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">select</span> <span style="color:#66d9ef">get</span>(item<span style="color:#f92672">=</span>[dict(foo<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>), <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>], member<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;0.foo&#39;</span>) <span style="color:#66d9ef">AS</span> Foo <span style="color:#66d9ef">from</span> <span style="color:#66d9ef">scope</span>()

[
 <span style="color:#960050;background-color:#1e0010">{</span>
   <span style="color:#e6db74">&#34;Foo&#34;</span>: <span style="color:#ae81ff">3</span>
 <span style="color:#960050;background-color:#1e0010">}</span>
]
</code></pre></div><table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>item</td>
<td></td>
<td>Any</td>
</tr>
<tr>
<td>member</td>
<td></td>
<td>string</td>
</tr>
<tr>
<td>field</td>
<td></td>
<td>string</td>
</tr>
<tr>
<td>default</td>
<td></td>
<td>Any</td>
</tr>
</tbody>
</table>
<h2 id="getpid">getpid</h2>
<p><span class='vql_type pull-right'>Function</span></p>
<p>Returns the current pid of the process.</p>
<h2 id="humanize">humanize</h2>
<p><span class='vql_type pull-right'>Function</span></p>
<p>Format items in human readable way.</p>
<p>Formats a byte count in human readable way (e.g. Mb, Gb etc).</p>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>bytes</td>
<td>Format bytes with units</td>
<td>int64</td>
</tr>
</tbody>
</table>
<h2 id="if">if</h2>
<p><span class='vql_type pull-right'>Function</span></p>
<p>Conditional execution of query</p>
<p>This function evaluates a condition. Note that the values used in the
<code>then</code> or <code>else</code> clause are evaluated lazily. They may be expressions
that involve stored queries (i.e. queries stored using the <code>LET</code>
keyword). These queries will not be evaluated if they are not needed.</p>
<p>This allows a query to cheaply branch. For example, if a parameter is
given, then perform hash or upload to the server. See the</p>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>condition</td>
<td></td>
<td>Any (required)</td>
</tr>
<tr>
<td>then</td>
<td></td>
<td>LazyExpr (required)</td>
</tr>
<tr>
<td>else</td>
<td></td>
<td>LazyExpr</td>
</tr>
</tbody>
</table>
<h2 id="join">join</h2>
<p><span class='vql_type pull-right'>Function</span></p>
<p>Join all the args on a separator.</p>
<p>Joins the array into a string separated by the sep character.</p>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>array</td>
<td>The array to join</td>
<td>list of string (required)</td>
</tr>
<tr>
<td>sep</td>
<td>The separator</td>
<td>string</td>
</tr>
</tbody>
</table>
<h2 id="len">len</h2>
<p><span class='vql_type pull-right'>Function</span></p>
<p>Returns the length of an object.</p>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>list</td>
<td>A list of items too filter</td>
<td>list of string (required)</td>
</tr>
<tr>
<td>regex</td>
<td>A regex to test each item</td>
<td>list of string (required)</td>
</tr>
</tbody>
</table>
<h2 id="log">log</h2>
<p><span class='vql_type pull-right'>Function</span></p>
<p>Log the message.</p>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>message</td>
<td>Message to log.</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<h2 id="lowcase">lowcase</h2>
<p><span class='vql_type pull-right'>Function</span></p>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>string</td>
<td>A string to lower</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<h2 id="max">max</h2>
<p><span class='vql_type pull-right'>Function</span></p>
<p>Finds the largest item in the aggregate.</p>
<p>It is only meaningful in a group by query.</p>
<h3 id="example-1">Example</h3>
<p>The following query lists all the processes and shows the largest
bash pid of all bash processes.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-SQL" data-lang="SQL"><span style="color:#66d9ef">SELECT</span> Name, <span style="color:#66d9ef">max</span>(items<span style="color:#f92672">=</span>Pid) <span style="color:#66d9ef">as</span> LargestPid <span style="color:#66d9ef">from</span> pslist() <span style="color:#66d9ef">Where</span> Name <span style="color:#f92672">=~</span> <span style="color:#e6db74">&#39;bash&#39;</span> <span style="color:#66d9ef">group</span> <span style="color:#66d9ef">by</span> Name
</code></pre></div><table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>items</td>
<td></td>
<td>Any (required)</td>
</tr>
</tbody>
</table>
<h2 id="min">min</h2>
<p><span class='vql_type pull-right'>Function</span></p>
<p>Finds the smallest item in the aggregate.</p>
<p>It is only meaningful in a group by query.</p>
<h3 id="example-2">Example</h3>
<p>The following query lists all the processes and shows the smallest
bash pid of all bash processes.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-SQL" data-lang="SQL"><span style="color:#66d9ef">SELECT</span> Name, <span style="color:#66d9ef">min</span>(items<span style="color:#f92672">=</span>Pid) <span style="color:#66d9ef">as</span> SmallestPid <span style="color:#66d9ef">from</span> pslist() <span style="color:#66d9ef">Where</span> Name <span style="color:#f92672">=~</span> <span style="color:#e6db74">&#39;bash&#39;</span> <span style="color:#66d9ef">group</span> <span style="color:#66d9ef">by</span> Name
</code></pre></div><table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>items</td>
<td></td>
<td>Any (required)</td>
</tr>
</tbody>
</table>
<h2 id="now">now</h2>
<p><span class='vql_type pull-right'>Function</span></p>
<p>Returns current time in seconds since epoch.</p>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>string</td>
<td>A string to convert to int</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<h2 id="path_join">path_join</h2>
<p><span class='vql_type pull-right'>Function</span></p>
<p>Build a path by joining all components.</p>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>components</td>
<td>Path components to join.</td>
<td>list of string (required)</td>
</tr>
</tbody>
</table>
<h2 id="query">query</h2>
<p><span class='vql_type pull-right'>Function</span></p>
<p>Launch a subquery and materialize it into a list of rows.</p>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>vql</td>
<td></td>
<td>StoredQuery (required)</td>
</tr>
</tbody>
</table>
<h2 id="rand">rand</h2>
<p><span class='vql_type pull-right'>Function</span></p>
<p>Selects a random number.</p>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>range</td>
<td>Selects a random number up to this range.</td>
<td>int64</td>
</tr>
</tbody>
</table>
<h2 id="read_file">read_file</h2>
<p><span class='vql_type pull-right'>Function</span></p>
<p>Read a file into a string.</p>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>chunk</td>
<td>length of each chunk to read from the file.</td>
<td>int</td>
</tr>
<tr>
<td>max_length</td>
<td>Max length of the file to read.</td>
<td>int</td>
</tr>
<tr>
<td>filenames</td>
<td>One or more files to open.</td>
<td>list of string (required)</td>
</tr>
<tr>
<td>accessor</td>
<td>An accessor to use.</td>
<td>string</td>
</tr>
</tbody>
</table>
<h2 id="scope">scope</h2>
<p><span class='vql_type pull-right'>Function</span></p>
<p>return the scope.</p>
<h2 id="serialize">serialize</h2>
<p><span class='vql_type pull-right'>Function</span></p>
<p>Encode an object as a string (csv or json).</p>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>item</td>
<td>The item to encode</td>
<td>Any (required)</td>
</tr>
<tr>
<td>format</td>
<td>Encoding format (csv,json)</td>
<td>string</td>
</tr>
</tbody>
</table>
<h2 id="sleep">sleep</h2>
<p><span class='vql_type pull-right'>Function</span></p>
<p>Sleep for the specified number of seconds. Always returns true.</p>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>time</td>
<td>The number of seconds to sleep</td>
<td>int64</td>
</tr>
</tbody>
</table>
<h2 id="split">split</h2>
<p><span class='vql_type pull-right'>Function</span></p>
<p>Splits a string into an array based on a regexp separator.</p>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>string</td>
<td>The value to split</td>
<td>string (required)</td>
</tr>
<tr>
<td>sep</td>
<td>The serparator that will be used to split</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<h2 id="str">str</h2>
<p><span class='vql_type pull-right'>Function</span></p>
<p>Normalize a String.</p>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>str</td>
<td>The string to normalize</td>
<td>Any (required)</td>
</tr>
</tbody>
</table>
<h2 id="strip">strip</h2>
<p><span class='vql_type pull-right'>Function</span></p>
<p>Strip a prefix from a string.</p>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>string</td>
<td>The string to strip</td>
<td>string (required)</td>
</tr>
<tr>
<td>prefix</td>
<td>The prefix to strip</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<h2 id="timestamp">timestamp</h2>
<p><span class='vql_type pull-right'>Function</span></p>
<p>Convert from different types to a time.Time.</p>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>epoch</td>
<td></td>
<td>Any</td>
</tr>
<tr>
<td>winfiletime</td>
<td></td>
<td>int64</td>
</tr>
<tr>
<td>string</td>
<td>Guess a timestamp from a string</td>
<td>string</td>
</tr>
<tr>
<td>us_style</td>
<td>US Style Month/Day/Year</td>
<td>bool</td>
</tr>
</tbody>
</table>
<h2 id="upcase">upcase</h2>
<p><span class='vql_type pull-right'>Function</span></p>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>string</td>
<td>A string to lower</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<h2 id="url">url</h2>
<p><span class='vql_type pull-right'>Function</span></p>
<p>Construct a URL or parse one.</p>
<p>This function parses or constructs URLs. A URL may be constructed from
scratch by providing all the components or it may be parsed from an
existing URL.</p>
<p>The returned object is a <a href="https://golang.org/pkg/net/url/#URL">golang
URL</a> and can be serialized again
using its <code>String</code> method.</p>
<p>This function is important when constructing parameters for certain
accessors which receive a URL. For example the <code>zip</code> accessor requires
its file names to consist of URLs. The Zip accessor interprets the URL
in the following way:</p>
<ul>
<li>The scheme is the delegate accessor to use.</li>
<li>The path is the delegate accessor&rsquo;s filename</li>
<li>The fragment is used by the zip accessor to retrieve the zip member itself.</li>
</ul>
<p>In this case it is critical to properly escape each level - it is not
possible in the general case to simply append strings. You need to use
the <code>url()</code> function to build the proper url.</p>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>scheme</td>
<td>The scheme to use</td>
<td>string</td>
</tr>
<tr>
<td>host</td>
<td>The host component</td>
<td>string</td>
</tr>
<tr>
<td>path</td>
<td>The path component</td>
<td>string</td>
</tr>
<tr>
<td>fragment</td>
<td>The fragment</td>
<td>string</td>
</tr>
<tr>
<td>parse</td>
<td>A url to parse</td>
<td>string</td>
</tr>
</tbody>
</table>
<h2 id="utf16">utf16</h2>
<p><span class='vql_type pull-right'>Function</span></p>
<p>Parse input from utf16.</p>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>string</td>
<td>A string to decode</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<h2 id="utf16_encode">utf16_encode</h2>
<p><span class='vql_type pull-right'>Function</span></p>
<p>Encode a string to utf16 bytes.</p>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>string</td>
<td>A string to decode</td>
<td>string (required)</td>
</tr>
</tbody>
</table>



    
    
          <footer class=" footline" >
	
</footer>
  </div>
</div>

<div id="navigation">
<a class="nav nav-prev" href="/docs/vql_reference/" title="VQL Reference"> <i class="fa fa-chevron-left"></i><label>VQL Reference</label></a>
    <a class="nav nav-next" href="/docs/vql_reference/windows/" title="Windows Specific Functionality" style="margin-right: 0px;"><label>Windows Specific Functionality</label><i class="fa fa-chevron-right"></i></a></div>

</section>
<div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
  <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
</div>    

<script src="/js/clipboard.min.js"></script>
<script src="/js/featherlight.min.js"></script>
<script src="/js/html5shiv-printshiv.min.js"></script>

<script src="/js/modernizr.custom.71422.js"></script>
<script src="/js/docdock.js"></script>
<script src="/theme-original/script.js"></script>


    

    
    

    
  </body>
</html>