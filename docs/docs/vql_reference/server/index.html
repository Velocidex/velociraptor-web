<!DOCTYPE html>
<html>
  <head>
    <title>Velociraptor / Dig deeper</title>
    
      <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>Server Side Functionality :: Velociraptor / Dig deeper</title>
<link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon" />
<link rel="stylesheet" href="/css/bootstrap.min.css">
<link href="/css/nucleus.css" rel="stylesheet">
<link href="/css/font-awesome.min.css" rel="stylesheet">
<link href="/css/hybrid.css" rel="stylesheet">
<link href="/css/featherlight.min.css" rel="stylesheet">
<link href="/css/auto-complete.css" rel="stylesheet">
<link href="/theme-original/style.css" rel="stylesheet">

  <link href="/theme-original/variant-mine.css" rel="stylesheet">


<script src="/js/jquery-2.x.min.js"></script>
<style type="text/css">
  :root #header + #content > #left > #rlblock_left {
    display:none !important;
  }
</style>
<link rel="stylesheet" href="/css/theme-mine.css">
<script src="/js/custom.js"></script>


    
  </head>
  <body data-url="/docs/vql_reference/server/">
    
      <div id="headermain"></div>
<nav id="sidebar" class="">



<div class="highlightable">
  <div id="header-wrapper">
    <div id="header">
      
	
  
    <a href="/">
  <img src="/images/logo.svg">
</a>
  


    </div>
        <div class="searchbox">
		    <label for="search-by"><i class="fa fa-search"></i></label>
		    <input data-search-input id="search-by" type="text" placeholder="Search...">
		    <span data-search-clear=""><i class="fa fa-close"></i></span>
		</div>
		<script type="text/javascript" src="/js/lunr.min.js"></script>
		<script type="text/javascript" src="/js/auto-complete.js"></script>
		<script type="text/javascript">
        
            var baseurl = "\/";
        
		</script>
		<script type="text/javascript" src="/js/search.js"></script>
  </div>

      <ul class="topics">
    <li data-nav-id="/about/" class="dd-item haschildren
        ">
      <div>
      <a href="/about/">About Velociraptor</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/about/features/" class="dd-item">
        <div>
          <a href="/about/features/">
            Velociraptor Features
          </a>
        </div>
    </li>
      <li data-nav-id="/about/license/" class="dd-item">
        <div>
          <a href="/about/license/">
            License
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/docs/" class="dd-item parent haschildren
        ">
      <div>
      <a href="/docs/">Velociraptor Documentation</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/docs/getting-started/" class="dd-item haschildren
        ">
      <div>
      <a href="/docs/getting-started/">Getting Started</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/docs/getting-started/stand_alone/" class="dd-item">
        <div>
          <a href="/docs/getting-started/stand_alone/">
            Standalone Deployment
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/getting-started/deploying_clients/" class="dd-item">
        <div>
          <a href="/docs/getting-started/deploying_clients/">
            Deploying Clients
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/getting-started/cloud/" class="dd-item">
        <div>
          <a href="/docs/getting-started/cloud/">
            Deploying in the cloud
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/getting-started/triaging/" class="dd-item">
        <div>
          <a href="/docs/getting-started/triaging/">
            Triaging
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/docs/user-interface/" class="dd-item haschildren
        ">
      <div>
      <a href="/docs/user-interface/">User Interface</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/docs/user-interface/investigating_clients/" class="dd-item haschildren
        ">
      <div>
      <a href="/docs/user-interface/investigating_clients/">Investigating Clients</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/docs/user-interface/investigating_clients/searching_clients/" class="dd-item">
        <div>
          <a href="/docs/user-interface/investigating_clients/searching_clients/">
            Searching for clients
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/user-interface/investigating_clients/virtual_filesystem/" class="dd-item">
        <div>
          <a href="/docs/user-interface/investigating_clients/virtual_filesystem/">
            Client VFS
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/docs/user-interface/artifacts/" class="dd-item haschildren
        ">
      <div>
      <a href="/docs/user-interface/artifacts/">Velociraptor Artifacts</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/docs/user-interface/artifacts/client_artifacts/" class="dd-item">
        <div>
          <a href="/docs/user-interface/artifacts/client_artifacts/">
            Client Artifacts
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/user-interface/artifacts/client_events/" class="dd-item">
        <div>
          <a href="/docs/user-interface/artifacts/client_events/">
            Client Event Artifacts
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/user-interface/artifacts/server_artifacts/" class="dd-item">
        <div>
          <a href="/docs/user-interface/artifacts/server_artifacts/">
            Server Artifacts
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/user-interface/artifacts/server_events/" class="dd-item">
        <div>
          <a href="/docs/user-interface/artifacts/server_events/">
            Server Event Artifacts
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/user-interface/artifacts/add_artifacts/" class="dd-item">
        <div>
          <a href="/docs/user-interface/artifacts/add_artifacts/">
            Customizing Artifacts
          </a>
        </div>
    </li>
        </ul>
    </li>
      <li data-nav-id="/docs/user-interface/api/" class="dd-item">
        <div>
          <a href="/docs/user-interface/api/">
            The Velociraptor API
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/docs/vql_reference/" class="dd-item parent haschildren
        ">
      <div>
      <a href="/docs/vql_reference/">VQL Reference</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/docs/vql_reference/basic/" class="dd-item">
        <div>
          <a href="/docs/vql_reference/basic/">
            Basic VQL
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/vql_reference/windows/" class="dd-item">
        <div>
          <a href="/docs/vql_reference/windows/">
            Windows
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/vql_reference/parsers/" class="dd-item">
        <div>
          <a href="/docs/vql_reference/parsers/">
            Parsers
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/vql_reference/server/" class="dd-item active">
        <div>
          <a href="/docs/vql_reference/server/">
            Server
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/vql_reference/plugin/" class="dd-item">
        <div>
          <a href="/docs/vql_reference/plugin/">
            Client
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/vql_reference/event/" class="dd-item">
        <div>
          <a href="/docs/vql_reference/event/">
            Event Plugins
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/vql_reference/experimental/" class="dd-item">
        <div>
          <a href="/docs/vql_reference/experimental/">
            Experimental
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/vql_reference/filesystem_accessors/" class="dd-item">
        <div>
          <a href="/docs/vql_reference/filesystem_accessors/">
            Filesystem Accessors
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/vql_reference/templates/" class="dd-item">
        <div>
          <a href="/docs/vql_reference/templates/">
            Report Templates
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/vql_reference/tips/" class="dd-item">
        <div>
          <a href="/docs/vql_reference/tips/">
            Artifact Tips
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/docs/artifacts/" class="dd-item haschildren
        ">
      <div>
      <a href="/docs/artifacts/">Artifact Reference</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/docs/artifacts/linux/" class="dd-item">
        <div>
          <a href="/docs/artifacts/linux/">
            Linux Artifacts
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/artifacts/windows_system/" class="dd-item">
        <div>
          <a href="/docs/artifacts/windows_system/">
            Windows System
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/artifacts/server/" class="dd-item">
        <div>
          <a href="/docs/artifacts/server/">
            Server Artifacts
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/artifacts/triage/" class="dd-item">
        <div>
          <a href="/docs/artifacts/triage/">
            Windows Triage
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/artifacts/detection/" class="dd-item">
        <div>
          <a href="/docs/artifacts/detection/">
            Windows Detection
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/artifacts/events/" class="dd-item">
        <div>
          <a href="/docs/artifacts/events/">
            Windows Monitoring
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/artifacts/misc/" class="dd-item">
        <div>
          <a href="/docs/artifacts/misc/">
            Miscelaneous
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/artifacts/linux/linux/" class="dd-item">
        <div>
          <a href="/docs/artifacts/linux/linux/">
            Linux Artifacts
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/docs/presentations/" class="dd-item haschildren
        ">
      <div>
      <a href="/docs/presentations/">Presentations and Workshops</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/docs/presentations/sans_dfir_summit2019/" class="dd-item">
        <div>
          <a href="/docs/presentations/sans_dfir_summit2019/">
            SANS 2019
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/presentations/rsa/" class="dd-item">
        <div>
          <a href="/docs/presentations/rsa/">
            RSA APJ 2019
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/presentations/crikeycon2019/" class="dd-item">
        <div>
          <a href="/docs/presentations/crikeycon2019/">
            Crikeycon 2019
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/presentations/nzitf2018/" class="dd-item">
        <div>
          <a href="/docs/presentations/nzitf2018/">
            NZITF 2018
          </a>
        </div>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li data-nav-id="/blog/" class="dd-item haschildren
        ">
      <div>
      <a href="/blog/">Velociraptor Blog</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/blog/medium/2019-12-31_digging-into-the-system-resource-usage-monitor-srum-afbadb1a375/" class="dd-item">
        <div>
          <a href="/blog/medium/2019-12-31_digging-into-the-system-resource-usage-monitor-srum-afbadb1a375/">
            Digging into the System Resource Usage Monitor (SRUM)
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/medium/2019-12-08-velociraptor-to-elasticsearch-3a9fc02c6568/" class="dd-item">
        <div>
          <a href="/blog/medium/2019-12-08-velociraptor-to-elasticsearch-3a9fc02c6568/">
            Velociraptor to Elasticsearch
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/medium/2019-11-15_recovering-deleted-ntfs-files-with-velociraptor-1fcf09855311/" class="dd-item">
        <div>
          <a href="/blog/medium/2019-11-15_recovering-deleted-ntfs-files-with-velociraptor-1fcf09855311/">
            Recovering deleted NTFS Files with Velociraptor
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/medium/2019-11-12_windows-event-logs-d8d8e615c9ca/" class="dd-item">
        <div>
          <a href="/blog/medium/2019-11-12_windows-event-logs-d8d8e615c9ca/">
            Windows Event Logs
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/medium/2019-10-08_triage-with-velociraptor-pt-3-d6f63215f579/" class="dd-item">
        <div>
          <a href="/blog/medium/2019-10-08_triage-with-velociraptor-pt-3-d6f63215f579/">
            Triage with Velociraptor — Pt 3
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/medium/2019-10-04_triage-with-velociraptor-pt-2-d0f79066ca0e/" class="dd-item">
        <div>
          <a href="/blog/medium/2019-10-04_triage-with-velociraptor-pt-2-d0f79066ca0e/">
            Triage with Velociraptor — Pt 2
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/medium/2019-10-02_triage-with-velociraptor-pt-1-253f57ce96c0/" class="dd-item">
        <div>
          <a href="/blog/medium/2019-10-02_triage-with-velociraptor-pt-1-253f57ce96c0/">
            Triage with Velociraptor — Pt 1
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/medium/2019-09-11_velociraptor-s-client-side-buffer-3ce03697a4e6/" class="dd-item">
        <div>
          <a href="/blog/medium/2019-09-11_velociraptor-s-client-side-buffer-3ce03697a4e6/">
            Velociraptor’s client side buffer
          </a>
        </div>
    </li>
        </ul>
    </li>




    <hr />
    <li></li>
    
    </ul>

 <section id="footer">
    </section>
  </div>
</nav>



<section id="body">
<div id="overlay"></div>
<div class="padding highlightable">

  <div id="top-bar">
    <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
        <span id="sidebar-toggle-span">
          <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
            <i class="fa fa-bars"></i>
          </a>
        </span>
        <span id="toc-menu"><i class="fa fa-list-alt"></i></span>
        <span class="links">
        










 <a href='/'>Velociraptor / Dig deeper</a> > <a href='/docs/'>Velociraptor Documentation</a> > <a href='/docs/vql_reference/'>VQL Reference</a> > Server Side Functionality

 

 

 

   
        </span>
    </div>
    
    
    <div class="progress">
        <div class="wrapper">
    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#clients-span-class-vql-type-pull-right-plugin-span">clients <span class='vql_type pull-right'>Plugin</span></a></li>
<li><a href="#collect-span-class-vql-type-pull-right-function-span">collect <span class='vql_type pull-right'>Function</span></a></li>
<li><a href="#compress-span-class-vql-type-pull-right-function-span">compress <span class='vql_type pull-right'>Function</span></a></li>
<li><a href="#elastic-upload-span-class-vql-type-pull-right-plugin-span">elastic_upload <span class='vql_type pull-right'>Plugin</span></a></li>
<li><a href="#file-store-span-class-vql-type-pull-right-function-span">file_store <span class='vql_type pull-right'>Function</span></a></li>
<li><a href="#flows-span-class-vql-type-pull-right-plugin-span">flows <span class='vql_type pull-right'>Plugin</span></a></li>
<li><a href="#gui-users-span-class-vql-type-pull-right-plugin-span">gui_users <span class='vql_type pull-right'>Plugin</span></a></li>
<li><a href="#hunt-span-class-vql-type-pull-right-function-span">hunt <span class='vql_type pull-right'>Function</span></a></li>
<li><a href="#hunt-flows-span-class-vql-type-pull-right-plugin-span">hunt_flows <span class='vql_type pull-right'>Plugin</span></a></li>
<li><a href="#hunt-results-span-class-vql-type-pull-right-plugin-span">hunt_results <span class='vql_type pull-right'>Plugin</span></a></li>
<li><a href="#hunts-span-class-vql-type-pull-right-plugin-span">hunts <span class='vql_type pull-right'>Plugin</span></a></li>
<li><a href="#label-span-class-vql-type-pull-right-function-span">label <span class='vql_type pull-right'>Function</span></a></li>
<li><a href="#mail-span-class-vql-type-pull-right-plugin-span">mail <span class='vql_type pull-right'>Plugin</span></a></li>
<li><a href="#monitoring-span-class-vql-type-pull-right-plugin-span">monitoring <span class='vql_type pull-right'>Plugin</span></a></li>
<li><a href="#rate-span-class-vql-type-pull-right-function-span">rate <span class='vql_type pull-right'>Function</span></a></li>
<li><a href="#sample-span-class-vql-type-pull-right-plugin-span">sample <span class='vql_type pull-right'>Plugin</span></a></li>
<li><a href="#search-span-class-vql-type-pull-right-plugin-span">search <span class='vql_type pull-right'>Plugin</span></a></li>
<li><a href="#source-span-class-vql-type-pull-right-plugin-span">source <span class='vql_type pull-right'>Plugin</span></a></li>
<li><a href="#uploads-span-class-vql-type-pull-right-plugin-span">uploads <span class='vql_type pull-right'>Plugin</span></a></li>
</ul></li>
</ul>
</nav>
        </div>
    </div>
    

  </div>


<div id="body-inner">
  
    <h1>Server Side Functionality</h1>
  



    
    
    
    

<p>Velociraptor provides complete control of the server within VQL
queries. On the server, the VQL engine contains the following
plugins and functions. You can use this functionality to manage
and automate the server by writing VQL queries.</p>

<p>To reuse server side artifacts, simply create an artifact with
<code>type: SERVER</code> and launch it from the &ldquo;Server Artifacts&rdquo; screen in
the GUI.</p>

<h2 id="clients-span-class-vql-type-pull-right-plugin-span">clients <span class='vql_type pull-right'>Plugin</span></h2>

<p>Retrieve the list of clients.</p>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>

<tbody>
<tr>
<td>search</td>
<td>Client search string. Can have the following prefixes: &lsquo;lable:&lsquo;, &lsquo;host:&rsquo;</td>
<td>string</td>
</tr>

<tr>
<td>client_id</td>
<td></td>
<td>string</td>
</tr>
</tbody>
</table>

<h2 id="collect-span-class-vql-type-pull-right-function-span">collect <span class='vql_type pull-right'>Function</span></h2>

<p>Launch an artifact collection against a client.</p>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>

<tbody>
<tr>
<td>client_id</td>
<td>The client id to schedule a collection on</td>
<td>string (required)</td>
</tr>

<tr>
<td>artifacts</td>
<td>A list of artifacts to collect</td>
<td>list of string (required)</td>
</tr>

<tr>
<td>env</td>
<td>Parameters to apply to the artifacts</td>
<td>Any</td>
</tr>
</tbody>
</table>

<h2 id="compress-span-class-vql-type-pull-right-function-span">compress <span class='vql_type pull-right'>Function</span></h2>

<p>Compress a file in the server&rsquo;s FileStore. A compressed
file is archived so it takes less space. It is still possible to see
the file and read it but not to seek within it.</p>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>

<tbody>
<tr>
<td>path</td>
<td>A VFS path to compress</td>
<td>list of string (required)</td>
</tr>
</tbody>
</table>

<h2 id="elastic-upload-span-class-vql-type-pull-right-plugin-span">elastic_upload <span class='vql_type pull-right'>Plugin</span></h2>

<p>Upload rows to elastic.</p>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>

<tbody>
<tr>
<td>query</td>
<td>Source for rows to upload.</td>
<td>StoredQuery (required)</td>
</tr>

<tr>
<td>threads</td>
<td>How many threads to use.</td>
<td>int64</td>
</tr>

<tr>
<td>index</td>
<td>The name of the index to upload to. If not specified ensure a column is named &lsquo;_index&rsquo;.</td>
<td>string</td>
</tr>

<tr>
<td>type</td>
<td>The type of the index to upload to.</td>
<td>string (required)</td>
</tr>

<tr>
<td>chunk_size</td>
<td>The number of rows to send at the time.</td>
<td>int64</td>
</tr>

<tr>
<td>addresses</td>
<td>A list of Elasticsearch nodes to use.</td>
<td>list of string</td>
</tr>

<tr>
<td>username</td>
<td>Username for HTTP Basic Authentication.</td>
<td>string</td>
</tr>

<tr>
<td>password</td>
<td>Password for HTTP Basic Authentication.</td>
<td>string</td>
</tr>

<tr>
<td>cloud_id</td>
<td>Endpoint for the Elastic Service (<a href="https://elastic.co/cloud">https://elastic.co/cloud</a>).</td>
<td>string</td>
</tr>

<tr>
<td>api_key</td>
<td>Base64-encoded token for authorization; if set, overrides username and password.</td>
<td>string</td>
</tr>

<tr>
<td>wait_time</td>
<td>Batch elastic upload this long (2 sec).</td>
<td>int64</td>
</tr>
</tbody>
</table>

<h2 id="file-store-span-class-vql-type-pull-right-function-span">file_store <span class='vql_type pull-right'>Function</span></h2>

<p>Resolves file store paths into full filesystem paths.</p>

<p>This function is only available on the server. It can be used to
find the backing file behind a filestore path so it can be passed
on to an external program.</p>

<p>Velociraptor uses the concept of a Virtual File System to manage the
information about clients etc. The VFS path is a path into the file
store. Of course ultimately (at least in the current implementation)
the file store is storing files on disk, but the disk filename is not
necessarily the same as the VFS path (for example non representable
characters are escaped).</p>

<p>You can use the <code>file_store()</code> function to return the real file path
on disk. This probably only makes sense for VQL queries running on the
server which can independently open the file.</p>

<p>In future the file store may be abstracted (e.g. files may not be
locally stored at all) and this function may stop working.</p>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>

<tbody>
<tr>
<td>path</td>
<td>A VFS path to convert</td>
<td>list of string (required)</td>
</tr>
</tbody>
</table>

<h2 id="flows-span-class-vql-type-pull-right-plugin-span">flows <span class='vql_type pull-right'>Plugin</span></h2>

<p>Retrieve the flows launched on each client.</p>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>

<tbody>
<tr>
<td>client_id</td>
<td></td>
<td>list of string (required)</td>
</tr>

<tr>
<td>flow_id</td>
<td></td>
<td>string</td>
</tr>
</tbody>
</table>

<h2 id="gui-users-span-class-vql-type-pull-right-plugin-span">gui_users <span class='vql_type pull-right'>Plugin</span></h2>

<p>Retrieve the list of users on the server.</p>

<h2 id="hunt-span-class-vql-type-pull-right-function-span">hunt <span class='vql_type pull-right'>Function</span></h2>

<p>Launch an artifact collection against a client.</p>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>

<tbody>
<tr>
<td>description</td>
<td>Description of the hunt</td>
<td>string (required)</td>
</tr>

<tr>
<td>artifacts</td>
<td>A list of artifacts to collect</td>
<td>list of string (required)</td>
</tr>

<tr>
<td>env</td>
<td>Parameters to apply to the artifacts</td>
<td>Any</td>
</tr>
</tbody>
</table>

<h2 id="hunt-flows-span-class-vql-type-pull-right-plugin-span">hunt_flows <span class='vql_type pull-right'>Plugin</span></h2>

<p>Retrieve the flows launched by a hunt.</p>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>

<tbody>
<tr>
<td>hunt_id</td>
<td>The hunt id to inspect.</td>
<td>string (required)</td>
</tr>
</tbody>
</table>

<h2 id="hunt-results-span-class-vql-type-pull-right-plugin-span">hunt_results <span class='vql_type pull-right'>Plugin</span></h2>

<p>Retrieve the results of a hunt.</p>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>

<tbody>
<tr>
<td>artifact</td>
<td>The artifact to retrieve</td>
<td>string (required)</td>
</tr>

<tr>
<td>source</td>
<td>An optional source within the artifact.</td>
<td>string</td>
</tr>

<tr>
<td>hunt_id</td>
<td>The hunt id to read.</td>
<td>string (required)</td>
</tr>

<tr>
<td>brief</td>
<td>If set we return less columns.</td>
<td>bool</td>
</tr>
</tbody>
</table>

<h2 id="hunts-span-class-vql-type-pull-right-plugin-span">hunts <span class='vql_type pull-right'>Plugin</span></h2>

<p>Retrieve the list of hunts.</p>

<h2 id="label-span-class-vql-type-pull-right-function-span">label <span class='vql_type pull-right'>Function</span></h2>

<p>Add the labels to the client. If op is &lsquo;remove&rsquo; then remove these labels.</p>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>

<tbody>
<tr>
<td>client_id</td>
<td>Client ID to label.</td>
<td>string (required)</td>
</tr>

<tr>
<td>labels</td>
<td>A list of labels to apply</td>
<td>list of string (required)</td>
</tr>

<tr>
<td>op</td>
<td>An operation on the labels (add, remove)</td>
<td>string</td>
</tr>
</tbody>
</table>

<h2 id="mail-span-class-vql-type-pull-right-plugin-span">mail <span class='vql_type pull-right'>Plugin</span></h2>

<p>Send Email to a remote server.</p>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>

<tbody>
<tr>
<td>to</td>
<td>Receipient of the mail</td>
<td>list of string (required)</td>
</tr>

<tr>
<td>cc</td>
<td>A cc for the mail</td>
<td>list of string</td>
</tr>

<tr>
<td>subject</td>
<td>The subject.</td>
<td>string</td>
</tr>

<tr>
<td>body</td>
<td>The body of the mail.</td>
<td>string (required)</td>
</tr>

<tr>
<td>period</td>
<td>How long to wait before sending the next mail - help to throttle mails.</td>
<td>int64 (required)</td>
</tr>
</tbody>
</table>

<h2 id="monitoring-span-class-vql-type-pull-right-plugin-span">monitoring <span class='vql_type pull-right'>Plugin</span></h2>

<p>Extract monitoring log from a client. If client_id is not specified we watch the global journal which contains event logs from all clients.</p>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>

<tbody>
<tr>
<td>client_id</td>
<td>A list of client ids to watch. If not provided we watch all clients.</td>
<td>list of string</td>
</tr>

<tr>
<td>artifact</td>
<td>The event artifact name to watch</td>
<td>string (required)</td>
</tr>

<tr>
<td>source</td>
<td>An optional artifact named source</td>
<td>string</td>
</tr>
</tbody>
</table>

<h2 id="rate-span-class-vql-type-pull-right-function-span">rate <span class='vql_type pull-right'>Function</span></h2>

<p>Calculates the rate (derivative) between two quantities.</p>

<p>For example if a monitoring plugin returns an absolute value
sampled in time (e.g. bytes transferred sampled every second) then
the rate() plugin can calculate the average bytes/sec.</p>

<p>This function works by remembering the values of x and y from the
previous row and applying the current rows values.</p>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>

<tbody>
<tr>
<td>x</td>
<td>The X float</td>
<td>float64 (required)</td>
</tr>

<tr>
<td>y</td>
<td>The Y float</td>
<td>float64 (required)</td>
</tr>
</tbody>
</table>

<h2 id="sample-span-class-vql-type-pull-right-plugin-span">sample <span class='vql_type pull-right'>Plugin</span></h2>

<p>Executes &lsquo;query&rsquo; and samples every n&rsquo;th row.</p>

<p>This is most useful on the server in order to downsample event
artifact results.</p>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>

<tbody>
<tr>
<td>query</td>
<td>Source query.</td>
<td>StoredQuery (required)</td>
</tr>

<tr>
<td>n</td>
<td>Pick every n row from query.</td>
<td>int64 (required)</td>
</tr>
</tbody>
</table>

<h2 id="search-span-class-vql-type-pull-right-plugin-span">search <span class='vql_type pull-right'>Plugin</span></h2>

<p>Search the server client&rsquo;s index.</p>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>

<tbody>
<tr>
<td>query</td>
<td>The query string.</td>
<td>string</td>
</tr>

<tr>
<td>offset</td>
<td>Skip this many results.</td>
<td>uint64</td>
</tr>

<tr>
<td>limit</td>
<td>Only return limited results</td>
<td>uint64</td>
</tr>

<tr>
<td>type</td>
<td>The type of search (e.g. &lsquo;key&rsquo;)</td>
<td>string</td>
</tr>
</tbody>
</table>

<h2 id="source-span-class-vql-type-pull-right-plugin-span">source <span class='vql_type pull-right'>Plugin</span></h2>

<p>Retrieve rows from an artifact&rsquo;s source.</p>

<p>This plugin is mostly useful in reports. It attempts to do the
right thing automatically by inferring most parameters from its
execution environment.</p>

<p>For example when called within a CLIENT report context, it will
automatically fill its flow id, client id etc. Typically this
means that you only need to specify the source name (for
multi-source artifacts).</p>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>

<tbody>
<tr>
<td>client_id</td>
<td>The client id to extract</td>
<td>string</td>
</tr>

<tr>
<td>day_name</td>
<td>Only extract this day&rsquo;s Monitoring logs (deprecated)</td>
<td>string</td>
</tr>

<tr>
<td>start_time</td>
<td>Start return events from this date (for event sources)</td>
<td>int64</td>
</tr>

<tr>
<td>end_time</td>
<td>Stop end events reach this time (event sources).</td>
<td>int64</td>
</tr>

<tr>
<td>flow_id</td>
<td>A flow ID (client or server artifacts)</td>
<td>string</td>
</tr>

<tr>
<td>hunt_id</td>
<td>Retrieve sources from this hunt (combines all results from all clients)</td>
<td>string</td>
</tr>

<tr>
<td>artifact</td>
<td>The name of the artifact collection to fetch</td>
<td>string</td>
</tr>

<tr>
<td>source</td>
<td>An optional named source within the artifact</td>
<td>string</td>
</tr>

<tr>
<td>mode</td>
<td>HUNT or CLIENT mode can be empty</td>
<td>string</td>
</tr>
</tbody>
</table>

<h2 id="uploads-span-class-vql-type-pull-right-plugin-span">uploads <span class='vql_type pull-right'>Plugin</span></h2>

<p>Retrieve information about a flow&rsquo;s uploads.</p>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>

<tbody>
<tr>
<td>client_id</td>
<td>The client id to extract</td>
<td>string</td>
</tr>

<tr>
<td>flow_id</td>
<td>A flow ID (client or server artifacts)</td>
<td>string</td>
</tr>
</tbody>
</table>


    
    
          <footer class=" footline" >
	
</footer>
  </div>
</div>

<div id="navigation">
<a class="nav nav-prev" href="/docs/vql_reference/parsers/" title="Parsers and data extractors"> <i class="fa fa-chevron-left"></i><label>Parsers and data extractors</label></a>
    <a class="nav nav-next" href="/docs/vql_reference/plugin/" title="Client Side Functionality" style="margin-right: 0px;"><label>Client Side Functionality</label><i class="fa fa-chevron-right"></i></a></div>

</section>
<div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
  <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
</div>    

<script src="/js/clipboard.min.js"></script>
<script src="/js/featherlight.min.js"></script>
<script src="/js/html5shiv-printshiv.min.js"></script>

<script src="/js/modernizr.custom.71422.js"></script>
<script src="/js/docdock.js"></script>
<script src="/theme-original/script.js"></script>


    

    
    

    
  </body>
</html>