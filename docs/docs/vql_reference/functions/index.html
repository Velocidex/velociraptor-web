<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.56.0-DEV" />
    <meta name="description" content="VQL Functions operate on value to return other values.">


<meta property="og:title" content="VQL Functions" />
<meta property="og:description" content="VQL Functions operate on value to return other values." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/docs/vql_reference/functions/" />

<meta property="og:image" content="/images/velo_small.svg" />
<meta property="article:published_time" content="2019-02-01T00:00:00&#43;00:00"/>
<meta property="article:modified_time" content="2019-02-01T00:00:00&#43;00:00"/><meta property="og:site_name" content="Velociraptor: Digging Deeper!" />

<meta itemprop="name" content="VQL Functions">
<meta itemprop="description" content="VQL Functions operate on value to return other values.">


<meta itemprop="datePublished" content="2019-02-01T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2019-02-01T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="934">



<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="/images/velo_small.svg"/>

<meta name="twitter:title" content="VQL Functions"/>
<meta name="twitter:description" content="VQL Functions operate on value to return other values."/>

    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>VQL Functions :: Velociraptor - Digging Deeper!</title>

    
    <link href="/css/nucleus.css" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css" rel="stylesheet">
    <link href="/css/hybrid.css" rel="stylesheet">
    <link href="/css/featherlight.min.css" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css" rel="stylesheet">
    <link href="/css/auto-complete.css" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css" rel="stylesheet">
    <link href="/css/theme.css" rel="stylesheet">
    <link href="/css/hugo-theme.css" rel="stylesheet">
    
      <link href="/css/theme-mine.css" rel="stylesheet">
    

    <script src="/js/jquery-3.3.1.min.js"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/docs/vql_reference/functions/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a href="/">
  <img src="/images/logo.svg" />
</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js"></script>
<script type="text/javascript" src="/js/auto-complete.js"></script>
<script type="text/javascript">
    
        var baseurl = "\/";
    
</script>
<script type="text/javascript" src="/js/search.js"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/about/" title="About Velociraptor" class="dd-item 
        
        
        
        ">
      <a href="/about/">
          Overview
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/about/features/" title="Velociraptor Features" class="dd-item ">
        <a href="/about/features/">
        Velociraptor Features
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/about/license/" title="GNU Affero General Public License" class="dd-item ">
        <a href="/about/license/">
        License
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/docs/" title="Velociraptor Documentation" class="dd-item 
        parent
        
        
        ">
      <a href="/docs/">
          Velociraptor Documentation
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/docs/getting-started/" title="Getting Started" class="dd-item 
        
        
        
        ">
      <a href="/docs/getting-started/">
          Getting Started
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/docs/getting-started/stand_alone/" title="Standalone Deployment" class="dd-item ">
        <a href="/docs/getting-started/stand_alone/">
        Standalone Deployment
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/getting-started/deploying_clients/" title="Deploying Clients" class="dd-item ">
        <a href="/docs/getting-started/deploying_clients/">
        Deploying Clients
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/getting-started/cloud/" title="Deploying in the cloud" class="dd-item ">
        <a href="/docs/getting-started/cloud/">
        Deploying in the cloud
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/getting-started/triaging/" title="Triaging" class="dd-item ">
        <a href="/docs/getting-started/triaging/">
        Triaging
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/docs/user-interface/" title="User Interface" class="dd-item 
        
        
        
        ">
      <a href="/docs/user-interface/">
          User Interface
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/docs/user-interface/investigating_clients/" title="Investigating Clients" class="dd-item 
        
        
        
        ">
      <a href="/docs/user-interface/investigating_clients/">
          Investigating Clients
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/docs/user-interface/investigating_clients/searching_clients/" title="Searching for clients" class="dd-item ">
        <a href="/docs/user-interface/investigating_clients/searching_clients/">
        Searching for clients
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/user-interface/investigating_clients/virtual_filesystem/" title="The Virtual File System" class="dd-item ">
        <a href="/docs/user-interface/investigating_clients/virtual_filesystem/">
        Client VFS
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/docs/user-interface/artifacts/" title="Velociraptor Artifacts" class="dd-item 
        
        
        
        ">
      <a href="/docs/user-interface/artifacts/">
          Velociraptor Artifacts
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/docs/user-interface/artifacts/client_artifacts/" title="Client Artifacts" class="dd-item ">
        <a href="/docs/user-interface/artifacts/client_artifacts/">
        Client Artifacts
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/user-interface/artifacts/client_events/" title="Client Event Artifacts" class="dd-item ">
        <a href="/docs/user-interface/artifacts/client_events/">
        Client Event Artifacts
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/user-interface/artifacts/server_artifacts/" title="Server Artifacts" class="dd-item ">
        <a href="/docs/user-interface/artifacts/server_artifacts/">
        Server Artifacts
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/user-interface/artifacts/server_events/" title="Server Event Artifacts" class="dd-item ">
        <a href="/docs/user-interface/artifacts/server_events/">
        Server Event Artifacts
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/user-interface/artifacts/add_artifacts/" title="Customizing Artifacts" class="dd-item ">
        <a href="/docs/user-interface/artifacts/add_artifacts/">
        Customizing Artifacts
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/use_cases/" title="Use Cases" class="dd-item ">
        <a href="/docs/use_cases/">
        Use Cases
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/docs/presentations/" title="Presentations and Workshops" class="dd-item 
        
        
        
        ">
      <a href="/docs/presentations/">
          Presentations and Workshops
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/docs/presentations/crikeycon2019/" title="Crikeycon 2019 Training Workshop" class="dd-item ">
        <a href="/docs/presentations/crikeycon2019/">
        CrikeyCon 2019
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/presentations/nzitf2018/" title="New Zealand Internet Task Force Conference 2018" class="dd-item ">
        <a href="/docs/presentations/nzitf2018/">
        NZITF2018
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/docs/vql_reference/" title="VQL Reference" class="dd-item 
        parent
        
        
        ">
      <a href="/docs/vql_reference/">
          VQL Reference
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/docs/vql_reference/templates/" title="Report Templates" class="dd-item ">
        <a href="/docs/vql_reference/templates/">
        Report Templates
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/vql_reference/event_plugins/" title="VQL Event PLugins" class="dd-item ">
        <a href="/docs/vql_reference/event_plugins/">
        VQL Event PLugins
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/vql_reference/functions/" title="VQL Functions" class="dd-item active">
        <a href="/docs/vql_reference/functions/">
        VQL Functions
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/vql_reference/server/" title="VQL Server Plugins" class="dd-item ">
        <a href="/docs/vql_reference/server/">
        VQL Server Plugins
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/vql_reference/plugins/" title="VQL PLugins" class="dd-item ">
        <a href="/docs/vql_reference/plugins/">
        VQL PLugins
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/tutorial/" title="Tutorial" class="dd-item ">
        <a href="/docs/tutorial/">
        Tutorial
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/docs/artifacts/" title="Artifact Reference" class="dd-item 
        
        
        
        ">
      <a href="/docs/artifacts/">
          Artifact Reference
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/docs/artifacts/linux/linux/" title="Linux Artifacts" class="dd-item ">
        <a href="/docs/artifacts/linux/linux/">
        Linux Artifacts
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/artifacts/misc/" title="Miscelaneous Artifacts" class="dd-item ">
        <a href="/docs/artifacts/misc/">
        Miscelaneous
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/artifacts/server/" title="Server Artifacts" class="dd-item ">
        <a href="/docs/artifacts/server/">
        Server Artifacts
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/artifacts/detection/" title="Windows Malware Detection" class="dd-item ">
        <a href="/docs/artifacts/detection/">
        Windows Detection
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/artifacts/events/" title="Windows Event Monitoring" class="dd-item ">
        <a href="/docs/artifacts/events/">
        Windows Monitoring
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/artifacts/windows_system/" title="Windows System" class="dd-item ">
        <a href="/docs/artifacts/windows_system/">
        Windows System
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/artifacts/triage/" title="Windows Triage Artifacts" class="dd-item ">
        <a href="/docs/artifacts/triage/">
        Windows Triage
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/blog/" title="Velociraptor Blog" class="dd-item 
        
        
        
        ">
      <a href="/blog/">
          Velociraptor Blog
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2019/03/02/agentless_hunting_with_velociraptor.html" title="Agentless hunting with Velociraptor" class="dd-item ">
        <a href="/blog/html/2019/03/02/agentless_hunting_with_velociraptor.html">
        Agentless hunting with Velociraptor
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2019/02/14/alerting_on_event_patterns.html" title="Alerting on event patterns" class="dd-item ">
        <a href="/blog/html/2019/02/14/alerting_on_event_patterns.html">
        Alerting on event patterns
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2019/02/10/velociraptor_performance.html" title="Velociraptor Performance" class="dd-item ">
        <a href="/blog/html/2019/02/10/velociraptor_performance.html">
        Velociraptor Performance
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2019/02/09/velociraptor_python_api.html" title="The Velociraptor Python API" class="dd-item ">
        <a href="/blog/html/2019/02/09/velociraptor_python_api.html">
        The Velociraptor Python API
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/09/03/velociraptor_s_client_communications.html" title="Velociraptor&#39;s client communications" class="dd-item ">
        <a href="/blog/html/2018/09/03/velociraptor_s_client_communications.html">
        Velociraptor&#39;s client communications
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/12/23/deploying_velociraptor_with_oauth_sso.html" title="Deploying Velociraptor with OAuth SSO" class="dd-item ">
        <a href="/blog/html/2018/12/23/deploying_velociraptor_with_oauth_sso.html">
        Deploying Velociraptor with OAuth SSO
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/12/22/configuring_velociraptor_for_ssl.html" title="Configuring Velociraptor for SSL" class="dd-item ">
        <a href="/blog/html/2018/12/22/configuring_velociraptor_for_ssl.html">
        Configuring Velociraptor for SSL
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/12/11/velociraptor_interactive_shell.html" title="Velociraptor Interactive Shell" class="dd-item ">
        <a href="/blog/html/2018/12/11/velociraptor_interactive_shell.html">
        Velociraptor Interactive Shell
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/12/10/server_side_vql_queries_and_events.html" title="Server side VQL queries and Escalation Events" class="dd-item ">
        <a href="/blog/html/2018/12/10/server_side_vql_queries_and_events.html">
        Server side VQL queries and Escalation Events
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/12/09/more_on_client_event_collection.html" title="More on client event collection" class="dd-item ">
        <a href="/blog/html/2018/12/09/more_on_client_event_collection.html">
        More on client event collection
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/11/13/velociraptor_training_at_nzitf.html" title="Velociraptor training at NZITF" class="dd-item ">
        <a href="/blog/html/2018/11/13/velociraptor_training_at_nzitf.html">
        Velociraptor training at NZITF
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/11/09/event_queries_and_endpoint_monitoring.html" title="Event Queries and Endpoint Monitoring" class="dd-item ">
        <a href="/blog/html/2018/11/09/event_queries_and_endpoint_monitoring.html">
        Event Queries and Endpoint Monitoring
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/09/30/velorciraptor_s_filesystem_s_accessors.html" title="Velorciraptor&#39;s filesystem&#39;s accessors" class="dd-item ">
        <a href="/blog/html/2018/09/30/velorciraptor_s_filesystem_s_accessors.html">
        Velorciraptor&#39;s filesystem&#39;s accessors
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/09/29/detecting_powershell_persistence_with_velociraptor_and_yara.html" title="Detecting powershell persistence with Velociraptor and Yara" class="dd-item ">
        <a href="/blog/html/2018/09/29/detecting_powershell_persistence_with_velociraptor_and_yara.html">
        Detecting powershell persistence with Velociraptor and Yara
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/09/03/velociraptor_walk_through_and_demo.html" title="Velociraptor walk through and demo" class="dd-item ">
        <a href="/blog/html/2018/09/03/velociraptor_walk_through_and_demo.html">
        Velociraptor walk through and demo
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/08/20/velociraptor_artifacts.html" title="Velociraptor Artifacts" class="dd-item ">
        <a href="/blog/html/2018/08/20/velociraptor_artifacts.html">
        Velociraptor Artifacts
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/08/10/browsing_around_the_filesystem.html" title="Browsing around the filesystem." class="dd-item ">
        <a href="/blog/html/2018/08/10/browsing_around_the_filesystem.html">
        Browsing around the filesystem.
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/08/10/design_differences_between_velociraptor_and_grr.html" title="Design differences between Velociraptor and GRR" class="dd-item ">
        <a href="/blog/html/2018/08/10/design_differences_between_velociraptor_and_grr.html">
        Design differences between Velociraptor and GRR
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/02/09/files_files_everything_is_just_a_file.html" title="Files, files everything is just a file!" class="dd-item ">
        <a href="/blog/html/2018/02/09/files_files_everything_is_just_a_file.html">
        Files, files everything is just a file!
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/08/10/hunting_what_velociraptors_do_best.html" title="Hunting - What Velociraptors do best!" class="dd-item ">
        <a href="/blog/html/2018/08/10/hunting_what_velociraptors_do_best.html">
        Hunting - What Velociraptors do best!
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/08/10/interrogation_make_the_endpoint_tell_us_what_it_knows.html" title="Interrogation - Make the endpoint tell us what it knows!" class="dd-item ">
        <a href="/blog/html/2018/08/10/interrogation_make_the_endpoint_tell_us_what_it_knows.html">
        Interrogation - Make the endpoint tell us what it knows!
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/08/10/the_velocidex_query_language.html" title="Velocidex Query Language (VQL)" class="dd-item ">
        <a href="/blog/html/2018/08/10/the_velocidex_query_language.html">
        Velocidex Query Language (VQL)
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/08/10/introducing_velociraptor.html" title="Introducing Velociraptor" class="dd-item ">
        <a href="/blog/html/2018/08/10/introducing_velociraptor.html">
        Introducing Velociraptor
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    

    
    <section id="footer">
      
    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                   VQL Functions 
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#parse-json">parse_json</a></li>
<li><a href="#parse-json-array">parse_json_array</a></li>
<li><a href="#parse-xml">parse_xml</a></li>
<li><a href="#environ">environ</a></li>
<li><a href="#dirname">dirname</a></li>
<li><a href="#basename">basename</a></li>
<li><a href="#tempfile">tempfile</a></li>
<li><a href="#format">format</a></li>
<li><a href="#base64decode">base64decode</a></li>
<li><a href="#ip">ip</a></li>
<li><a href="#lowcase">lowcase</a></li>
<li><a href="#upcase">upcase</a></li>
<li><a href="#atoi">atoi</a></li>
<li><a href="#now">now</a></li>
<li><a href="#utf16">utf16</a></li>
<li><a href="#hash">hash</a></li>
<li><a href="#humanize">humanize</a></li>
<li><a href="#array">array</a></li>
<li><a href="#join">join</a></li>
<li><a href="#filter">filter</a></li>
<li><a href="#getpid">getpid</a></li>
<li><a href="#url">url</a></li>
<li><a href="#upload">upload</a></li>
<li><a href="#expand">expand</a></li>
</ul></li>
</ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              VQL Functions
            </h1>
          

        





<p>Functions are useful to transform values obtained from a VQL row.</p>


<div class="notices note" ><p>VQL plugins are not the same as VQL functions. A plugin is the subject
of the VQL query - i.e. plugins always follow the <code>FROM</code> keyword,
while functions (which return a single value instead of a sequence of
rows) are only present in column specification (e.g. after <code>SELECT</code>)
or in condition clauses (i.e. after the <code>WHERE</code> keyword).</p>
</div>


<h2 id="parse-json">parse_json</h2>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>data</td>
<td>A string containing a serialized json object.</td>
</tr>
</tbody>
</table>

<p>This function parses a json string into a dict.</p>

<p>Note that when VQL dereferences fields in a dict it returns a Null for
those fields that do not exist. Thus there is no error in actually
accessing missing fields, the column will just return nil.</p>

<h2 id="parse-json-array">parse_json_array</h2>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>data</td>
<td>A string containing a serialized json array.</td>
</tr>
</tbody>
</table>

<p>This function is similar to <code>parse_json()</code> but works for a JSON list
instead of an object.</p>

<h2 id="parse-xml">parse_xml</h2>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>file</td>
<td>A single file to parse</td>
</tr>

<tr>
<td>accessor</td>
<td>The accessor to use for openning the file.</td>
</tr>
</tbody>
</table>

<p>This function parses the xml file into a dict like object which can
then be queried.</p>

<h2 id="environ">environ</h2>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>var</td>
<td>The name of the environment variable to lookup</td>
</tr>
</tbody>
</table>

<p>Returns the value of the environment variable specified.</p>

<h2 id="dirname">dirname</h2>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>path</td>
<td>The path to use</td>
</tr>
</tbody>
</table>

<p>Splits the path on separator and return the directory name.</p>

<h2 id="basename">basename</h2>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>path</td>
<td>The path to use</td>
</tr>
</tbody>
</table>

<p>Splits the path on separator and return the basename.</p>

<h2 id="tempfile">tempfile</h2>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>data</td>
<td>The data to store in the temp file.</td>
</tr>

<tr>
<td>extension</td>
<td>A file extension to add to the file.</td>
</tr>
</tbody>
</table>

<p>Create a temporary file and write some data into it. The file will be
removed when the query completes.</p>

<h2 id="format">format</h2>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>format</td>
<td>A format string to use.</td>
</tr>

<tr>
<td>args</td>
<td>A list of args to interpolate into the format string.</td>
</tr>
</tbody>
</table>

<p>Format one or more items according to a format string. The format
string is interpreted using <a href="https://golang.org/pkg/fmt/">the standard golang fmt
package</a>.</p>

<p>The function returns a string.</p>

<h2 id="base64decode">base64decode</h2>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>string</td>
<td>A string to decode</td>
</tr>
</tbody>
</table>

<p>Decodes a base64 encoded string.</p>

<h2 id="ip">ip</h2>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>netaddr4_le</td>
<td>An IPv4 address as a little endian integer.</td>
</tr>

<tr>
<td>netaddr4_be</td>
<td>An IPv4 address as a big endian integer.</td>
</tr>
</tbody>
</table>

<p>Converts an ip address encoded in various ways. If the IP address is
encoded as 32 bit integer we can use netaddr4_le or netaddr4_be to
print it in a human readable way.</p>

<p>This currently does not support IPv6 addresses. Those are usually
encoded as an array of 8 bytes which makes it easy to format using the
<code>format()</code> function:</p>

<pre><code>  format(format=&quot;%x:%x:%x:%x:%x:%x:%x:%x&quot;, value)
</code></pre>

<h2 id="lowcase">lowcase</h2>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>string</td>
<td>A string to decode</td>
</tr>
</tbody>
</table>

<p>Converts a string to lower case.</p>

<h2 id="upcase">upcase</h2>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>string</td>
<td>A string to decode</td>
</tr>
</tbody>
</table>

<p>Converts a string to upper case</p>

<h2 id="atoi">atoi</h2>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>string</td>
<td>A string to decode</td>
</tr>
</tbody>
</table>

<p>Converts a string to an integer.</p>

<h2 id="now">now</h2>

<p>Returns the current time as seconds since the unix epoch.</p>

<h2 id="utf16">utf16</h2>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>string</td>
<td>A string to decode</td>
</tr>
</tbody>
</table>

<p>Converts a UTF16 encoded string to a normal utf8 string.</p>

<h2 id="hash">hash</h2>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>path</td>
<td>A file to hash</td>
</tr>

<tr>
<td>accessor</td>
<td>The accessor to use for openning the file.</td>
</tr>
</tbody>
</table>

<p>This function calculates the MD5, SHA1 and SHA256 hashes of the file.</p>

<h2 id="humanize">humanize</h2>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>bytes</td>
<td>Number of bytes</td>
</tr>
</tbody>
</table>

<p>Formats a byte count in human readable way (e.g. Mb, Gb etc).</p>

<h2 id="array">array</h2>

<p>This function accepts arbitrary arguments and creates an array by
flattening the arguments. For example <code>array(a=1, b=2)</code> will return
<code>[1, 2]</code>.</p>

<p>You can use this to flatten a subquery as well:</p>

<pre><code class="language-sql">SELECT array(a1={ SELECT User FROM Artifact.Windows.System.Users() }) as Users FROM scope()
</code></pre>

<p>Will return a single row with Users being an array of names.</p>

<h2 id="join">join</h2>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>array</td>
<td>An array of strings</td>
</tr>

<tr>
<td>sep</td>
<td>A separator (by default comma)</td>
</tr>
</tbody>
</table>

<p>Joins the array into a string separated by the sep character.</p>

<h2 id="filter">filter</h2>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>array</td>
<td>An array of strings</td>
</tr>

<tr>
<td>regex</td>
<td>A regular expression to apply to the array</td>
</tr>
</tbody>
</table>

<p>Returns another array filtered by the regular expression.</p>

<h2 id="getpid">getpid</h2>

<p>Returns Velociraptor&rsquo;s own pid.</p>

<h2 id="url">url</h2>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>scheme</td>
<td>The scheme to use</td>
</tr>

<tr>
<td>host</td>
<td>The host component</td>
</tr>

<tr>
<td>path</td>
<td>The path component</td>
</tr>

<tr>
<td>fragment</td>
<td>The fragment component</td>
</tr>

<tr>
<td>parse</td>
<td>A url to parse</td>
</tr>
</tbody>
</table>

<p>This function parses or constructs URLs. A URL may be constructed from
scratch by providing all the components or it may be parsed from an
existing URL.</p>

<p>The returned object is a <a href="https://golang.org/pkg/net/url/#URL">golang
URL</a> and can be serialized again
using its <code>String</code> method.</p>

<p>This function is important when constructing parameters for certain
accessors which receive a URL. For exampel the <code>zip</code> accessor requires
its file names to consist of URLs. The Zip accessor interprets the URL
in the following way:</p>

<ul>
<li>The scheme is the delegate accessor to use.</li>
<li>The path is the delegate accessor&rsquo;s filename</li>
<li>The fragment is used by the zip accessor to retrieve the zip member itself.</li>
</ul>

<p>In this case it is critical to properly escape each level - it is not
possible in the geenral case to simply append strings. You need to use
the <code>url()</code> function to build the proper url.</p>

<h2 id="upload">upload</h2>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>file</td>
<td>The file to upload</td>
</tr>

<tr>
<td>name</td>
<td>The name it should be uploaded under</td>
</tr>

<tr>
<td>accessor</td>
<td>An accessor to use.</td>
</tr>
</tbody>
</table>

<p>This function uploads the specified file to the server. If Velociraptor
is run locally the file will be copied tothe <code>--dump_dir</code> path or
added to the triage evidence container.</p>

<h2 id="expand">expand</h2>

<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>path</td>
<td>A path string to expand.</td>
</tr>
</tbody>
</table>

<p>This function expands environment variables into the path. It is
normally needed after using registry values of type REG_EXPAND_SZ as
they typically contain environment strings. Velociraptor does not
automatically expand such values since environment variables typically
depend on the specific user account which reads the registry value
(different user accounts can have different environment variables).</p>


<footer class=" footline" >
	
</footer>


        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/docs/vql_reference/event_plugins/" title="VQL Event PLugins"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/docs/vql_reference/server/" title="VQL Server Plugins" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js"></script>
    <script src="/js/perfect-scrollbar.min.js"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js"></script>
    <script src="/js/jquery.sticky.js"></script>
    <script src="/js/featherlight.min.js"></script>
    <script src="/js/html5shiv-printshiv.min.js"></script>
    <script src="/js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js"></script>
    <script src="/js/learn.js"></script>
    <script src="/js/hugo-learn.js"></script>

    <link href="/mermaid/mermaid.css" rel="stylesheet" />
    <script src="/mermaid/mermaid.js"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    <script>
  function scrollToView(element, container) {
    var offset = element.offset().top - $(window).scrollTop();

    if(offset > window.innerHeight){
      
      container.animate({scrollTop: offset}, 1000);
      return false;
    }
    return true;
  };

  $(document).ready(function () {
    scrollToView($("li.active"), $("div.ps-container"));
  });
</script>

  </body>
</html>

