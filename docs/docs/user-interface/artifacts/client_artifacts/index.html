<!DOCTYPE html>
<html>
  <head>
    <title>Velociraptor / Dig deeper</title>
    
      <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>Client Artifacts :: Velociraptor / Dig deeper</title>
<link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon" />
<link rel="stylesheet" href="/css/bootstrap.min.css">
<link href="/css/nucleus.css" rel="stylesheet">
<link href="/css/font-awesome.min.css" rel="stylesheet">
<link href="/css/hybrid.css" rel="stylesheet">
<link href="/css/featherlight.min.css" rel="stylesheet">
<link href="/css/auto-complete.css" rel="stylesheet">
<link href="/theme-original/style.css" rel="stylesheet">

  <link href="/theme-original/variant-mine.css" rel="stylesheet">


<script src="/js/jquery-2.x.min.js"></script>
<style type="text/css">
  :root #header + #content > #left > #rlblock_left {
    display:none !important;
  }
</style>
<link rel="stylesheet" href="/css/theme-mine.css">
<script src="/js/custom.js"></script>


    
  </head>
  <body data-url="/docs/user-interface/artifacts/client_artifacts/">
    
      <div id="headermain"></div>
<nav id="sidebar" class="">



<div class="highlightable">
  <div id="header-wrapper">
    <div id="header">
      
	
  
    <a href="/">
  <img src="/images/logo.svg">
</a>
  


    </div>
        <div class="searchbox">
		    <label for="search-by"><i class="fa fa-search"></i></label>
		    <input data-search-input id="search-by" type="text" placeholder="Search...">
		    <span data-search-clear=""><i class="fa fa-close"></i></span>
		</div>
		<script type="text/javascript" src="/js/lunr.min.js"></script>
		<script type="text/javascript" src="/js/auto-complete.js"></script>
		<script type="text/javascript">
        
            var baseurl = "\/";
        
		</script>
		<script type="text/javascript" src="/js/search.js"></script>
  </div>

      <ul class="topics">
    <li data-nav-id="/about/" class="dd-item haschildren
        ">
      <div>
      <a href="/about/">About Velociraptor</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/about/features/" class="dd-item">
        <div>
          <a href="/about/features/">
            Velociraptor Features
          </a>
        </div>
    </li>
      <li data-nav-id="/about/license/" class="dd-item">
        <div>
          <a href="/about/license/">
            License
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/docs/" class="dd-item parent haschildren
        ">
      <div>
      <a href="/docs/">Velociraptor Documentation</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/docs/getting-started/" class="dd-item haschildren
        ">
      <div>
      <a href="/docs/getting-started/">Getting Started</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/docs/getting-started/stand_alone/" class="dd-item">
        <div>
          <a href="/docs/getting-started/stand_alone/">
            Standalone Deployment
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/getting-started/deploying_clients/" class="dd-item">
        <div>
          <a href="/docs/getting-started/deploying_clients/">
            Deploying Clients
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/getting-started/cloud/" class="dd-item">
        <div>
          <a href="/docs/getting-started/cloud/">
            Deploying in the cloud
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/getting-started/triaging/" class="dd-item">
        <div>
          <a href="/docs/getting-started/triaging/">
            Triaging
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/docs/user-interface/" class="dd-item parent haschildren
        ">
      <div>
      <a href="/docs/user-interface/">User Interface</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/docs/user-interface/investigating_clients/" class="dd-item haschildren
        ">
      <div>
      <a href="/docs/user-interface/investigating_clients/">Investigating Clients</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/docs/user-interface/investigating_clients/searching_clients/" class="dd-item">
        <div>
          <a href="/docs/user-interface/investigating_clients/searching_clients/">
            Searching for clients
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/user-interface/investigating_clients/virtual_filesystem/" class="dd-item">
        <div>
          <a href="/docs/user-interface/investigating_clients/virtual_filesystem/">
            Client VFS
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/docs/user-interface/artifacts/" class="dd-item parent haschildren
        ">
      <div>
      <a href="/docs/user-interface/artifacts/">Velociraptor Artifacts</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/docs/user-interface/artifacts/client_artifacts/" class="dd-item active">
        <div>
          <a href="/docs/user-interface/artifacts/client_artifacts/">
            Client Artifacts
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/user-interface/artifacts/client_events/" class="dd-item">
        <div>
          <a href="/docs/user-interface/artifacts/client_events/">
            Client Event Artifacts
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/user-interface/artifacts/server_artifacts/" class="dd-item">
        <div>
          <a href="/docs/user-interface/artifacts/server_artifacts/">
            Server Artifacts
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/user-interface/artifacts/server_events/" class="dd-item">
        <div>
          <a href="/docs/user-interface/artifacts/server_events/">
            Server Event Artifacts
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/user-interface/artifacts/add_artifacts/" class="dd-item">
        <div>
          <a href="/docs/user-interface/artifacts/add_artifacts/">
            Customizing Artifacts
          </a>
        </div>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li data-nav-id="/docs/vql_reference/" class="dd-item haschildren
        ">
      <div>
      <a href="/docs/vql_reference/">VQL Reference</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/docs/vql_reference/plugins/" class="dd-item">
        <div>
          <a href="/docs/vql_reference/plugins/">
            VQL PLugins
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/vql_reference/event_plugins/" class="dd-item">
        <div>
          <a href="/docs/vql_reference/event_plugins/">
            VQL Event PLugins
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/vql_reference/server/" class="dd-item">
        <div>
          <a href="/docs/vql_reference/server/">
            VQL Server Plugins
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/vql_reference/functions/" class="dd-item">
        <div>
          <a href="/docs/vql_reference/functions/">
            VQL Functions
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/vql_reference/templates/" class="dd-item">
        <div>
          <a href="/docs/vql_reference/templates/">
            Report Templates
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/vql_reference/tips/" class="dd-item">
        <div>
          <a href="/docs/vql_reference/tips/">
            Artifact Tips
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/vql_reference/filesystem_accessors/" class="dd-item">
        <div>
          <a href="/docs/vql_reference/filesystem_accessors/">
            Filesystem Accessors
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/docs/artifacts/" class="dd-item haschildren
        ">
      <div>
      <a href="/docs/artifacts/">Artifact Reference</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/docs/artifacts/linux/" class="dd-item">
        <div>
          <a href="/docs/artifacts/linux/">
            Linux Artifacts
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/artifacts/windows_system/" class="dd-item">
        <div>
          <a href="/docs/artifacts/windows_system/">
            Windows System
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/artifacts/server/" class="dd-item">
        <div>
          <a href="/docs/artifacts/server/">
            Server Artifacts
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/artifacts/triage/" class="dd-item">
        <div>
          <a href="/docs/artifacts/triage/">
            Windows Triage
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/artifacts/detection/" class="dd-item">
        <div>
          <a href="/docs/artifacts/detection/">
            Windows Detection
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/artifacts/events/" class="dd-item">
        <div>
          <a href="/docs/artifacts/events/">
            Windows Monitoring
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/artifacts/misc/" class="dd-item">
        <div>
          <a href="/docs/artifacts/misc/">
            Miscelaneous
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/artifacts/linux/linux/" class="dd-item">
        <div>
          <a href="/docs/artifacts/linux/linux/">
            Linux Artifacts
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/docs/presentations/" class="dd-item haschildren
        ">
      <div>
      <a href="/docs/presentations/">Presentations and Workshops</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/docs/presentations/sans_dfir_summit2019/" class="dd-item">
        <div>
          <a href="/docs/presentations/sans_dfir_summit2019/">
            SANS 2019
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/presentations/rsa/" class="dd-item">
        <div>
          <a href="/docs/presentations/rsa/">
            RSA APJ 2019
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/presentations/crikeycon2019/" class="dd-item">
        <div>
          <a href="/docs/presentations/crikeycon2019/">
            Crikeycon 2019
          </a>
        </div>
    </li>
      <li data-nav-id="/docs/presentations/nzitf2018/" class="dd-item">
        <div>
          <a href="/docs/presentations/nzitf2018/">
            NZITF 2018
          </a>
        </div>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li data-nav-id="/blog/" class="dd-item haschildren
        ">
      <div>
      <a href="/blog/">Velociraptor Blog</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
        </ul>
    </li>




    <hr />
    <li></li>
    
    </ul>

 <section id="footer">
    </section>
  </div>
</nav>



<section id="body">
<div id="overlay"></div>
<div class="padding highlightable">

  <div id="top-bar">
    <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
        <span id="sidebar-toggle-span">
          <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
            <i class="fa fa-bars"></i>
          </a>
        </span>
        <span id="toc-menu"><i class="fa fa-list-alt"></i></span>
        <span class="links">
        













 <a href='/'>Velociraptor / Dig deeper</a> > <a href='/docs/'>Velociraptor Documentation</a> > <a href='/docs/user-interface/'>User Interface</a> > <a href='/docs/user-interface/artifacts/'>Velociraptor Artifacts</a> > Client Artifacts

 

 

 

 

   
        </span>
    </div>
    
    
    <div class="progress">
        <div class="wrapper">
    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#the-artifact-details-pane">The artifact details pane</a></li>
<li><a href="#collecting-an-artifact-from-an-endpoint">Collecting an artifact from an endpoint.</a>
<ul>
<li><a href="#controlling-endpoint-performance">Controlling endpoint performance</a></li>
</ul></li>
<li><a href="#the-file-finder-artifact">The File Finder Artifact</a></li>
<li><a href="#inspecting-the-results-of-an-artifact">Inspecting the results of an artifact</a></li>
</ul></li>
</ul>
</nav>
        </div>
    </div>
    

  </div>


<div id="body-inner">
  
    <h1>Client Artifacts</h1>
  



    
    
    
    

<p>Now that we understand what artifacts actually are, we are ready to
collect artifacts from our endpoints. We will first discuss how to
collect an artifact from a single endpoint, and later discuss how to
hunt for the artifacts across the entire fleet.</p>

<p>Once we searched and selected the endpoint of interest, we can switch
to the &ldquo;Collected Artifacts&rdquo; view.</p>

<p><img src="../collected_artifacts.png" alt="The Collected Artifacts view" /></p>

<p>This page shows the artifacts previously collected on this
endpoint. The page is split into a top table showing a list of
collected artifacts, and a bottom overview pane showing details about
each selected artifact in the table above.</p>

<p>The artifacts list table shows an overview of previously collected
artifacts on this endpoint. Each artifact collection operation is
termed a <code>flow</code> in Velociraptor. It has the following columns:</p>

<ol>
<li><p>The state of the flow. This can be a tick for completed flows, a
clock for pending artifacts or a nuke for artifacts which were
collected with critical errors (Artifacts may also have non
critical errors so you need to check the logs as well).</p></li>

<li><p>The <code>FlowId</code> is a unique internal ID given to each flow
Velociraptor runs. You will need this ID if you need to compose VQL
quries for post processing the flow.</p></li>

<li><p>The <code>Artifacts Collected</code> column is a list of artifacts collected
by this flow. It is possible to schedule multiple artifacts to be
collected at the same time. This column shows each artifact by
name.</p></li>

<li><p>The <code>Creation Date</code> is when the artifact was created. The endpoint
may not have been online when we issued the collection request, so
it is possible that the endpoint actually collected the artifact at
a later time.</p></li>

<li><p>The <code>Last Active</code> date is when the last response arrived from the
endpoint relating to this flow. The difference between this time
and the creation time gives us an idea of how long the artifacts
actually took to be collected on the endpoint.</p></li>

<li><p>Finally we learn the user that created the collection. If this
column contains a hunt id (of the form <code>H.XXXX</code>) then this flow was
automatically created by the hunt manager.</p></li>
</ol>

<h2 id="the-artifact-details-pane">The artifact details pane</h2>

<p>The bottom pane allows us to inspect the flow and the collected
artifacts. It consists of several tabs, the first of which <code>Artifact
Collection</code> tab gives high level overview of the flow. We can see how
many files were uploaded, what artifacts were collected and any
specific artifact parameters that were issued.</p>

<p>In particular that tab also offers a <code>Download Results</code>
button. Clicking this button will create a zip file containing all
relevant information obtained from this artifact. Specifically it
contains a CSV file for each returned VQL query, as well as any files
uploaded by the artifact.</p>

<p><img src="../flow_zip.png" alt="Downloaded Artifact" /></p>

<div class="notices warning" >

There is no way to know currently how large the exported zip file will
be, as the Zip file is built on the fly. Therefore there is no
progress bar either as the file is downloaded.

</div>

<p>The <code>Uploaded Files</code> tab shows the files uploaded by the artifact&rsquo;s
VQL. Some artifact are simply file collectors - collecting a bunch of
files for later post processing analysis.</p>

<p>The <code>Results</code> tab shows a table of VQL results from each source. For
artifacts containing multiple sources (or if you collected multiple
artifacts) the selector allows switching between them to view the
result table from each. Since an artifact <code>source</code> is simply a VQL
query, it returns a single table with columns specified by the query
itself. Therefore each artifact source will produce a different table.</p>

<p>The <code>Logs</code> tab shows any messages logged by the endpoint while
collecting the artifact. Many issues encountered by the endpoint are
not considered fatal, but are nevertheless logged to the server (for
example, if the endpoint attempts to open a file which is locked). You
should look at the tab to assess if you are getting a complete result.</p>

<p>Finally the <code>Reports</code> tab shows the artifact&rsquo;s report. As described
above, the report is a human readable document explaining the results
of the artifact and performing some post processing.</p>

<h2 id="collecting-an-artifact-from-an-endpoint">Collecting an artifact from an endpoint.</h2>

<p>We have seen how to examine older artifacts collected from the
endpoint, how do we collect newer artifacts?</p>

<p>Clicking the plus button on the toolbar (<code>Collect More Artifacts</code>)
presents the artifacts collection UI.</p>

<p><img src="../collect_artifacts_ui.png" alt="The collect new artifacts UI" /></p>

<p>The UI element presents a search box for finding the desired
artifacts. Velociraptor will search for the keywords in the artifact&rsquo;s
description field. A list of matching artifact names is presented
below the search box. Clicking on each of these artifacts presents a
summary of the artifact on the right hand side. The summary includes
the description as well as the parameters the artifact takes and the
VQL queries that will be run. The artifact can now be added to the
selected artifacts box.</p>

<h3 id="controlling-endpoint-performance">Controlling endpoint performance</h3>

<p>Some artifacts have to perform many operations on the endpoint. For
example, image if we were looking for a particular file matching a
given hash. We would have to hash all files on the endpoint and then
compare the has to the required hash. This may negatively impact on
the endpoint performance.</p>

<p>Velociraptor offers two settings to allow you to decide how much
impact you want to have on the endpoint.</p>

<p>You can set the <code>Ops/Sec</code> value for collecting the artifacts. This
setting controls how aggressively the endpoint will collect the
artifact. For artifacts that collect a lot of files or otherwise
utilize heavy resources on the endpoint, it is advisable to lower this
to reduce endpoint load. An operation is considered a single row or
1mb scanned, so setting this value to 20 Ops/sec would result in a
yara scan of approximately 20Mb/s. Values between 1 and 50 should be
set here.</p>

<p>The <code>Maximum Time</code> setting controls how long Velociraptor will allow
the artifact query to run. Artifacts that take longer than this time
(by default 10 minutes) will be canceled. Velociraptor uses this
timeout to ensure artifacts do not run out of control on the
endpoint. If your artifact requires examining many files, or you have
lowered Ops/Sec to reduce its impact on the endpoint (but this will
make it take longer), you should increase this value.</p>

<h2 id="the-file-finder-artifact">The File Finder Artifact</h2>

<p>Artifacts can take parameters. When you add an artifact to the
&ldquo;Selected Artifact&rdquo; UI the Artifact&rsquo;s parameters also appear in the UI
for you to adjust. The parameters are should be properly filled with
reasonable defaults already so you only need to adjust them sometimes.</p>

<p>One of the most useful artifacts is the File Finder:</p>

<p><img src="../file_finder.png" alt="File Finder" /></p>

<p>The File Finder allows you to search for files in the endpoint using a
number of criteria:</p>

<ol>
<li><p>The Glob is a search pattern of files</p></li>

<li><p>If you want to search the contents of files you can specific a number of keywords here.</p></li>

<li><p><code>Use Raw NTFS</code> specifies that raw NTFS parsing should be used -
this is important for locked files like registry hives.</p></li>

<li><p><code>Upload Files</code> specifies that matching files will be uploaded to the server</p></li>

<li><p><code>Calculate Hash</code> specifies that hashes will be calculated of matching files.</p></li>

<li><p>It is also possible to set date ranges for file matches.</p></li>
</ol>

<h2 id="inspecting-the-results-of-an-artifact">Inspecting the results of an artifact</h2>

<p>When an artifact runs on the endpoint, Velociraptor&rsquo;s VQL engine may
log messages about problems it encounters along the way.</p>

<p><img src="../flow_log.png" alt="Flow Log" /></p>

<p>For example in the above screenshot we see that some files were not
opened by the query because they were locked, but the query uploaded
216 rows and 205 files to the server.</p>

<p>You should inspect the log output to ensure that the artifact is
collected without errors. Although the artifact collection in this
case was mostly successful (it fetched most of the browser artifacts),
a few files were not able to be retrieved. This may or may not be
significant to your case.</p>


    
    
          <footer class=" footline" >
	
</footer>
  </div>
</div>

<div id="navigation">
<a class="nav nav-prev" href="/docs/user-interface/artifacts/" title="Velociraptor Artifacts"> <i class="fa fa-chevron-left"></i><label>Velociraptor Artifacts</label></a>
    <a class="nav nav-next" href="/docs/user-interface/artifacts/client_events/" title="Client Event Artifacts" style="margin-right: 0px;"><label>Client Event Artifacts</label><i class="fa fa-chevron-right"></i></a></div>

</section>
<div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
  <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
</div>    

<script src="/js/clipboard.min.js"></script>
<script src="/js/featherlight.min.js"></script>
<script src="/js/html5shiv-printshiv.min.js"></script>

<script src="/js/modernizr.custom.71422.js"></script>
<script src="/js/docdock.js"></script>
<script src="/theme-original/script.js"></script>


    

    
    

    
  </body>
</html>