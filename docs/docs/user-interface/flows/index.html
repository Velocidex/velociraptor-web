<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.56.0-DEV" />
    <meta name="description" content="Velociraptor: Hunt Evil">


    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>Velociraptor Artifacts :: Velociraptor - Hunt Evil!</title>

    
    <link href="/css/nucleus.css?1560560518" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1560560518" rel="stylesheet">
    <link href="/css/hybrid.css?1560560518" rel="stylesheet">
    <link href="/css/featherlight.min.css?1560560518" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1560560518" rel="stylesheet">
    <link href="/css/auto-complete.css?1560560518" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1560560518" rel="stylesheet">
    <link href="/css/theme.css?1560560518" rel="stylesheet">
    <link href="/css/hugo-theme.css?1560560518" rel="stylesheet">
    
      <link href="/css/theme-mine.css?1560560518" rel="stylesheet">
    

    <script src="/js/jquery-3.3.1.min.js?1560560518"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/docs/user-interface/flows/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a href="/">
  <img src="/images/logo.svg" />
</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1560560518"></script>
<script type="text/javascript" src="/js/auto-complete.js?1560560518"></script>
<script type="text/javascript">
    
        var baseurl = "\/";
    
</script>
<script type="text/javascript" src="/js/search.js?1560560518"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/about/" title="About Velociraptor" class="dd-item 
        
        
        
        ">
      <a href="/about/">
          Overview
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/about/features/" title="Velociraptor Features" class="dd-item ">
        <a href="/about/features/">
        Velociraptor Features
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/about/license/" title="GNU Affero General Public License" class="dd-item ">
        <a href="/about/license/">
        License
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/docs/" title="Velociraptor Documentation" class="dd-item 
        parent
        
        
        ">
      <a href="/docs/">
          Velociraptor Documentation
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/docs/getting-started/" title="Getting Started" class="dd-item 
        
        
        
        ">
      <a href="/docs/getting-started/">
          Getting Started
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/docs/getting-started/stand_alone/" title="Standalone Deployment" class="dd-item ">
        <a href="/docs/getting-started/stand_alone/">
        Standalone Deployment
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/getting-started/deploying_clients/" title="Deploying Clients" class="dd-item ">
        <a href="/docs/getting-started/deploying_clients/">
        Deploying Clients
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/getting-started/cloud/" title="Deploying in the cloud" class="dd-item ">
        <a href="/docs/getting-started/cloud/">
        Deploying in the cloud
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/getting-started/triaging/" title="Triaging" class="dd-item ">
        <a href="/docs/getting-started/triaging/">
        Triaging
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/docs/user-interface/" title="User Interface" class="dd-item 
        parent
        
        
        ">
      <a href="/docs/user-interface/">
          User Interface
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/docs/user-interface/flows/" title="Velociraptor Artifacts" class="dd-item active">
        <a href="/docs/user-interface/flows/">
        Velociraptor Artifacts
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/user-interface/gui/" title="Searching for clients" class="dd-item ">
        <a href="/docs/user-interface/gui/">
        Searching for clients
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/docs/use_cases/" title="Use Cases" class="dd-item 
        
        
        
        ">
      <a href="/docs/use_cases/">
          Use Cases
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/docs/presentations/" title="Presentations and Workshops" class="dd-item 
        
        
        
        ">
      <a href="/docs/presentations/">
          Presentations and Workshops
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/docs/presentations/crikeycon2019/" title="Crikeycon 2019 Training Workshop" class="dd-item ">
        <a href="/docs/presentations/crikeycon2019/">
        CrikeyCon 2019
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/presentations/nzitf2018/" title="New Zealand Internet Task Force Conference 2018" class="dd-item ">
        <a href="/docs/presentations/nzitf2018/">
        NZITF2018
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/tutorial/" title="Tutorial" class="dd-item ">
        <a href="/docs/tutorial/">
        Tutorial
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/docs/vql_reference/" title="VQL Reference" class="dd-item 
        
        
        
        ">
      <a href="/docs/vql_reference/">
          VQL Reference
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/docs/vql_reference/templates/" title="Report Templates" class="dd-item ">
        <a href="/docs/vql_reference/templates/">
        Report Templates
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/vql_reference/event_plugins/" title="VQL Event PLugins" class="dd-item ">
        <a href="/docs/vql_reference/event_plugins/">
        VQL Event PLugins
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/vql_reference/functions/" title="VQL Functions" class="dd-item ">
        <a href="/docs/vql_reference/functions/">
        VQL Functions
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/vql_reference/plugins/" title="VQL PLugins" class="dd-item ">
        <a href="/docs/vql_reference/plugins/">
        VQL PLugins
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/vql_reference/server/" title="VQL Server Plugins" class="dd-item ">
        <a href="/docs/vql_reference/server/">
        VQL Server Plugins
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/docs/artifacts/" title="Artifact Reference" class="dd-item 
        
        
        
        ">
      <a href="/docs/artifacts/">
          Artifact Reference
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/docs/artifacts/linux/linux/" title="Linux Artifacts" class="dd-item ">
        <a href="/docs/artifacts/linux/linux/">
        Linux Artifacts
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/artifacts/misc/" title="Miscelaneous Artifacts" class="dd-item ">
        <a href="/docs/artifacts/misc/">
        Miscelaneous
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/artifacts/server/" title="Server Artifacts" class="dd-item ">
        <a href="/docs/artifacts/server/">
        Server Artifacts
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/artifacts/detection/" title="Windows Malware Detection" class="dd-item ">
        <a href="/docs/artifacts/detection/">
        Windows Detection
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/artifacts/events/" title="Windows Event Monitoring" class="dd-item ">
        <a href="/docs/artifacts/events/">
        Windows Monitoring
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/artifacts/windows_system/" title="Windows System" class="dd-item ">
        <a href="/docs/artifacts/windows_system/">
        Windows System
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/artifacts/triage/" title="Windows Triage Artifacts" class="dd-item ">
        <a href="/docs/artifacts/triage/">
        Windows Triage
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/blog/" title="Velociraptor Blog" class="dd-item 
        
        
        
        ">
      <a href="/blog/">
          Velociraptor Blog
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2019/03/02/agentless_hunting_with_velociraptor.html" title="Agentless hunting with Velociraptor" class="dd-item ">
        <a href="/blog/html/2019/03/02/agentless_hunting_with_velociraptor.html">
        Agentless hunting with Velociraptor
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2019/02/14/alerting_on_event_patterns.html" title="Alerting on event patterns" class="dd-item ">
        <a href="/blog/html/2019/02/14/alerting_on_event_patterns.html">
        Alerting on event patterns
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2019/02/10/velociraptor_performance.html" title="Velociraptor Performance" class="dd-item ">
        <a href="/blog/html/2019/02/10/velociraptor_performance.html">
        Velociraptor Performance
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2019/02/09/velociraptor_python_api.html" title="The Velociraptor Python API" class="dd-item ">
        <a href="/blog/html/2019/02/09/velociraptor_python_api.html">
        The Velociraptor Python API
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/09/03/velociraptor_s_client_communications.html" title="Velociraptor&#39;s client communications" class="dd-item ">
        <a href="/blog/html/2018/09/03/velociraptor_s_client_communications.html">
        Velociraptor&#39;s client communications
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/12/23/deploying_velociraptor_with_oauth_sso.html" title="Deploying Velociraptor with OAuth SSO" class="dd-item ">
        <a href="/blog/html/2018/12/23/deploying_velociraptor_with_oauth_sso.html">
        Deploying Velociraptor with OAuth SSO
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/12/22/configuring_velociraptor_for_ssl.html" title="Configuring Velociraptor for SSL" class="dd-item ">
        <a href="/blog/html/2018/12/22/configuring_velociraptor_for_ssl.html">
        Configuring Velociraptor for SSL
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/12/11/velociraptor_interactive_shell.html" title="Velociraptor Interactive Shell" class="dd-item ">
        <a href="/blog/html/2018/12/11/velociraptor_interactive_shell.html">
        Velociraptor Interactive Shell
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/12/10/server_side_vql_queries_and_events.html" title="Server side VQL queries and Escalation Events" class="dd-item ">
        <a href="/blog/html/2018/12/10/server_side_vql_queries_and_events.html">
        Server side VQL queries and Escalation Events
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/12/09/more_on_client_event_collection.html" title="More on client event collection" class="dd-item ">
        <a href="/blog/html/2018/12/09/more_on_client_event_collection.html">
        More on client event collection
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/11/13/velociraptor_training_at_nzitf.html" title="Velociraptor training at NZITF" class="dd-item ">
        <a href="/blog/html/2018/11/13/velociraptor_training_at_nzitf.html">
        Velociraptor training at NZITF
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/11/09/event_queries_and_endpoint_monitoring.html" title="Event Queries and Endpoint Monitoring" class="dd-item ">
        <a href="/blog/html/2018/11/09/event_queries_and_endpoint_monitoring.html">
        Event Queries and Endpoint Monitoring
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/09/30/velorciraptor_s_filesystem_s_accessors.html" title="Velorciraptor&#39;s filesystem&#39;s accessors" class="dd-item ">
        <a href="/blog/html/2018/09/30/velorciraptor_s_filesystem_s_accessors.html">
        Velorciraptor&#39;s filesystem&#39;s accessors
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/09/29/detecting_powershell_persistence_with_velociraptor_and_yara.html" title="Detecting powershell persistence with Velociraptor and Yara" class="dd-item ">
        <a href="/blog/html/2018/09/29/detecting_powershell_persistence_with_velociraptor_and_yara.html">
        Detecting powershell persistence with Velociraptor and Yara
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/09/03/velociraptor_walk_through_and_demo.html" title="Velociraptor walk through and demo" class="dd-item ">
        <a href="/blog/html/2018/09/03/velociraptor_walk_through_and_demo.html">
        Velociraptor walk through and demo
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/08/20/velociraptor_artifacts.html" title="Velociraptor Artifacts" class="dd-item ">
        <a href="/blog/html/2018/08/20/velociraptor_artifacts.html">
        Velociraptor Artifacts
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/08/10/browsing_around_the_filesystem.html" title="Browsing around the filesystem." class="dd-item ">
        <a href="/blog/html/2018/08/10/browsing_around_the_filesystem.html">
        Browsing around the filesystem.
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/08/10/design_differences_between_velociraptor_and_grr.html" title="Design differences between Velociraptor and GRR" class="dd-item ">
        <a href="/blog/html/2018/08/10/design_differences_between_velociraptor_and_grr.html">
        Design differences between Velociraptor and GRR
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/02/09/files_files_everything_is_just_a_file.html" title="Files, files everything is just a file!" class="dd-item ">
        <a href="/blog/html/2018/02/09/files_files_everything_is_just_a_file.html">
        Files, files everything is just a file!
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/08/10/hunting_what_velociraptors_do_best.html" title="Hunting - What Velociraptors do best!" class="dd-item ">
        <a href="/blog/html/2018/08/10/hunting_what_velociraptors_do_best.html">
        Hunting - What Velociraptors do best!
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/08/10/interrogation_make_the_endpoint_tell_us_what_it_knows.html" title="Interrogation - Make the endpoint tell us what it knows!" class="dd-item ">
        <a href="/blog/html/2018/08/10/interrogation_make_the_endpoint_tell_us_what_it_knows.html">
        Interrogation - Make the endpoint tell us what it knows!
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/08/10/the_velocidex_query_language.html" title="Velocidex Query Language (VQL)" class="dd-item ">
        <a href="/blog/html/2018/08/10/the_velocidex_query_language.html">
        Velocidex Query Language (VQL)
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/html/2018/08/10/introducing_velociraptor.html" title="Introducing Velociraptor" class="dd-item ">
        <a href="/blog/html/2018/08/10/introducing_velociraptor.html">
        Introducing Velociraptor
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    

    
    <section id="footer">
      
    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            
            
          
          
            <a href='/'>Velociraptor - Hunt Evil!</a> > <a href='/docs/'>Velociraptor Documentation</a> > <a href='/docs/user-interface/'>User Interface</a> > Velociraptor Artifacts
          
         
          
         
          
         
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#artifact-definitions">Artifact definitions</a></li>
</ul></li>
<li><a href="#viewing-previously-collected-artifacts">Viewing previously collected artifacts</a>
<ul>
<li><a href="#the-artifact-details-pane">The artifact details pane</a></li>
</ul></li>
<li><a href="#collecting-an-artifact-from-an-endpoint">Collecting an artifact from an endpoint.</a></li>
<li><a href="#adding-or-editing-artifacts-through-the-gui">Adding or Editing artifacts through the GUI</a>
<ul>
<li><a href="#artifact-types">Artifact Types</a></li>
</ul></li>
</ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Velociraptor Artifacts
            </h1>
          

        





<p>Velociraptor&rsquo;s main job is to collect <code>Forensic Artifacts</code>. An
artifact is simply a yaml file which tells Velociraptor how to collect
a set of files or information in order to answer a specific question.</p>

<h2 id="artifact-definitions">Artifact definitions</h2>

<p>Artifacts are supposed to be defined and tweaked by the
user. Therefore they are defined using YAML in a simple file format.</p>

<p>Below is an example of a typical artifact definition.</p>

<pre><code class="language-yaml">name: Windows.Sys.Users
description: |
  List User accounts that were logged into the machine in the past by
  searching for registry artifacts.

  What local or domain users have previously logged into an endpoint?

parameters:
  - name: remoteRegKey
    default: HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList\*

sources:
  - precondition:
      SELECT OS From info() where OS = 'windows'
    queries:
        - SELECT &quot;&quot; as Uid, &quot;&quot; as Gid,
               lookupSID(
                 sid=basename(path=Key.FullPath)
               ) as Name,
               Key.FullPath as Description,
               ProfileImagePath as Directory,
               basename(path=Key.FullPath) as UUID,
               Key.Mtime.Sec as Mtime,
               &quot;roaming&quot; as Type
           FROM read_reg_key(globs=remoteRegKey, accessor=&quot;reg&quot;)

reports:
  - type: CLIENT
    template: |

      Users that logged in previously.
      ===============================

      {{ .Description }}

      The following table shows basic information about the users on this system.

      {{ Query &quot;users&quot; &quot;SELECT Name, UUID, Type, Mtime FROM source()&quot; | Table }}
</code></pre>

<p>We can see the main sections:</p>

<ol>
<li><p>The <code>name</code> of the artifact is a dot separated string used to
identify the Artifact in the UI. We typically name the artifact
using a heirarchical category based naming scheme.</p></li>

<li><p>The <code>description</code> section contains a human readable description of
the purpose of this artifact, how it works and when to use it. The
description section is searchable in the GUI so you should provide
enough context there to assist a user in selcting this artifact.</p></li>

<li><p>The <code>parameters</code> section is a list of parameters provided to the
artifact. When the user selects this artifact in the GUI, they are
also given the option to tweak these parameters. Parameters may
also specify a default value and a helpful description to help
users set the correct value.</p></li>

<li><p>The sources section contains a list of evidence sources. Each
source specifies a single VQL query. The query may retrieve
specific information or files.</p>

<ul>
<li><p>A <code>precondition</code> is a VQL query which must be satisfied before
the source is collected.</p></li>

<li><p>The <code>queries</code> section is a list of VQL queries, executed one at
the time, which produce a single result set (i.e. a table with
specified columns and rows). Typically the <code>queries</code> section
consists of a list of <code>LET</code> VQL statements followed by a single
<code>SELECT</code>.</p></li>
</ul></li>

<li><p>Finally the <code>reports</code> section specifies a set of report templates
to be used to analyze the results collected from the artifact. You
can read more about <a href="/docs/vql_reference/templates/">report templates</a>.</p></li>
</ol>


<div class="notices tip" ><p>At a high level, an artifact answers a specific question. As an
investigator we ask questions relevant to our case, and the artifact
maps these questions to a mechanical collection providing sufficient
evidence to cast light on our question. The Velociraptor GUI allows
one to search artifacts by their description section.</p>
</div>


<p>The artifact contains a <code>report</code> that helps the user make sense of the
collected evidence. The report presents a human readable post
processing on the collected artifact - collating and correlating
evidence from multiple sources in order to answer the high level
question posed by the artifact.</p>

<p>The purpose of the artifact is to encapsulate expert knowledge into
the artifact to both document and guide investigators through the
investigation process. Even experienced investigators can benefit from
artifacts, since they do not need to worry about forgetting to collect
a particular source, or wrongly interpreting some of its finding.</p>

<p>In the above example, the high level question is <code>What domain users
have logged into this endpoint?</code>. To answer this question we extract
registry artifacts created whenever a user gains an interactive logon
session to a machine. The report helps us to understand what the
registry artifacts actually mean. We can see the report can run
further VQL queries to highlight or post process the results, perhaps
drawing our attention to particularly interesting findings.</p>

<h1 id="viewing-previously-collected-artifacts">Viewing previously collected artifacts</h1>

<p>Now that we understand what artifacts actually are, we are ready to
collect artifacts from our endpoints. We will first discuss how to
collect an artifact from a single endpoint, and later discuss how to
hunt for the artifacts across the entire fleet.</p>

<p>Once we searched and selected the endpoint of interest, we can switch
to the &ldquo;Collected Artifacts&rdquo; view.</p>

<p><img src="../collected_artifacts.png" alt="The Collected Artifacts view" /></p>

<p>The screen shows the artifacts previously collected on this
endpoint. The screen is split into a top table showing a list of
collected artifacts, and a bottom overview pane showing details about
each selected artifact in the table above.</p>

<p>The artifacts list table shows an overview of previously collected
artifacts on this endpoint. Each artifact collection operation is
termed a <code>flow</code> in Velociraptor. It has the following columns:</p>

<ol>
<li><p>The state of the flow. This can be a tick for completed flows, a
clock for pending artifacts or a nuke for artifacts which were
collected with critical errors (Artifacts may also have non
critical errors so you need to check the logs as well).</p></li>

<li><p>The <code>FlowId</code> is a unique internal ID given to each flow
Velociraptor runs. You will need this ID if you need to compose VQL
quries for post processing the flow.</p></li>

<li><p>The <code>Artifacts Collected</code> column is a list of artifacts collected
by this flow. It is possible to schedule multiple artifacts to be
collected at the same time. This column shows each artifact by
name.</p></li>

<li><p>The <code>Creation Date</code> is when the artifact was created. The endpoint
may not have been online at the time, so it is possible that the
endpoint did not receive the collection request immediately when it
was created.</p></li>

<li><p>The <code>Last Active</code> date is when the last response arrived from the
endpoint relating to this flow. The difference between this time
and the creation time gives us an idea of how long the artifacts
actually took to be collected on the endpoint.</p></li>

<li><p>Finally we learn the user that created the collection. If this
column contains a hunt id (of the form <code>H.XXXX</code>) then this flow was
automatically created by the hunt manager.</p></li>
</ol>

<h2 id="the-artifact-details-pane">The artifact details pane</h2>

<p>The bottom pane allows us to inspect the flow and the collected
artifacts. It consists of several tabs, the first of which <code>Artifact
Collection</code> tab gives high level overview of the flow. We can see how
many files were uploaded, what artifacts were collected and any
specific artifact parameters that were issued.</p>

<p>In particular that tab also offers a <code>Download Results</code>
button. Clicking this button will create a zip file containing all
relevant information obtained from this artifact. Specifically it
contains a CSV file for each returned VQL query, as well as any file
uploaded by the artifact.</p>

<p>The <code>Uploaded Files</code> tab shows the files uploaded by the artifact&rsquo;s
VQL. Some artifact as simply file collectors - collecting a bunch of
files for later post processing analysis.</p>

<p>The <code>Results</code> tab shows a table of VQL results from each source. For
artifacts containing multiple sources (or if you collected multiple
artifacts) the selector allows switching between them to view the
result table from each. Since an artifact <code>source</code> is simply a VQL
query, it returns a table with columns specified by the query
itself. Therefore each artifact will procude a different table.</p>

<p>The <code>Logs</code> tab shows any messages logged by the endpoint while
collecting the artifact. Many issues encounted by the endpoint are not
considered fatal, but are nevertheless logged to the server (for
example, if the endpoint attempts to open a file which is locked). You
should look at the tab to assess if you are getting a complete result.</p>

<p>Finally the <code>Reports</code> tab shows the artifact&rsquo;s report. As described
above, the report is a human readable document explaining the results
of the artifact and performing some post processing.</p>

<h1 id="collecting-an-artifact-from-an-endpoint">Collecting an artifact from an endpoint.</h1>

<p>We have seen how to examine older artifacts collected from the
endpoint, how do we collect newer artifacts?</p>

<p>Clicking the plus button on the toolbar (<code>Collect More Artifacts</code>)
presents the artifacts collection UI.</p>

<p><img src="../collect_artifacts_ui.png" alt="The collect new artifacts UI" /></p>

<p>The UI element presents a search box for finding the desired
artifacts. Velociraptor will search for the keywords in the artifact&rsquo;s
description field. A list of matching artifact names is presented
below the search box. Clicking on each of these artifacts presents a
summary of the artifact on the right hand side. The summary includes
the description as well as the parameters the artifact takes and the
VQL queries that will be run. The artifact can now be added to the
selected artifacts box.</p>

<p>You can set the <code>Ops/Sec</code> value for collecting the artifacts. This
setting controls how aggressively the endpoint will collect the
artifact. For artifacts that collect a lot of files or otherwise
utilize heavy resources on the endpoint, it is advisable to lower this
to reduce endpoint load.</p>

<h1 id="adding-or-editing-artifacts-through-the-gui">Adding or Editing artifacts through the GUI</h1>

<p>Velociraptor comes with a wide selection of built in artifacts, but
the real power of Velociraptor&rsquo;s query language lies in the ability of
users to customize and develop their own artifacts - flexibly
responding to their own needs.</p>

<p>This can be achieved via the <code>Server Management</code> screen - reachable
from the side bar menu.</p>

<p><img src="../add_artifacts.png" alt="Add artifacts" /></p>

<p>The <code>Server Management</code> screen consists of a tree view on the left
hand side showing several high level categories of server
configuration to edit. The <code>artifact_definitions</code> category is used to
manage the server&rsquo;s artifact repository.</p>

<p>Below the top level we see the <code>builtin</code> and the <code>custom</code> folders. The
<code>builtin</code> folder contains all the artifacts that come with
Velociraptor. The artifacts are simply YAML files. Built in artifacts
are stored in the server binary, while custom artifacts are simply
stored in the Server&rsquo;s file store (where they can be easily backed up
if needed). You can see the content of the YAML file by selecting the
<code>TextView</code> tab.</p>

<p>Probably the easiest way to get familiar with artifacts is to edit an
existing artifact. Selecting an existing artifact and clicking the
<code>Add/Edit an artifact</code> toolbar button will open the artifact in an
editor.</p>

<p><img src="../edit_artifacts.png" alt="Editing artifacts" /></p>

<p>If you keep the name of the artifact the same, then the saved artifact
will override the default built in one. Changing the name will add the
new artifact to the server repository. Note that custom artifacts are
always stored under the <code>custom</code> path. This way you can always go back
to see the original builtin artifact content.</p>

<p>Saving the artifact will validate it and ensure the VQL syntax is
correct. You may then search for it in the artifact collection screen.</p>

<h2 id="artifact-types">Artifact Types</h2>

<p>Velociraptor uses VQL for many different purposes. Since Artifacts are
a nice way to package VQL queries, there are a number of different
types of artifacts. You can read more about the different types of
artifacts within Velociraptor <a href="../artifact_types/">here</a></p>


<footer class=" footline" >
	
</footer>


        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/docs/user-interface/" title="User Interface"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/docs/user-interface/gui/" title="Searching for clients" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1560560518"></script>
    <script src="/js/perfect-scrollbar.min.js?1560560518"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1560560518"></script>
    <script src="/js/jquery.sticky.js?1560560518"></script>
    <script src="/js/featherlight.min.js?1560560518"></script>
    <script src="/js/html5shiv-printshiv.min.js?1560560518"></script>
    <script src="/js/highlight.pack.js?1560560518"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1560560518"></script>
    <script src="/js/learn.js?1560560518"></script>
    <script src="/js/hugo-learn.js?1560560518"></script>

    <link href="/mermaid/mermaid.css?1560560518" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1560560518"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>

